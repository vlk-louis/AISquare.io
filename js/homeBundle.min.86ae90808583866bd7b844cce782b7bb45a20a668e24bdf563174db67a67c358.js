(function(){var n,o,a,r,c,l,u,b,f=this,A=f._,s=Array.prototype,p=Object.prototype,O=Function.prototype,v=s.push,t=s.slice,d=s.concat,i=p.toString,_=p.hasOwnProperty,x=Array.isArray,j=Object.keys,h=O.bind,e=function(t){return t instanceof e?t:this instanceof e?void(this._wrapped=t):new e(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports._=e):f._=e,e.VERSION="1.7.0",n=function(e,t,n){if(void 0===t)return e;switch(n??3){case 1:return function(n){return e.call(t,n)};case 2:return function(n,s){return e.call(t,n,s)};case 3:return function(n,s,o){return e.call(t,n,s,o)};case 4:return function(n,s,o,i){return e.call(t,n,s,o,i)}}return function(){return e.apply(t,arguments)}},e.iteratee=function(t,s,o){return t==null?e.identity:e.isFunction(t)?n(t,s,o):e.isObject(t)?e.matches(t):e.property(t)},e.each=e.forEach=function(t,s,o){if(t==null)return t;s=n(s,o);var i,r,a=t.length;if(a===+a)for(i=0;a>i;i++)s(t[i],i,t);else{r=e.keys(t);for(i=0,a=r.length;a>i;i++)s(t[r[i]],r[i],t)}return t},e.map=e.collect=function(t,n,s){if(t==null)return[];n=e.iteratee(n,s);for(var i,a=t.length!==+t.length&&e.keys(t),r=(a||t).length,c=Array(r),o=0;r>o;o++)i=a?a[o]:o,c[o]=n(t[i],i,t);return c},u="Reduce of empty array with no initial value",e.reduce=e.foldl=e.inject=function(t,s,o,i){t==null&&(t=[]),s=n(s,i,4);var c,r=t.length!==+t.length&&e.keys(t),l=(r||t).length,a=0;if(arguments.length<3){if(!l)throw new TypeError(u);o=t[r?r[a++]:a++]}for(;l>a;a++)c=r?r[a]:a,o=s(o,t[c],c,t);return o},e.reduceRight=e.foldr=function(t,s,o,i){t==null&&(t=[]),s=n(s,i,4);var c,r=t.length!==+t.length&&e.keys(t),a=(r||t).length;if(arguments.length<3){if(!a)throw new TypeError(u);o=t[r?r[--a]:--a]}for(;a--;)c=r?r[a]:a,o=s(o,t[c],c,t);return o},e.find=e.detect=function(t,n,s){var o;return n=e.iteratee(n,s),e.some(t,function(e,t,s){return n(e,t,s)?(o=e,!0):void 0}),o},e.filter=e.select=function(t,n,s){var o=[];return t==null?o:(n=e.iteratee(n,s),e.each(t,function(e,t,s){n(e,t,s)&&o.push(e)}),o)},e.reject=function(t,n,s){return e.filter(t,e.negate(e.iteratee(n)),s)},e.every=e.all=function(t,n,s){if(t==null)return!0;n=e.iteratee(n,s);var o,i,a=t.length!==+t.length&&e.keys(t),r=(a||t).length;for(o=0;r>o;o++)if(i=a?a[o]:o,!n(t[i],i,t))return!1;return!0},e.some=e.any=function(t,n,s){if(t==null)return!1;n=e.iteratee(n,s);var o,i,a=t.length!==+t.length&&e.keys(t),r=(a||t).length;for(o=0;r>o;o++)if(i=a?a[o]:o,n(t[i],i,t))return!0;return!1},e.contains=e.include=function(t,n){return t!=null&&(t.length!==+t.length&&(t=e.values(t)),e.indexOf(t,n)>=0)},e.invoke=function(n,s){var o=t.call(arguments,2),i=e.isFunction(s);return e.map(n,function(e){return(i?s:e[s]).apply(e,o)})},e.pluck=function(t,n){return e.map(t,e.property(n))},e.where=function(t,n){return e.filter(t,e.matches(n))},e.findWhere=function(t,n){return e.find(t,e.matches(n))},e.max=function(t,n,s){var i,a,r,l,o=-(1/0),c=-(1/0);if(n==null&&t!=null){t=t.length===+t.length?t:e.values(t);for(a=0,l=t.length;l>a;a++)r=t[a],r>o&&(o=r)}else n=e.iteratee(n,s),e.each(t,function(e,t,s){i=n(e,t,s),(i>c||i===-(1/0)&&o===-(1/0))&&(o=e,c=i)});return o},e.min=function(t,n,s){var i,a,r,l,o=1/0,c=1/0;if(n==null&&t!=null){t=t.length===+t.length?t:e.values(t);for(a=0,l=t.length;l>a;a++)r=t[a],o>r&&(o=r)}else n=e.iteratee(n,s),e.each(t,function(e,t,s){i=n(e,t,s),(c>i||i===1/0&&o===1/0)&&(o=e,c=i)});return o},e.shuffle=function(t){for(var s,i=t&&t.length===+t.length?t:e.values(t),a=i.length,o=Array(a),n=0;a>n;n++)s=e.random(0,n),s!==n&&(o[n]=o[s]),o[s]=i[n];return o},e.sample=function(t,n,s){return n==null||s?(t.length!==+t.length&&(t=e.values(t)),t[e.random(t.length-1)]):e.shuffle(t).slice(0,Math.max(0,n))},e.sortBy=function(t,n,s){return n=e.iteratee(n,s),e.pluck(e.map(t,function(e,t,s){return{value:e,index:t,criteria:n(e,t,s)}}).sort(function(e,t){var n=e.criteria,s=t.criteria;if(n!==s){if(n>s||void 0===n)return 1;if(s>n||void 0===s)return-1}return e.index-t.index}),"value")},l=function(t){return function(n,s,o){var i={};return s=e.iteratee(s,o),e.each(n,function(e,o){var a=s(e,o,n);t(i,e,a)}),i}},e.groupBy=l(function(t,n,s){e.has(t,s)?t[s].push(n):t[s]=[n]}),e.indexBy=l(function(e,t,n){e[n]=t}),e.countBy=l(function(t,n,s){e.has(t,s)?t[s]++:t[s]=1}),e.sortedIndex=function(t,n,s,o){s=e.iteratee(s,o,1);for(var a,c=s(n),i=0,r=t.length;r>i;)a=i+r>>>1,s(t[a])<c?i=a+1:r=a;return i},e.toArray=function(n){return n?e.isArray(n)?t.call(n):n.length===+n.length?e.map(n,e.identity):e.values(n):[]},e.size=function(t){return t==null?0:t.length===+t.length?t.length:e.keys(t).length},e.partition=function(t,n,s){n=e.iteratee(n,s);var o=[],i=[];return e.each(t,function(e,t,s){(n(e,t,s)?o:i).push(e)}),[o,i]},e.first=e.head=e.take=function(e,n,s){return e==null?void 0:n==null||s?e[0]:0>n?[]:t.call(e,0,n)},e.initial=function(e,n,s){return t.call(e,0,Math.max(0,e.length-(n==null||s?1:n)))},e.last=function(e,n,s){return e==null?void 0:n==null||s?e[e.length-1]:t.call(e,Math.max(e.length-n,0))},e.rest=e.tail=e.drop=function(e,n,s){return t.call(e,n==null||s?1:n)},e.compact=function(t){return e.filter(t,e.identity)},o=function(t,n,s,i){if(n&&e.every(t,e.isArray))return d.apply(i,t);for(var a,r=0,c=t.length;c>r;r++)a=t[r],e.isArray(a)||e.isArguments(a)?n?v.apply(i,a):o(a,n,s,i):s||i.push(a);return i},e.flatten=function(e,t){return o(e,t,!1,[])},e.without=function(n){return e.difference(n,t.call(arguments,1))},e.uniq=e.unique=function(t,n,s,o){if(t==null)return[];e.isBoolean(n)||(o=s,s=n,n=!1),s!=null&&(s=e.iteratee(s,o));for(var i,l,a=[],c=[],r=0,d=t.length;d>r;r++)i=t[r],n?(r&&c===i||a.push(i),c=i):s?(l=s(i,r,t),e.indexOf(c,l)<0&&(c.push(l),a.push(i))):e.indexOf(a,i)<0&&a.push(i);return a},e.union=function(){return e.uniq(o(arguments,!0,!0,[]))},e.intersection=function(t){if(t==null)return[];for(var n,s,o=[],a=arguments.length,i=0,r=t.length;r>i;i++)if(s=t[i],!e.contains(o,s)){for(n=1;a>n&&e.contains(arguments[n],s);n++);n===a&&o.push(s)}return o},e.difference=function(n){var s=o(t.call(arguments,1),!0,!0,[]);return e.filter(n,function(t){return!e.contains(s,t)})},e.zip=function(t){if(t==null)return[];for(var s=e.max(arguments,"length").length,o=Array(s),n=0;s>n;n++)o[n]=e.pluck(arguments,n);return o},e.object=function(e,t){if(e==null)return{};for(var s={},n=0,o=e.length;o>n;n++)t?s[e[n]]=t[n]:s[e[n][0]]=e[n][1];return s},e.indexOf=function(t,n,s){if(t==null)return-1;var o=0,i=t.length;if(s){if("number"!=typeof s)return o=e.sortedIndex(t,n),t[o]===n?o:-1;o=0>s?Math.max(0,i+s):s}for(;i>o;o++)if(t[o]===n)return o;return-1},e.lastIndexOf=function(e,t,n){if(e==null)return-1;var s=e.length;for("number"==typeof n&&(s=0>n?s+n+1:Math.min(s,n+1));--s>=0;)if(e[s]===t)return s;return-1},e.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var o=Math.max(Math.ceil((t-e)/n),0),i=Array(o),s=0;o>s;s++,e+=n)i[s]=e;return i},c=function(){},e.bind=function(n,s){var o,i;if(h&&n.bind===h)return h.apply(n,t.call(arguments,1));if(!e.isFunction(n))throw new TypeError("Bind must be called on a function");return o=t.call(arguments,2),i=function(){if(!(this instanceof i))return n.apply(s,o.concat(t.call(arguments)));c.prototype=n.prototype;var a,r=new c;return c.prototype=null,a=n.apply(r,o.concat(t.call(arguments))),e.isObject(a)?a:r}},e.partial=function(n){var s=t.call(arguments,1);return function(){for(var i=0,t=s.slice(),o=0,a=t.length;a>o;o++)t[o]===e&&(t[o]=arguments[i++]);for(;i<arguments.length;)t.push(arguments[i++]);return n.apply(this,t)}},e.bindAll=function(t){var n,s,o=arguments.length;if(1>=o)throw new Error("bindAll must be passed function names");for(n=1;o>n;n++)s=arguments[n],t[s]=e.bind(t[s],t);return t},e.memoize=function(t,n){var s=function(o){var i=s.cache,a=n?n.apply(this,arguments):o;return e.has(i,a)||(i[a]=t.apply(this,arguments)),i[a]};return s.cache={},s},e.delay=function(e,n){var s=t.call(arguments,2);return setTimeout(function(){return e.apply(null,s)},n)},e.defer=function(n){return e.delay.apply(e,[n,1].concat(t.call(arguments,1)))},e.throttle=function(t,n,s){var i,a,c,l,o=null,r=0;return s||(s={}),l=function(){r=s.leading===!1?0:e.now(),o=null,c=t.apply(i,a),o||(i=a=null)},function(){var d,u=e.now();return r||s.leading!==!1||(r=u),d=n-(u-r),i=this,a=arguments,0>=d||d>n?(clearTimeout(o),o=null,r=u,c=t.apply(i,a),o||(i=a=null)):o||s.trailing===!1||(o=setTimeout(l,d)),c}},e.debounce=function(t,n,s){var o,i,a,r,c,l=function(){var d=e.now()-c;n>d&&d>0?o=setTimeout(l,n-d):(o=null,s||(r=t.apply(a,i),o||(a=i=null)))};return function(){a=this,i=arguments,c=e.now();var d=s&&!o;return o||(o=setTimeout(l,n)),d&&(r=t.apply(a,i),a=i=null),r}},e.wrap=function(t,n){return e.partial(n,t)},e.negate=function(e){return function(){return!e.apply(this,arguments)}},e.compose=function(){var e=arguments,t=e.length-1;return function(){for(var s=t,n=e[t].apply(this,arguments);s--;)n=e[s].call(this,n);return n}},e.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},e.before=function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},e.once=e.partial(e.before,2),e.keys=function(t){if(!e.isObject(t))return[];if(j)return j(t);var s,n=[];for(s in t)e.has(t,s)&&n.push(s);return n},e.values=function(t){for(var s=e.keys(t),o=s.length,i=Array(o),n=0;o>n;n++)i[n]=t[s[n]];return i},e.pairs=function(t){for(var s=e.keys(t),o=s.length,i=Array(o),n=0;o>n;n++)i[n]=[s[n],t[s[n]]];return i},e.invert=function(t){for(var o={},s=e.keys(t),n=0,i=s.length;i>n;n++)o[t[s[n]]]=s[n];return o},e.functions=e.methods=function(t){var s,n=[];for(s in t)e.isFunction(t[s])&&n.push(s);return n.sort()},e.extend=function(t){if(!e.isObject(t))return t;for(var n,s,o=1,i=arguments.length;i>o;o++){n=arguments[o];for(s in n)_.call(n,s)&&(t[s]=n[s])}return t},e.pick=function(s,o,i){if(r={},s==null)return r;if(e.isFunction(o)){o=n(o,i);for(a in s)c=s[a],o(c,a,s)&&(r[a]=c)}else{l=d.apply([],t.call(arguments,1)),s=new Object(s);for(var a,r,c,l,u=0,h=l.length;h>u;u++)a=l[u],a in s&&(r[a]=s[a])}return r},e.omit=function(n,s,o){if(e.isFunction(s))s=e.negate(s);else{var i=e.map(d.apply([],t.call(arguments,1)),String);s=function(t,n){return!e.contains(i,n)}}return e.pick(n,s,o)},e.defaults=function(t){if(!e.isObject(t))return t;for(var s,o,n=1,i=arguments.length;i>n;n++){s=arguments[n];for(o in s)void 0===t[o]&&(t[o]=s[o])}return t},e.clone=function(t){return e.isObject(t)?e.isArray(t)?t.slice():e.extend({},t):t},e.tap=function(e,t){return t(e),e},r=function(t,n,s,o){if(t===n)return 0!==t||1/t===1/n;if(t==null||n==null)return t===n;if(t instanceof e&&(t=t._wrapped),n instanceof e&&(n=n._wrapped),l=i.call(t),l!==i.call(n))return!1;switch(l){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!==+t?+n!==+n:0===+t?1/+t===1/n:+t===+n;case"[object Date]":case"[object Boolean]":return+t===+n}if("object"!=typeof t||"object"!=typeof n)return!1;for(d=s.length;d--;)if(s[d]===t)return o[d]===n;var a,c,l,d,m,f,u=t.constructor,h=n.constructor;if(u!==h&&"constructor"in t&&"constructor"in n&&!(e.isFunction(u)&&u instanceof u&&e.isFunction(h)&&h instanceof h))return!1;if(s.push(t),o.push(n),"[object Array]"===l){if(a=t.length,c=a===n.length)for(;a--&&(c=r(t[a],n[a],s,o)););}else if(f=e.keys(t),a=f.length,c=e.keys(n).length===a)for(;a--&&(m=f[a],c=e.has(n,m)&&r(t[m],n[m],s,o)););return s.pop(),o.pop(),c},e.isEqual=function(e,t){return r(e,t,[],[])},e.isEmpty=function(t){if(t==null)return!0;if(e.isArray(t)||e.isString(t)||e.isArguments(t))return 0===t.length;for(var n in t)if(e.has(t,n))return!1;return!0},e.isElement=function(e){return!!e&&1===e.nodeType},e.isArray=x||function(e){return"[object Array]"===i.call(e)},e.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},e.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){e["is"+t]=function(e){return i.call(e)==="[object "+t+"]"}}),e.isArguments(arguments)||(e.isArguments=function(t){return e.has(t,"callee")}),"function"!=typeof/./&&(e.isFunction=function(e){return"function"==typeof e||!1}),e.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},e.isNaN=function(t){return e.isNumber(t)&&t!==+t},e.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===i.call(e)},e.isNull=function(e){return null===e},e.isUndefined=function(e){return void 0===e},e.has=function(e,t){return e!=null&&_.call(e,t)},e.noConflict=function(){return f._=A,this},e.identity=function(e){return e},e.constant=function(e){return function(){return e}},e.noop=function(){},e.property=function(e){return function(t){return t[e]}},e.matches=function(t){var n=e.pairs(t),s=n.length;return function(e){if(e==null)return!s;e=new Object(e);for(t=0;s>t;t++){var t,o=n[t],i=o[0];if(o[1]!==e[i]||!(i in e))return!1}return!0}},e.times=function(e,t,s){var o,i=Array(Math.max(0,e));t=n(t,s,1);for(o=0;e>o;o++)i[o]=t(o);return i},e.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},e.now=Date.now||function(){return(new Date).getTime()};var y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=e.invert(y),g=function(t){var s=function(e){return t[e]},n="(?:"+e.keys(t).join("|")+")",o=RegExp(n),i=RegExp(n,"g");return function(e){return e=e==null?"":""+e,o.test(e)?e.replace(i,s):e}};e.escape=g(y),e.unescape=g(w),e.result=function(t,n){if(t==null)return void 0;var s=t[n];return e.isFunction(s)?t[n]():s},b=0,e.uniqueId=function(e){var t=++b+"";return e?e+t:t},e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var m=/(.)^/,C={"'":"'","\\":"\\","\r":"r","\n":"n"," ":"u2028"," ":"u2029"},E=/\\|'|\r|\n|\u2028|\u2029/g,k=function(e){return"\\"+C[e]};e.template=function(t,n,s){!n&&s&&(n=s),n=e.defaults({},n,e.templateSettings);var i,r,c,l=RegExp([(n.escape||m).source,(n.interpolate||m).source,(n.evaluate||m).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(l,function(e,n,s,i,r){return o+=t.slice(a,r).replace(E,k),a=r+e.length,n?o+=`'+
((__t=(`+n+`))==null?'':_.escape(__t))+
'`:s?o+=`'+
((__t=(`+s+`))==null?'':__t)+
'`:i&&(o+=`';
`+i+`
__p+='`),e}),o+=`';
`,n.variable||(o=`with(obj||{}){
`+o+`}
`),o=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+o+`return __p;
`;try{r=new Function(n.variable||"obj","_",o)}catch(e){throw e.source=o,e}return i=function(t){return r.call(this,t,e)},c=n.variable||"obj",i.source="function("+c+`){
`+o+"}",i},e.chain=function(t){var n=e(t);return n._chain=!0,n},a=function(t){return this._chain?e(t).chain():t},e.mixin=function(t){e.each(e.functions(t),function(n){var s=e[n]=t[n];e.prototype[n]=function(){var t=[this._wrapped];return v.apply(t,arguments),a.call(this,s.apply(e,t))}})},e.mixin(e),e.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=s[t];e.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],a.call(this,e)}}),e.each(["concat","join","slice"],function(t){var n=s[t];e.prototype[t]=function(){return a.call(this,n.apply(this._wrapped,arguments))}}),e.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return e})}).call(this),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function Q(e){var t=e.length,s=n.type(e);return"function"!==s&&!n.isWindow(e)&&(!!(1===e.nodeType&&t)||"array"===s||0===t||"number"==typeof t&&t>0&&t-1 in e)}function K(e,t,s){if(n.isFunction(t))return n.grep(e,function(e,n){return!!t.call(e,n,e)!==s});if(t.nodeType)return n.grep(e,function(e){return e===t!==s});if("string"==typeof t){if(jt.test(t))return n.filter(t,e,s);t=n.filter(t,e)}return n.grep(e,function(e){return V.call(t,e)>=0!==s})}function Pe(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function Rt(e){var t=te[e]={};return n.each(e.match(d)||[],function(e,n){t[n]=!0}),t}function S(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),n.ready()}function f(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+Math.random()}function Ce(e,t,s){var o;if(void 0===s&&1===e.nodeType)if(o="data-"+t.replace(ht,"-$1").toLowerCase(),s=e.getAttribute(o),"string"==typeof s){try{s="true"===s||"false"!==s&&("null"===s?null:+s+""===s?+s:ft.test(s)?n.parseJSON(s):s)}catch{}a.set(e,t,s)}else s=void 0;return s}function L(){return!0}function j(){return!1}function ye(){try{return o.activeElement}catch{}}function be(e,t){return n.nodeName(e,"table")&&n.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Lt(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Nt(e){var t=at.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function W(e,t){for(var n=0,o=e.length;o>n;n++)s.set(e[n],"globalEval",!t||s.get(t[n],"globalEval"))}function ce(e,t){var o,i,r,c,l,d,u,h;if(1===t.nodeType){if(s.hasData(e)&&(c=s.access(e),l=s.set(t,c),r=c.events)){delete l.handle,l.events={};for(i in r)for(o=0,d=r[i].length;d>o;o++)n.event.add(t,i,r[i][o])}a.hasData(e)&&(u=a.access(e),h=n.extend({},u),a.set(t,h))}}function r(e,t){var s=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&n.nodeName(e,t)?n.merge([e],s):s}function Dt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&xe.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function _e(t,s){var i,o=n(s.createElement(t)).appendTo(s.body),a=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(o[0]))?i.display:n.css(o[0],"display");return o.detach(),a}function X(e){var s=o,t=Ie[e];return t||(t=_e(e,s),"none"!==t&&t||(F=(F||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(s.documentElement),s=F[0].contentDocument,s.write(),s.close(),t=_e(e,s),F.detach()),Ie[e]=t),t}function C(e,t,s){var o,a,r,c,i=e.style;return s=s||$(e),s&&(o=s.getPropertyValue(t)||s[t]),s&&(""!==o||n.contains(e.ownerDocument,e)||(o=n.style(e,t)),q.test(o)&&Be.test(t)&&(a=i.width,r=i.minWidth,c=i.maxWidth,i.minWidth=i.maxWidth=i.width=o,o=s.width,i.width=a,i.minWidth=r,i.maxWidth=c)),void 0!==o?o+"":o}function Oe(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function $e(e,t){if(t in e)return t;for(var s=t[0].toUpperCase()+t.slice(1),o=t,n=Ge.length;n--;)if(t=Ge[n]+s,t in e)return t;return o}function de(e,t,n){var s=nt.exec(t);return s?Math.max(0,s[1]-(n||0))+(s[2]||"px"):t}function Xe(e,t,s,o,i){for(var a=s===(o?"border":"content")?4:"width"===t?1:0,r=0;4>a;a+=2)"margin"===s&&(r+=n.css(e,s+v[a],!0,i)),o?("content"===s&&(r-=n.css(e,"padding"+v[a],!0,i)),"margin"!==s&&(r-=n.css(e,"border"+v[a]+"Width",!0,i))):(r+=n.css(e,"padding"+v[a],!0,i),"padding"!==s&&(r+=n.css(e,"border"+v[a]+"Width",!0,i)));return r}function Ke(e,t,s){var r=!0,o="width"===t?e.offsetWidth:e.offsetHeight,a=$(e),c="border-box"===n.css(e,"boxSizing",!1,a);if(0>=o||o==null){if(o=C(e,t,a),(0>o||o==null)&&(o=e.style[t]),q.test(o))return o;r=c&&(i.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+Xe(e,t,s||(c?"border":"content"),r,a)+"px"}function Ue(e,t){for(var o,a,c,r=[],i=0,l=e.length;l>i;i++)o=e[i],o.style&&(r[i]=s.get(o,"olddisplay"),a=o.style.display,t?(r[i]||"none"!==a||(o.style.display=""),""===o.style.display&&O(o)&&(r[i]=s.access(o,"olddisplay",X(o.nodeName)))):(c=O(o),"none"===a&&c||s.set(o,"olddisplay",c?a:n.css(o,"display"))));for(i=0;l>i;i++)o=e[i],o.style&&(t&&"none"!==o.style.display&&""!==o.style.display||(o.style.display=t?r[i]||"":"none"));return e}function c(e,t,n,s,o){return new c.prototype.init(e,t,n,s,o)}function Ve(){return setTimeout(function(){_=void 0}),_=n.now()}function M(e,t){var s,o=0,n={height:e};for(t=t?1:0;4>o;o+=2-t)s=v[o],n["margin"+s]=n["padding"+s]=e;return t&&(n.opacity=n.width=e),n}function He(e,t,n){for(var o,i=(x[t]||[]).concat(x["*"]),s=0,a=i.length;a>s;s++)if(o=i[s].call(n,t,e))return o}function zt(e,t,o){var i,r,d,h,f,p,g,v,u=this,m={},c=e.style,l=e.nodeType&&O(e),a=s.get(e,"fxshow");o.queue||(r=n._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,v=r.empty.fire,r.empty.fire=function(){r.unqueued||v()}),r.unqueued++,u.always(function(){u.always(function(){r.unqueued--,n.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(o.overflow=[c.overflow,c.overflowX,c.overflowY],d=n.css(e,"display"),g="none"===d?s.get(e,"olddisplay")||X(e.nodeName):d,"inline"===g&&"none"===n.css(e,"float")&&(c.display="inline-block")),o.overflow&&(c.overflow="hidden",u.always(function(){c.overflow=o.overflow[0],c.overflowX=o.overflow[1],c.overflowY=o.overflow[2]}));for(i in t)if(f=t[i],Ze.exec(f)){if(delete t[i],p=p||"toggle"===f,f===(l?"hide":"show")){if("show"!==f||!a||void 0===a[i])continue;l=!0}m[i]=a&&a[i]||n.style(e,i)}else d=void 0;if(n.isEmptyObject(m))"inline"===("none"===d?X(e.nodeName):d)&&(c.display=d);else{a?"hidden"in a&&(l=a.hidden):a=s.access(e,"fxshow",{}),p&&(a.hidden=!l),l?n(e).show():u.done(function(){n(e).hide()}),u.done(function(){var t;s.remove(e,"fxshow");for(t in m)n.style(e,t,m[t])});for(i in m)h=He(l?a[i]:0,i,u),i in a||(a[i]=h.start,l&&(h.end=h.start,h.start="width"===i||"height"===i?1:0))}}function Tt(e,t){var s,o,i,a,r;for(s in e)if(i=n.camelCase(s),a=t[i],o=e[s],n.isArray(o)&&(a=o[1],o=e[s]=o[0]),s!==i&&(e[i]=o,delete e[s]),r=n.cssHooks[i],r&&"expand"in r){o=r.expand(o),delete e[i];for(s in o)s in e||(e[s]=o[s],t[s]=a)}else t[i]=a}function De(e,t,s){var a,l,r=0,u=H.length,i=n.Deferred().always(function(){delete d.elem}),d=function(){if(a)return!1;for(var c=_||Ve(),t=Math.max(0,o.startTime+o.duration-c),l=t/o.duration||0,n=1-l,s=0,r=o.tweens.length;r>s;s++)o.tweens[s].run(n);return i.notifyWith(e,[o,n,t]),1>n&&r?t:(i.resolveWith(e,[o]),!1)},o=i.promise({elem:e,props:n.extend({},t),opts:n.extend(!0,{specialEasing:{}},s),originalProperties:t,originalOptions:s,startTime:_||Ve(),duration:s.duration,tweens:[],createTween:function(t,s){var i=n.Tween(e,o.opts,t,s,o.opts.specialEasing[t]||o.opts.easing);return o.tweens.push(i),i},stop:function(t){var n=0,s=t?o.tweens.length:0;if(a)return this;for(a=!0;s>n;n++)o.tweens[n].run(1);return t?i.resolveWith(e,[o,t]):i.rejectWith(e,[o,t]),this}}),c=o.props;for(Tt(c,o.opts.specialEasing);u>r;r++)if(l=H[r].call(o,e,c,o.opts))return l;return n.map(c,He,o),n.isFunction(o.opts.start)&&o.opts.start.call(e,o),n.fx.timer(n.extend(d,{elem:e,anim:o,queue:o.opts.queue})),o.progress(o.opts.progress).done(o.opts.done,o.opts.complete).fail(o.opts.fail).always(o.opts.always)}function Te(e){return function(t,s){"string"!=typeof t&&(s=t,t="*");var o,i=0,a=t.toLowerCase().match(d)||[];if(n.isFunction(s))for(;o=a[i++];)"+"===o[0]?(o=o.slice(1)||"*",(e[o]=e[o]||[]).unshift(s)):(e[o]=e[o]||[]).push(s)}}function ie(e,t,s,o){function i(c){var l;return a[c]=!0,n.each(e[c]||[],function(e,n){var c=n(t,s,o);return"string"!=typeof c||r||a[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),i(c),!1)}),l}var a={},r=e===ne;return i(t.dataTypes[0])||!a["*"]&&i("*")}function ee(e,t){var s,o,i=n.ajaxSettings.flatOptions||{};for(s in t)void 0!==t[s]&&((i[s]?e:o||(o={}))[s]=t[s]);return o&&n.extend(!0,e,o),e}function Qe(e,t,n){for(var o,i,a,r,c=e.contents,s=e.dataTypes;"*"===s[0];)s.shift(),void 0===a&&(a=e.mimeType||t.getResponseHeader("Content-Type"));if(a)for(o in c)if(c[o]&&c[o].test(a)){s.unshift(o);break}if(s[0]in n)i=s[0];else{for(o in n){if(!s[0]||e.converters[o+" "+s[0]]){i=o;break}r||(r=o)}i=i||r}return i?(i!==s[0]&&s.unshift(i),n[i]):void 0}function Ft(e,t,n,s){var o,i,a,c,l,r={},d=e.dataTypes.slice();if(d[1])for(i in e.converters)r[i.toLowerCase()]=e.converters[i];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!a&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=o,o=d.shift())if("*"===o)o=a;else if("*"!==a&&a!==o){if(i=r[a+" "+o]||r["* "+o],!i)for(l in r)if(c=l.split(" "),c[1]===o&&(i=r[a+" "+c[0]]||r["* "+c[0]])){i===!0?i=r[l]:r[l]!==!0&&(o=c[0],d.unshift(c[1]));break}if(i!==!0)if(i&&e.throws)t=i(t);else try{t=i(t)}catch(e){return{state:"parsererror",error:i?e:"No conversion from "+a+" to "+o}}}return{state:"success",data:t}}function Y(e,t,s,o){var i;if(n.isArray(t))n.each(t,function(t,n){s||xt.test(e)?o(e,n):Y(e+"["+("object"==typeof n?t:"")+"]",n,s,o)});else if(s||"object"!==n.type(t))o(e,t);else for(i in t)Y(e+"["+i+"]",t[i],s,o)}function Ee(e){return n.isWindow(e)?e:9===e.nodeType&&e.defaultView}var d,u,g,b,y,A,T,D,N,R,I,Z,J,w=[],m=w.slice,we=w.concat,U=w.push,V=w.indexOf,B={},St=B.toString,G=B.hasOwnProperty,i={},o=e.document,ge="2.1.1",n=function(e,t){return new n.fn.init(e,t)},Ct=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,wt=/^-ms-/,_t=/-([\da-z])/gi,yt=function(e,t){return t.toUpperCase()},le,oe,ue,he,te,st,We,Le,ze,se,ve,Re;n.fn=n.prototype={jquery:ge,constructor:n,selector:"",length:0,toArray:function(){return m.call(this)},get:function(e){return e!=null?0>e?this[e+this.length]:this[e]:m.call(this)},pushStack:function(e){var t=n.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return n.each(this,e,t)},map:function(e){return this.pushStack(n.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(m.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var n=this.length,t=+e+(0>e?n:0);return this.pushStack(t>=0&&n>t?[this[t]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:U,sort:w.sort,splice:w.splice},n.extend=n.fn.extend=function(){var t,s,i,a,r,c,e=arguments[0]||{},o=1,d=arguments.length,l=!1;for("boolean"==typeof e&&(l=e,e=arguments[o]||{},o++),"object"==typeof e||n.isFunction(e)||(e={}),o===d&&(e=this,o--);d>o;o++)if(null!=(a=arguments[o]))for(i in a)s=e[i],t=a[i],e!==t&&(l&&t&&(n.isPlainObject(t)||(r=n.isArray(t)))?(r?(r=!1,c=s&&n.isArray(s)?s:[]):c=s&&n.isPlainObject(s)?s:{},e[i]=n.extend(l,c,t)):void 0!==t&&(e[i]=t));return e},n.extend({expando:"jQuery"+(ge+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===n.type(e)},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return!n.isArray(e)&&e-parseFloat(e)>=0},isPlainObject:function(e){return!("object"!==n.type(e)||e.nodeType||n.isWindow(e))&&(!e.constructor||!!G.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return e==null?e+"":"object"==typeof e||"function"==typeof e?B[St.call(e)]||"object":typeof e},globalEval:function(e){var t,s=eval;e=n.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):s(e))},camelCase:function(e){return e.replace(wt,"ms-").replace(_t,yt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var o,s=0,i=e.length,a=Q(e);if(n){if(a)for(;i>s&&(o=t.apply(e[s],n),o!==!1);s++);else for(s in e)if(o=t.apply(e[s],n),o===!1)break}else if(a)for(;i>s&&(o=t.call(e[s],s,e[s]),o!==!1);s++);else for(s in e)if(o=t.call(e[s],s,e[s]),o===!1)break;return e},trim:function(e){return e==null?"":(e+"").replace(Ct,"")},makeArray:function(e,t){var s=t||[];return e!=null&&(Q(Object(e))?n.merge(s,"string"==typeof e?[e]:e):U.call(s,e)),s},inArray:function(e,t,n){return t==null?-1:V.call(t,e,n)},merge:function(e,t){for(var o=+t.length,n=0,s=e.length;o>n;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,n){for(var o,i=[],s=0,a=e.length,r=!n;a>s;s++)o=!t(e[s],s),o!==r&&i.push(e[s]);return i},map:function(e,t,n){var o,s=0,a=e.length,r=Q(e),i=[];if(r)for(;a>s;s++)o=t(e[s],s,n),o!=null&&i.push(o);else for(s in e)o=t(e[s],s,n),o!=null&&i.push(o);return we.apply([],i)},guid:1,proxy:function(e,t){var s,o,i;return"string"==typeof t&&(o=e[t],t=e,e=o),n.isFunction(e)?(i=m.call(arguments,2),s=function(){return e.apply(t||this,i.concat(m.call(arguments)))},s.guid=e.guid=e.guid||n.guid++,s):void 0},now:Date.now,support:i}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){B["[object "+t+"]"]=t.toLowerCase()}),g=function(e){function s(e,t,n,s){var l,d,u,m,f,p,b,j,y,_;if((t?t.ownerDocument||t:c)!==a&&v(t),t=t||a,n=n||[],!e||"string"!=typeof e)return n;if(1!==(m=t.nodeType)&&9!==m)return[];if(h&&!s){if(p=be.exec(e))if(d=p[1]){if(9===m){{if(l=t.getElementById(d),!l||!l.parentNode)return n;if(l.id===d)return n.push(l),n}}else if(t.ownerDocument&&(l=t.ownerDocument.getElementById(d))&&S(t,l)&&l.id===d)return n.push(l),n}else{if(p[2])return g.apply(n,t.getElementsByTagName(e)),n;if((d=p[3])&&o.getElementsByClassName&&t.getElementsByClassName)return g.apply(n,t.getElementsByClassName(d)),n}if(o.qsa&&(!r||!r.test(e))){if(u=j=i,_=t,y=9===m&&e,1===m&&"object"!==t.nodeName.toLowerCase()){for(f=k(e),(j=t.getAttribute("id"))?u=j.replace(ye,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",b=f.length;b--;)f[b]=u+L(f[b]);_=V.test(e)&&P(t.parentNode)||t,y=f.join(",")}if(y)try{return g.apply(n,_.querySelectorAll(y)),n}catch{}finally{j||t.removeAttribute("id")}}}return J(e.replace(M,"$1"),t,n,s)}function U(){function e(s,o){return n.push(s+" ")>t.cacheLength&&delete e[n.shift()],e[s+" "]=o}var n=[];return e}function l(e){return e[i]=!0,e}function d(e){var t=a.createElement("div");try{return!!e(t)}catch{return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function I(e,n){for(var o=e.split("|"),s=e.length;s--;)t.attrHandle[o[s]]=n}function se(e,t){var n=t&&e,s=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(s)return s;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function re(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ce(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function _(e){return l(function(t){return t=+t,l(function(n,s){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(s[o]=n[o]))})})}function P(e){return e&&typeof e.getElementsByTagName!==x&&e}function oe(){}function L(e){for(var t=0,s=e.length,n="";s>t;t++)n+=e[t].value;return n}function H(e,t,n){var s=t.dir,o=n&&"parentNode"===s,a=je++;return t.first?function(t,n,i){for(;t=t[s];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,r){var c,l,d=[u,a];if(r){for(;t=t[s];)if((1===t.nodeType||o)&&e(t,n,r))return!0}else for(;t=t[s];)if(1===t.nodeType||o){if(l=t[i]||(t[i]={}),(c=l[s])&&c[0]===u&&c[1]===a)return d[2]=c[2];if(l[s]=d,d[2]=e(t,n,r))return!0}}}function Y(e){return e.length>1?function(t,n,s){for(var o=e.length;o--;)if(!e[o](t,n,s))return!1;return!0}:e[0]}function _e(e,t,n){for(var o=0,i=t.length;i>o;o++)s(e,t[o],n);return n}function N(e,t,n,s,o){for(var a,r=[],i=0,c=e.length,l=t!=null;c>i;i++)(a=e[i])&&(!n||n(a,s,o))&&(r.push(a),l&&t.push(i));return r}function R(e,t,n,s,o,a){return s&&!s[i]&&(s=R(s)),o&&!o[i]&&(o=R(o,a)),l(function(i,a,r,c){var d,u,h,p=[],f=[],v=a.length,b=i||_e(t||"*",r.nodeType?[r]:r,[]),m=!e||!i&&t?b:N(b,p,e,r,c),l=n?o||(i?e:v||s)?[]:a:m;if(n&&n(m,l,r,c),s)for(u=N(l,f),s(u,[],r,c),d=u.length;d--;)(h=u[d])&&(l[f[d]]=!(m[f[d]]=h));if(i){if(o||e){if(o){for(u=[],d=l.length;d--;)(h=l[d])&&u.push(m[d]=h);o(null,l=[],u,c)}for(d=l.length;d--;)(h=l[d])&&(u=o?w.call(i,h):p[d])>-1&&(i[u]=!(a[u]=h))}}else l=N(l===a?l.splice(v,l.length):l),o?o(null,a,l,c):g.apply(a,l)})}function q(e){for(var s,o,c,r=e.length,l=t.relative[e[0].type],d=l||t.relative[" "],n=l?1:0,u=H(function(e){return e===c},d,!0),h=H(function(e){return w.call(c,e)>-1},d,!0),a=[function(e,t,n){return!l&&(n||t!==F)||((c=t).nodeType?u(e,t,n):h(e,t,n))}];r>n;n++)if(o=t.relative[e[n].type])a=[H(Y(a),o)];else{if(o=t.filter[e[n].type].apply(null,e[n].matches),o[i]){for(s=++n;r>s&&!t.relative[e[s].type];s++);return R(n>1&&Y(a),n>1&&L(e.slice(0,n-1).concat({value:" "===e[n-2].type?"*":""})).replace(M,"$1"),o,s>n&&q(e.slice(n,s)),r>s&&q(e=e.slice(s)),r>s&&L(e))}a.push(o)}return Y(a)}function we(e,n){var o=n.length>0,i=e.length>0,r=function(r,c,l,d,h){var f,v,j,b=0,m="0",y=r&&[],p=[],_=F,w=r||i&&t.find.TAG("*",h),O=u+=_==null?1:Math.random()||.1,x=w.length;for(h&&(F=c!==a&&c);m!==x&&null!=(f=w[m]);m++){if(i&&f){for(j=0;v=e[j++];)if(v(f,c,l)){d.push(f);break}h&&(u=O)}o&&((f=!v&&f)&&b--,r&&y.push(f))}if(b+=m,o&&m!==b){for(j=0;v=n[j++];)v(y,p,c,l);if(r){if(b>0)for(;m--;)y[m]||p[m]||(p[m]=ve.call(d));p=N(p)}g.apply(d,p),h&&!r&&p.length>0&&b+n.length>1&&s.uniqueSort(d)}return h&&(u=O,F=_),y};return o?l(r):r}var t,o,a,r,h,m,f,v,y,O,C,k,S,F,T,D,B,X,J,i="sizzle"+-new Date,c=e.document,u=0,je=0,ne=U(),te=U(),Z=U(),K=function(e,t){return e===t&&(C=!0),0},x="undefined",G=1<<31,ae={}.hasOwnProperty,p=[],ve=p.pop,fe=p.push,g=p.push,ee=p.slice,w=p.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},$="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",n=`[\\x20\\t\\r\\n\\f]`,E="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie=E.replace("w","w#"),Q="\\["+n+"*("+E+")(?:"+n+"*([*^$|!~]?=)"+n+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+ie+"))|)"+n+"*\\]",W=":("+E+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Q+")*)|.*)\\)|)",M=new RegExp("^"+n+"+|((?:^|[^\\\\])(?:\\\\.)*)"+n+"+$","g"),le=new RegExp("^"+n+"*,"+n+"*"),de=new RegExp("^"+n+"*([>+~]|"+n+")"+n+"*"),ue=new RegExp("="+n+`*([^\\]'"]*?)`+n+"*\\]","g"),he=new RegExp(W),me=new RegExp("^"+ie+"$"),z={ID:new RegExp("^#("+E+")"),CLASS:new RegExp("^\\.("+E+")"),TAG:new RegExp("^("+E.replace("w","w*")+")"),ATTR:new RegExp("^"+Q),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+n+"*(even|odd|(([+-]|)(\\d*)n|)"+n+"*(?:([+-]|)"+n+"*(\\d+)|))"+n+"*\\)|)","i"),bool:new RegExp("^(?:"+$+")$","i"),needsContext:new RegExp("^"+n+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+n+"*((?:-\\d)?\\d*)"+n+"*\\)|)(?=[^-]|$)","i")},pe=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,A=/^[^{]+\{\s*\[native \w/,be=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,V=/[+~]/,ye=/'|\\/g,b=new RegExp("\\\\([\\da-f]{1,6}"+n+"?|("+n+")|.)","ig"),j=function(e,t,n){var s="0x"+t-65536;return s!==s||n?t:0>s?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320)};try{g.apply(p=ee.call(c.childNodes),c.childNodes),p[c.childNodes.length].nodeType}catch{g={apply:p.length?function(e,t){fe.apply(e,ee.call(t))}:function(e,t){for(var n=e.length,s=0;e[n++]=t[s++];);e.length=n-1}}}o=s.support={},X=s.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},v=s.setDocument=function(e){var u,s=e?e.ownerDocument||e:c,l=s.defaultView;return s!==a&&9===s.nodeType&&s.documentElement?(a=s,m=s.documentElement,h=!X(s),l&&l!==l.top&&(l.addEventListener?l.addEventListener("unload",function(){v()},!1):l.attachEvent&&l.attachEvent("onunload",function(){v()})),o.attributes=d(function(e){return e.className="i",!e.getAttribute("className")}),o.getElementsByTagName=d(function(e){return e.appendChild(s.createComment("")),!e.getElementsByTagName("*").length}),o.getElementsByClassName=A.test(s.getElementsByClassName)&&d(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),o.getById=d(function(e){return m.appendChild(e).id=i,!s.getElementsByName||!s.getElementsByName(i).length}),o.getById?(t.find.ID=function(e,t){if(typeof t.getElementById!==x&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},t.filter.ID=function(e){var t=e.replace(b,j);return function(e){return e.getAttribute("id")===t}}):(delete t.find.ID,t.filter.ID=function(e){var t=e.replace(b,j);return function(e){var n=typeof e.getAttributeNode!==x&&e.getAttributeNode("id");return n&&n.value===t}}),t.find.TAG=o.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==x?t.getElementsByTagName(e):void 0}:function(e,t){var n,s=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&s.push(n);return s}return o},t.find.CLASS=o.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==x&&h?t.getElementsByClassName(e):void 0},y=[],r=[],(o.qsa=A.test(s.querySelectorAll))&&(d(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&r.push("[*^$]="+n+`*(?:''|"")`),e.querySelectorAll("[selected]").length||r.push("\\["+n+"*(?:value|"+$+")"),e.querySelectorAll(":checked").length||r.push(":checked")}),d(function(e){var t=s.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&r.push("name"+n+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||r.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),r.push(",.*:")})),(o.matchesSelector=A.test(D=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&d(function(e){o.disconnectedMatch=D.call(e,"div"),D.call(e,"[s!='']:x"),y.push("!=",W)}),r=r.length&&new RegExp(r.join("|")),y=y.length&&new RegExp(y.join("|")),u=A.test(m.compareDocumentPosition),S=u||A.test(m.contains)?function(e,t){var s=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(s.contains?s.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},K=u?function(e,t){if(e===t)return C=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!o.sortDetached&&t.compareDocumentPosition(e)===n?e===s||e.ownerDocument===c&&S(c,e)?-1:t===s||t.ownerDocument===c&&S(c,t)?1:f?w.call(f,e)-w.call(f,t):0:4&n?-1:1)}:function(e,t){if(e===t)return C=!0,0;var n,o=0,r=e.parentNode,l=t.parentNode,i=[e],a=[t];if(!r||!l)return e===s?-1:t===s?1:r?-1:l?1:f?w.call(f,e)-w.call(f,t):0;if(r===l)return se(e,t);for(n=e;n=n.parentNode;)i.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;i[o]===a[o];)o++;return o?se(i[o],a[o]):i[o]===c?-1:a[o]===c?1:0},s):a},s.matches=function(e,t){return s(e,null,null,t)},s.matchesSelector=function(e,t){if((e.ownerDocument||e)!==a&&v(e),t=t.replace(ue,"='$1']"),!(!o.matchesSelector||!h||y&&y.test(t)||r&&r.test(t)))try{var n=D.call(e,t);if(n||o.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch{}return s(t,a,null,[e]).length>0},s.contains=function(e,t){return(e.ownerDocument||e)!==a&&v(e),S(e,t)},s.attr=function(e,n){(e.ownerDocument||e)!==a&&v(e);var i=t.attrHandle[n.toLowerCase()],s=i&&ae.call(t.attrHandle,n.toLowerCase())?i(e,n,!h):void 0;return void 0!==s?s:o.attributes||!h?e.getAttribute(n):(s=e.getAttributeNode(n))&&s.specified?s.value:null},s.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},s.uniqueSort=function(e){var s,i=[],t=0,n=0;if(C=!o.detectDuplicates,f=!o.sortStable&&e.slice(0),e.sort(K),C){for(;s=e[n++];)s===e[n]&&(t=i.push(n));for(;t--;)e.splice(i[t],1)}return f=null,e},T=s.getText=function(e){var s,n="",o=0,t=e.nodeType;if(t){if(1===t||9===t||11===t){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=T(e)}else if(3===t||4===t)return e.nodeValue}else for(;s=e[o++];)n+=T(s);return n},t=s.selectors={cacheLength:50,createPseudo:l,match:z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(b,j),e[3]=(e[3]||e[4]||e[5]||"").replace(b,j),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||s.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&s.error(e[0]),e},PSEUDO:function(e){var n,t=!e[6]&&e[2];return z.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":t&&he.test(t)&&(n=k(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(e[0]=e[0].slice(0,n),e[2]=t.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(b,j).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=ne[e+" "];return t||(t=new RegExp("(^|"+n+")"+e+"("+n+"|$)"))&&ne(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==x&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(o){var i=s.attr(o,e);return i==null?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,s,o){var c="nth"!==e.slice(0,3),r="last"!==e.slice(-4),a="of-type"===t;return 1===s&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var d,h,m,f,g,b,v=c!==r?"nextSibling":"previousSibling",p=t.parentNode,y=a&&t.nodeName.toLowerCase(),j=!l&&!a;if(p){if(c){for(;v;){for(d=t;d=d[v];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;g=v="only"===e&&!g&&"nextSibling"}return!0}if(g=[r?p.firstChild:p.lastChild],r&&j){for(b=p[i]||(p[i]={}),m=b[e]||[],f=m[0]===u&&m[1],h=m[0]===u&&m[2],d=f&&p.childNodes[f];d=++f&&d&&d[v]||(h=f=0)||g.pop();)if(1===d.nodeType&&++h&&d===t){b[e]=[u,f,h];break}}else if(j&&(m=(t[i]||(t[i]={}))[e])&&m[0]===u)h=m[1];else for(;(d=++f&&d&&d[v]||(h=f=0)||g.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++h||(j&&((d[i]||(d[i]={}))[e]=[u,h]),d!==t)););return h-=o,h===s||h%s===0&&h/s>=0}}},PSEUDO:function(e,n){var a,o=t.pseudos[e]||t.setFilters[e.toLowerCase()]||s.error("unsupported pseudo: "+e);return o[i]?o(n):o.length>1?(a=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?l(function(e,t){for(var s,i=o(e,n),a=i.length;a--;)s=w.call(e,i[a]),e[s]=!(t[s]=i[a])}):function(e){return o(e,0,a)}):o}},pseudos:{not:l(function(e){var n=[],s=[],t=B(e.replace(M,"$1"));return t[i]?l(function(e,n,s,o){for(var a,r=t(e,null,o,[]),i=e.length;i--;)(a=r[i])&&(e[i]=!(n[i]=a))}):function(e,o,i){return n[0]=e,t(n,null,i,s),!s.pop()}}),has:l(function(e){return function(t){return s(e,t).length>0}}),contains:l(function(e){return function(t){return(t.textContent||t.innerText||T(t)).indexOf(e)>-1}}),lang:l(function(e){return me.test(e||"")||s.error("unsupported lang: "+e),e=e.replace(b,j).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType)return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===m},focus:function(e){return e===a.activeElement&&(!a.hasFocus||a.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return pe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:_(function(){return[0]}),last:_(function(e,t){return[t-1]}),eq:_(function(e,t,n){return[0>n?n+t:n]}),even:_(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:_(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:_(function(e,t,n){for(var s=0>n?n+t:n;--s>=0;)e.push(s);return e}),gt:_(function(e,t,n){for(var s=0>n?n+t:n;++s<t;)e.push(s);return e})}},t.pseudos.nth=t.pseudos.eq;for(O in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[O]=re(O);for(O in{submit:!0,reset:!0})t.pseudos[O]=ce(O);return oe.prototype=t.filters=t.pseudos,t.setFilters=new oe,k=s.tokenize=function(e,n){var o,i,a,r,c,l,d,u=te[e+" "];if(u)return n?0:u.slice(0);for(o=e,l=[],d=t.preFilter;o;){(!a||(i=le.exec(o)))&&(i&&(o=o.slice(i[0].length)||o),l.push(c=[])),a=!1,(i=de.exec(o))&&(a=i.shift(),c.push({value:a,type:i[0].replace(M," ")}),o=o.slice(a.length));for(r in t.filter)!(i=z[r].exec(o))||d[r]&&!(i=d[r](i))||(a=i.shift(),c.push({value:a,type:r,matches:i}),o=o.slice(a.length));if(!a)break}return n?o.length:o?s.error(e):te(e,l).slice(0)},B=s.compile=function(e,t){var s,o=[],a=[],n=Z[e+" "];if(!n){for(t||(t=k(e)),s=t.length;s--;)n=q(t[s]),n[i]?o.push(n):a.push(n);n=Z(e,we(a,o)),n.selector=e}return n},J=s.select=function(e,n,s,i){var a,r,c,u,m,d="function"==typeof e&&e,l=!i&&k(e=d.selector||e);if(s=s||[],1===l.length){if(a=l[0]=l[0].slice(0),a.length>2&&"ID"===(r=a[0]).type&&o.getById&&9===n.nodeType&&h&&t.relative[a[1].type]){if(n=(t.find.ID(r.matches[0].replace(b,j),n)||[])[0],!n)return s;d&&(n=n.parentNode),e=e.slice(a.shift().value.length)}for(c=z.needsContext.test(e)?0:a.length;c--&&(r=a[c],!t.relative[u=r.type]);)if((m=t.find[u])&&(i=m(r.matches[0].replace(b,j),V.test(a[0].type)&&P(n.parentNode)||n))){if(a.splice(c,1),e=i.length&&L(a),!e)return g.apply(s,i),s;break}}return(d||B(e,l))(i,n,!h,s,V.test(e)&&P(n.parentNode)||n),s},o.sortStable=i.split("").sort(K).join("")===i,o.detectDuplicates=!!C,v(),o.sortDetached=d(function(e){return 1&e.compareDocumentPosition(a.createElement("div"))}),d(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||I("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),o.attributes&&d(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||I("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),d(function(e){return null==e.getAttribute("disabled")})||I($,function(e,t,n){var s;return n?void 0:e[t]===!0?t.toLowerCase():(s=e.getAttributeNode(t))&&s.specified?s.value:null}),s}(e),n.find=g,n.expr=g.selectors,n.expr[":"]=n.expr.pseudos,n.unique=g.uniqueSort,n.text=g.getText,n.isXMLDoc=g.isXML,n.contains=g.contains;var ke=n.expr.match.needsContext,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,jt=/^.[^:#[.,]*$/;n.filter=function(e,t,s){var o=t[0];return s&&(e=":not("+e+")"),1===t.length&&1===o.nodeType?n.find.matchesSelector(o,e)?[o]:[]:n.find.matches(e,n.grep(t,function(e){return 1===e.nodeType}))},n.fn.extend({find:function(e){var t,o=this.length,s=[],i=this;if("string"!=typeof e)return this.pushStack(n(e).filter(function(){for(t=0;o>t;t++)if(n.contains(i[t],this))return!0}));for(t=0;o>t;t++)n.find(e,i[t],s);return s=this.pushStack(o>1?n.unique(s):s),s.selector=this.selector?this.selector+" "+e:e,s},filter:function(e){return this.pushStack(K(this,e||[],!1))},not:function(e){return this.pushStack(K(this,e||[],!0))},is:function(e){return!!K(this,"string"==typeof e&&ke.test(e)?n(e):e||[],!1).length}}),le=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,oe=n.fn.init=function(e,t){var s,i;if(!e)return this;if("string"==typeof e){if(s="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:le.exec(e),!s||!s[1]&&t)return!t||t.jquery?(t||I).find(e):this.constructor(t).find(e);if(s[1]){if(t=t instanceof n?t[0]:t,n.merge(this,n.parseHTML(s[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),ae.test(s[1])&&n.isPlainObject(t))for(s in t)n.isFunction(this[s])?this[s](t[s]):this.attr(s,t[s]);return this}return i=o.getElementById(s[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):n.isFunction(e)?"undefined"!=typeof I.ready?I.ready(e):e(n):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),n.makeArray(e,this))},oe.prototype=n.fn,I=n(o),ue=/^(?:parents|prev(?:Until|All))/,he={children:!0,contents:!0,next:!0,prev:!0},n.extend({dir:function(e,t,s){for(var o=[],i=void 0!==s;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&n(e).is(s))break;o.push(e)}return o},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),n.fn.extend({has:function(e){var t=n(e,this),s=t.length;return this.filter(function(){for(var e=0;s>e;e++)if(n.contains(this,t[e]))return!0})},closest:function(e,t){for(var s,i=0,r=this.length,o=[],a=ke.test(e)||"string"!=typeof e?n(e,t||this.context):0;r>i;i++)for(s=this[i];s&&s!==t;s=s.parentNode)if(s.nodeType<11&&(a?a.index(s)>-1:1===s.nodeType&&n.find.matchesSelector(s,e))){o.push(s);break}return this.pushStack(o.length>1?n.unique(o):o)},index:function(e){return e?"string"==typeof e?V.call(n(e),this[0]):V.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(n.unique(n.merge(this.get(),n(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),n.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return n.dir(e,"parentNode")},parentsUntil:function(e,t,s){return n.dir(e,"parentNode",s)},next:function(e){return Pe(e,"nextSibling")},prev:function(e){return Pe(e,"previousSibling")},nextAll:function(e){return n.dir(e,"nextSibling")},prevAll:function(e){return n.dir(e,"previousSibling")},nextUntil:function(e,t,s){return n.dir(e,"nextSibling",s)},prevUntil:function(e,t,s){return n.dir(e,"previousSibling",s)},siblings:function(e){return n.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return n.sibling(e.firstChild)},contents:function(e){return e.contentDocument||n.merge([],e.childNodes)}},function(e,t){n.fn[e]=function(s,o){var i=n.map(this,t,s);return"Until"!==e.slice(-5)&&(o=s),o&&"string"==typeof o&&(i=n.filter(o,i)),this.length>1&&(he[e]||n.unique(i),ue.test(e)&&i.reverse()),this.pushStack(i)}}),d=/\S+/g,te={},n.Callbacks=function(e){e="string"==typeof e?te[e]||Rt(e):n.extend({},e);var o,i,a,r,l,d,t=[],s=!e.once&&[],u=function(n){for(o=e.memory&&n,l=!0,a=d||0,d=0,i=t.length,r=!0;t&&i>a;a++)if(t[a].apply(n[0],n[1])===!1&&e.stopOnFalse){o=!1;break}r=!1,t&&(s?s.length&&u(s.shift()):o?t=[]:c.disable())},c={add:function(){if(t){var s=t.length;!function s(o){n.each(o,function(o,i){var a=n.type(i);"function"===a?e.unique&&c.has(i)||t.push(i):i&&i.length&&"string"!==a&&s(i)})}(arguments),r?i=t.length:o&&(d=s,u(o))}return this},remove:function(){return t&&n.each(arguments,function(e,s){for(var o;(o=n.inArray(s,t,o))>-1;)t.splice(o,1),r&&(i>=o&&i--,a>=o&&a--)}),this},has:function(e){return e?n.inArray(e,t)>-1:!!t&&!!t.length},empty:function(){return t=[],i=0,this},disable:function(){return t=s=o=void 0,this},disabled:function(){return!t},lock:function(){return s=void 0,o||c.disable(),this},locked:function(){return!s},fireWith:function(e,n){return!t||l&&!s||(n=n||[],n=[e,n.slice?n.slice():n],r?s.push(n):u(n)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!l}};return c},n.extend({Deferred:function(e){var o=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return t.done(arguments).fail(arguments),this},then:function(){var e=arguments;return n.Deferred(function(i){n.each(o,function(o,a){var r=n.isFunction(e[o])&&e[o];t[a[1]](function(){var e=r&&r.apply(this,arguments);e&&n.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a[0]+"With"](this===s?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?n.extend(e,s):s}},t={};return s.pipe=s.then,n.each(o,function(e,n){var a=n[2],r=n[3];s[n[1]]=a.add,r&&a.add(function(){i=r},o[1^e][2].disable,o[2][2].lock),t[n[0]]=function(){return t[n[0]+"With"](this===t?s:this,arguments),this},t[n[0]+"With"]=a.fireWith}),s.promise(t),e&&e.call(t,t),t},when:function(e){var r,c,l,t=0,o=m.call(arguments),s=o.length,a=1!==s||e&&n.isFunction(e.promise)?s:0,i=1===a?e:n.Deferred(),d=function(e,t,n){return function(s){t[e]=this,n[e]=arguments.length>1?m.call(arguments):s,n===r?i.notifyWith(t,n):--a||i.resolveWith(t,n)}};if(s>1)for(r=new Array(s),l=new Array(s),c=new Array(s);s>t;t++)o[t]&&n.isFunction(o[t].promise)?o[t].promise().done(d(t,c,o)).fail(i.reject).progress(d(t,l,r)):--a;return a||i.resolveWith(c,o),i.promise()}}),n.fn.ready=function(e){return n.ready.promise().done(e),this},n.extend({isReady:!1,readyWait:1,holdReady:function(e){e?n.readyWait++:n.ready(!0)},ready:function(e){(e===!0?--n.readyWait:n.isReady)||(n.isReady=!0,e!==!0&&--n.readyWait>0||(R.resolveWith(o,[n]),n.fn.triggerHandler&&(n(o).triggerHandler("ready"),n(o).off("ready"))))}}),n.ready.promise=function(t){return R||(R=n.Deferred(),"complete"===o.readyState?setTimeout(n.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),R.promise(t)},n.ready.promise(),u=n.access=function(e,t,s,o,i,a,r){var c=0,d=e.length,l=s==null;if("object"===n.type(s)){i=!0;for(c in s)n.access(e,t,c,s[c],!0,a,r)}else if(void 0!==o&&(i=!0,n.isFunction(o)||(r=!0),l&&(r?(t.call(e,o),t=null):(l=t,t=function(e,t,s){return l.call(n(e),s)})),t))for(;d>c;c++)t(e[c],s,r?o:o.call(e[c],c,t(e[c],s)));return i?e:l?t.call(e):d?t(e[0],s):a},n.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},f.uid=1,f.accepts=n.acceptData,f.prototype={key:function(e){if(!f.accepts(e))return 0;var s={},t=e[this.expando];if(!t){t=f.uid++;try{s[this.expando]={value:t},Object.defineProperties(e,s)}catch{s[this.expando]=t,n.extend(e,s)}}return this.cache[t]||(this.cache[t]={}),t},set:function(e,t,s){var i,a=this.key(e),o=this.cache[a];if("string"==typeof t)o[t]=s;else if(n.isEmptyObject(o))n.extend(this.cache[a],t);else for(i in t)o[i]=t[i];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,s){var o;return void 0===t||t&&"string"==typeof t&&void 0===s?(o=this.get(e,t),void 0!==o?o:this.get(e,n.camelCase(t))):(this.set(e,t,s),void 0!==s?s:t)},remove:function(e,t){var s,o,i,r=this.key(e),a=this.cache[r];if(void 0===t)this.cache[r]={};else for(n.isArray(t)?s=t.concat(t.map(n.camelCase)):(i=n.camelCase(t),t in a?s=[t,i]:(s=i,s=s in a?[s]:s.match(d)||[])),o=s.length;o--;)delete a[s[o]]},hasData:function(e){return!n.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var s=new f,a=new f,ft=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ht=/([A-Z])/g;n.extend({hasData:function(e){return a.hasData(e)||s.hasData(e)},data:function(e,t,n){return a.access(e,t,n)},removeData:function(e,t){a.remove(e,t)},_data:function(e,t,n){return s.access(e,t,n)},_removeData:function(e,t){s.remove(e,t)}}),n.fn.extend({data:function(e,t){var i,r,c,o=this[0],l=o&&o.attributes;if(void 0===e){if(this.length&&(c=a.get(o),1===o.nodeType&&!s.get(o,"hasDataAttrs"))){for(r=l.length;r--;)l[r]&&(i=l[r].name,0===i.indexOf("data-")&&(i=n.camelCase(i.slice(5)),Ce(o,i,c[i])));s.set(o,"hasDataAttrs",!0)}return c}return"object"==typeof e?this.each(function(){a.set(this,e)}):u(this,function(t){var s,i=n.camelCase(e);if(o&&void 0===t){{if(s=a.get(o,e),void 0!==s)return s;if(s=a.get(o,i),void 0!==s)return s;if(s=Ce(o,i,void 0),void 0!==s)return s}}else this.each(function(){var n=a.get(this,i);a.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&a.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){a.remove(this,e)})}}),n.extend({queue:function(e,t,o){var i;return e?(t=(t||"fx")+"queue",i=s.get(e,t),o&&(!i||n.isArray(o)?i=s.access(e,t,n.makeArray(o)):i.push(o)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var s=n.queue(e,t),a=s.length,o=s.shift(),i=n._queueHooks(e,t),r=function(){n.dequeue(e,t)};"inprogress"===o&&(o=s.shift(),a--),o&&("fx"===t&&s.unshift("inprogress"),delete i.stop,o.call(e,r,i)),!a&&i&&i.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return s.get(e,o)||s.access(e,o,{empty:n.Callbacks("once memory").add(function(){s.remove(e,[t+"queue",o])})})}}),n.fn.extend({queue:function(e,t){var s=2;return"string"!=typeof e&&(t=e,e="fx",s--),arguments.length<s?n.queue(this[0],e):void 0===t?this:this.each(function(){var s=n.queue(this,e,t);n._queueHooks(this,e),"fx"===e&&"inprogress"!==s[0]&&n.dequeue(this,e)})},dequeue:function(e){return this.each(function(){n.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var o,a=1,r=n.Deferred(),i=this,c=this.length,l=function(){--a||r.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";c--;)o=s.get(i[c],e+"queueHooks"),o&&o.empty&&(a++,o.empty.add(l));return l(),r.promise(t)}});var P=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,v=["Top","Right","Bottom","Left"],O=function(e,t){return e=t||e,"none"===n.css(e,"display")||!n.contains(e.ownerDocument,e)},xe=/^(?:checkbox|radio)$/i;!function(){var n=o.createDocumentFragment(),e=n.appendChild(o.createElement("div")),t=o.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),i.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",i.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}(),b="undefined",i.focusinBubbles="onfocusin"in e;var ut=/^key/,dt=/^(?:mouse|pointer|contextmenu)|click/,Ae=/^(?:focusinfocus|focusoutblur)$/,Se=/^([^.]*)(?:\.(.+)|)$/;n.event={global:{},add:function(e,t,o,i,a){var r,c,l,u,m,f,p,g,v,j,y,h=s.get(e);if(h)for(o.handler&&(m=o,o=m.handler,a=m.selector),o.guid||(o.guid=n.guid++),(p=h.events)||(p=h.events={}),(f=h.handle)||(f=h.handle=function(t){return typeof n!==b&&n.event.triggered!==t.type?n.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(d)||[""],v=t.length;v--;)g=Se.exec(t[v])||[],r=y=g[1],j=(g[2]||"").split(".").sort(),r&&(c=n.event.special[r]||{},r=(a?c.delegateType:c.bindType)||r,c=n.event.special[r]||{},l=n.extend({type:r,origType:y,data:i,handler:o,guid:o.guid,selector:a,needsContext:a&&n.expr.match.needsContext.test(a),namespace:j.join(".")},m),(u=p[r])||(u=p[r]=[],u.delegateCount=0,c.setup&&c.setup.call(e,i,j,f)!==!1||e.addEventListener&&e.addEventListener(r,f,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=o.guid)),a?u.splice(u.delegateCount++,0,l):u.push(l),n.event.global[r]=!0)},remove:function(e,t,o,i,a){var r,c,l,u,h,m,p,g,v,b,j,f=s.hasData(e)&&s.get(e);if(f&&(m=f.events)){for(t=(t||"").match(d)||[""],g=t.length;g--;)if(l=Se.exec(t[g])||[],r=j=l[1],v=(l[2]||"").split(".").sort(),r){for(u=n.event.special[r]||{},r=(i?u.delegateType:u.bindType)||r,h=m[r]||[],l=l[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"),b=p=h.length;p--;)c=h[p],!a&&j!==c.origType||o&&o.guid!==c.guid||l&&!l.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(p,1),c.selector&&h.delegateCount--,u.remove&&u.remove.call(e,c));b&&!h.length&&(u.teardown&&u.teardown.call(e,v,f.handle)!==!1||n.removeEvent(e,r,f.handle),delete m[r])}else for(r in m)n.event.remove(e,r+t[g],o,i,!0);n.isEmptyObject(m)&&(delete f.handle,s.remove(e,"events"))}},trigger:function(t,i,a,r){var c,d,u,h,m,g,v,p=[a||o],l=G.call(t,"type")?t.type:t,f=G.call(t,"namespace")?t.namespace.split("."):[];if(c=d=a=a||o,3!==a.nodeType&&8!==a.nodeType&&!Ae.test(l+n.event.triggered)&&(l.indexOf(".")>=0&&(f=l.split("."),l=f.shift(),f.sort()),h=l.indexOf(":")<0&&"on"+l,t=t[n.expando]?t:new n.Event(l,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=a),i=i==null?[t]:n.makeArray(i,[t]),u=n.event.special[l]||{},r||!u.trigger||u.trigger.apply(a,i)!==!1)){if(!r&&!u.noBubble&&!n.isWindow(a)){for(v=u.delegateType||l,Ae.test(v+l)||(c=c.parentNode);c;c=c.parentNode)p.push(c),d=c;d===(a.ownerDocument||o)&&p.push(d.defaultView||d.parentWindow||e)}for(g=0;(c=p[g++])&&!t.isPropagationStopped();)t.type=g>1?v:u.bindType||l,m=(s.get(c,"events")||{})[t.type]&&s.get(c,"handle"),m&&m.apply(c,i),m=h&&c[h],m&&m.apply&&n.acceptData(c)&&(t.result=m.apply(c,i),t.result===!1&&t.preventDefault());return t.type=l,r||t.isDefaultPrevented()||u._default&&u._default.apply(p.pop(),i)!==!1||!n.acceptData(a)||h&&n.isFunction(a[l])&&!n.isWindow(a)&&(d=a[h],d&&(a[h]=null),n.event.triggered=l,a[l](),n.event.triggered=void 0,d&&(a[h]=d)),t.result}},dispatch:function(e){e=n.event.fix(e);var t,o,a,r,c,l=[],d=m.call(arguments),u=(s.get(this,"events")||{})[e.type]||[],i=n.event.special[e.type]||{};if(d[0]=e,e.delegateTarget=this,!i.preDispatch||i.preDispatch.call(this,e)!==!1){for(l=n.event.handlers.call(this,e,u),r=0;(o=l[r++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,c=0;(t=o.handlers[c++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(t.namespace))&&(e.handleObj=t,e.data=t.data,a=((n.event.special[t.origType]||{}).handle||t.handler).apply(o.elem,d),void 0!==a&&(e.result=a)===!1&&(e.preventDefault(),e.stopPropagation()));return i.postDispatch&&i.postDispatch.call(this,e),e.result}},handlers:function(e,t){var o,i,a,r,l=[],c=t.delegateCount,s=e.target;if(c&&s.nodeType&&(!e.button||"click"!==e.type))for(;s!==this;s=s.parentNode||this)if(s.disabled!==!0||"click"!==e.type){for(o=[],a=0;c>a;a++)r=t[a],i=r.selector+" ",void 0===o[i]&&(o[i]=r.needsContext?n(i,this).index(s)>=0:n.find(i,this,null,[s]).length),o[i]&&o.push(r);o.length&&l.push({elem:s,handlers:o})}return c<t.length&&l.push({elem:this,handlers:t.slice(c)}),l},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,s,a,i=t.button;return null==e.pageX&&null!=t.clientX&&(a=e.target.ownerDocument||o,n=a.documentElement,s=a.body,e.pageX=t.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)),e.which||void 0===i||(e.which=1&i?1:2&i?3:4&i?2:0),e}},fix:function(e){if(e[n.expando])return e;var i,a,r,s=e.type,c=e,t=this.fixHooks[s];for(t||(this.fixHooks[s]=t=dt.test(s)?this.mouseHooks:ut.test(s)?this.keyHooks:{}),r=t.props?this.props.concat(t.props):this.props,e=new n.Event(c),i=r.length;i--;)a=r[i],e[a]=c[a];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),t.filter?t.filter(e,c):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==ye()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===ye()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return n.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,s,o){var i=n.extend(new n.Event,s,{type:e,isSimulated:!0,originalEvent:{}});o?n.event.trigger(i,null,t):n.event.dispatch.call(t,i),i.isDefaultPrevented()&&s.preventDefault()}},n.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},n.Event=function(e,t){return this instanceof n.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?L:j):this.type=e,t&&n.extend(this,t),this.timeStamp=e&&e.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(e,t)},n.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=L,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=L,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=L,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){n.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,i=this,s=e.relatedTarget,a=e.handleObj;return(!s||s!==i&&!n.contains(i,s))&&(e.type=a.origType,o=a.handler.apply(this,arguments),e.type=t),o}}}),i.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(e,t){var o=function(e){n.event.simulate(t,e.target,n.event.fix(e),!0)};n.event.special[t]={setup:function(){var n=this.ownerDocument||this,i=s.access(n,t);i||n.addEventListener(e,o,!0),s.access(n,t,(i||0)+1)},teardown:function(){var n=this.ownerDocument||this,i=s.access(n,t)-1;i?s.access(n,t,i):(n.removeEventListener(e,o,!0),s.remove(n,t))}}}),n.fn.extend({on:function(e,t,s,o,i){var a,r;if("object"==typeof e){"string"!=typeof t&&(s=s||t,t=void 0);for(r in e)this.on(r,t,s,e[r],i);return this}if(s==null&&o==null?(o=t,s=t=void 0):o==null&&("string"==typeof t?(o=s,s=void 0):(o=s,s=t,t=void 0)),o===!1)o=j;else if(!o)return this;return 1===i&&(a=o,o=function(e){return n().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=n.guid++)),this.each(function(){n.event.add(this,e,o,s,t)})},one:function(e,t,n,s){return this.on(e,t,n,s,1)},off:function(e,t,s){var o,i;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,n(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(s=t,t=void 0),s===!1&&(s=j),this.each(function(){n.event.remove(this,e,s,t)})},trigger:function(e,t){return this.each(function(){n.event.trigger(e,t,this)})},triggerHandler:function(e,t){var s=this[0];return s?n.event.trigger(e,t,s,!0):void 0}});var Me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Fe=/<([\w:]+)/,lt=/<|&#?\w+;/,ct=/<(?:script|style|link)/i,rt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^$|\/(?:java|ecma)script/i,at=/^true\/(.*)/,it=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,l={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};l.optgroup=l.option,l.tbody=l.tfoot=l.colgroup=l.caption=l.thead,l.th=l.td,n.extend({clone:function(e,t,s){var o,a,c,d,l=e.cloneNode(!0),u=n.contains(e.ownerDocument,e);if(!(i.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||n.isXMLDoc(e)))for(a=r(l),c=r(e),o=0,d=c.length;d>o;o++)Dt(c[o],a[o]);if(t)if(s)for(c=c||r(e),a=a||r(l),o=0,d=c.length;d>o;o++)ce(c[o],a[o]);else ce(e,l);return a=r(l,"script"),a.length>0&&W(a,!u&&r(e,"script")),l},buildFragment:function(e,t,s,o){for(var i,a,u,h,f,p,c=t.createDocumentFragment(),m=[],d=0,g=e.length;g>d;d++)if(i=e[d],i||0===i)if("object"===n.type(i))n.merge(m,i.nodeType?[i]:i);else if(lt.test(i)){for(a=a||c.appendChild(t.createElement("div")),f=(Fe.exec(i)||["",""])[1].toLowerCase(),u=l[f]||l._default,a.innerHTML=u[1]+i.replace(Me,"<$1></$2>")+u[2],h=u[0];h--;)a=a.lastChild;n.merge(m,a.childNodes),a=c.firstChild,a.textContent=""}else m.push(t.createTextNode(i));for(c.textContent="",d=0;i=m[d++];)if((!o||-1===n.inArray(i,o))&&(p=n.contains(i.ownerDocument,i),a=r(c.appendChild(i),"script"),p&&W(a),s))for(h=0;i=a[h++];)Ne.test(i.type||"")&&s.push(i);return c},cleanData:function(e){for(var t,o,i,r,l=n.event.special,c=0;void 0!==(t=e[c]);c++){if(n.acceptData(t)&&(o=t[s.expando],o&&(i=s.cache[o]))){if(i.events)for(r in i.events)l[r]?n.event.remove(t,r):n.removeEvent(t,r,i.handle);s.cache[o]&&delete s.cache[o]}delete a.cache[t[a.expando]]}}}),n.fn.extend({text:function(e){return u(this,function(e){return void 0===e?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=be(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=be(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var s,i=e?n.filter(e,this):this,o=0;null!=(s=i[o]);o++)t||1!==s.nodeType||n.cleanData(r(s)),s.parentNode&&(t&&n.contains(s.ownerDocument,s)&&W(r(s,"script")),s.parentNode.removeChild(s));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(n.cleanData(r(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e??!1,t=t??e,this.map(function(){return n.clone(this,e,t)})},html:function(e){return u(this,function(e){var t=this[0]||{},s=0,o=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ct.test(e)&&!l[(Fe.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Me,"<$1></$2>");try{for(;o>s;s++)t=this[s]||{},1===t.nodeType&&(n.cleanData(r(t,!1)),t.innerHTML=e);t=0}catch{}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,n.cleanData(r(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=we.apply([],e);var o,c,l,d,m,f,a=0,u=this.length,g=this,v=u-1,h=e[0],p=n.isFunction(h);if(p||u>1&&"string"==typeof h&&!i.checkClone&&rt.test(h))return this.each(function(n){var s=g.eq(n);p&&(e[0]=h.call(this,n,s.html())),s.domManip(e,t)});if(u&&(l=n.buildFragment(e,this[0].ownerDocument,!1,this),m=l.firstChild,1===l.childNodes.length&&(l=m),m)){for(c=n.map(r(l,"script"),Lt),d=c.length;u>a;a++)o=l,a!==v&&(o=n.clone(o,!0,!0),d&&n.merge(c,r(o,"script"))),t.call(this[a],o,a);if(d)for(f=c[c.length-1].ownerDocument,n.map(c,Nt),a=0;d>a;a++)o=c[a],Ne.test(o.type||"")&&!s.access(o,"globalEval")&&n.contains(f,o)&&(o.src?n._evalUrl&&n._evalUrl(o.src):n.globalEval(o.textContent.replace(it,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){n.fn[e]=function(e){for(var o,i=[],a=n(e),r=a.length-1,s=0;r>=s;s++)o=s===r?this:this.clone(!0),n(a[s])[t](o),U.apply(i,o.get());return this.pushStack(i)}});var F,Ie={},Be=/^margin/,q=new RegExp("^("+P+")(?!px)[a-z%]+$","i"),$=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};!function(){function c(){t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",t.innerHTML="",a.appendChild(s);var n=e.getComputedStyle(t,null),l="1%"!==n.top,r="4px"===n.width;a.removeChild(s)}var r,l,a=o.documentElement,s=o.createElement("div"),t=o.createElement("div");t.style&&(t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",i.clearCloneStyle="content-box"===t.style.backgroundClip,s.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",s.appendChild(t),e.getComputedStyle&&n.extend(i,{pixelPosition:function(){return c(),l},boxSizingReliable:function(){return r==null&&c(),r},reliableMarginRight:function(){var i,n=t.appendChild(o.createElement("div"));return n.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",t.style.width="1px",a.appendChild(s),i=!parseFloat(e.getComputedStyle(n,null).marginRight),a.removeChild(s),i}}))}(),n.swap=function(e,t,n,s){var o,i,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,s||[]);for(o in t)e.style[o]=a[o];return i};var ot=/^(none|table(?!-c[ea]).+)/,nt=new RegExp("^("+P+")(.*)$","i"),tt=new RegExp("^([+-])=("+P+")","i"),Je={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","O","Moz","ms"];n.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=C(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,s,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,r,l,c=n.camelCase(t),d=e.style;return t=n.cssProps[c]||(n.cssProps[c]=$e(d,c)),a=n.cssHooks[t]||n.cssHooks[c],void 0===s?a&&"get"in a&&void 0!==(r=a.get(e,!1,o))?r:d[t]:(l=typeof s,"string"===l&&(r=tt.exec(s))&&(s=(r[1]+1)*r[2]+parseFloat(n.css(e,t)),l="number"),void(s!=null&&s===s&&("number"!==l||n.cssNumber[c]||(s+="px"),i.clearCloneStyle||""!==s||0!==t.indexOf("background")||(d[t]="inherit"),a&&"set"in a&&void 0===(s=a.set(e,s,o))||(d[t]=s))))}},css:function(e,t,s,o){var i,a,c,r=n.camelCase(t);return t=n.cssProps[r]||(n.cssProps[r]=$e(e.style,r)),a=n.cssHooks[t]||n.cssHooks[r],a&&"get"in a&&(i=a.get(e,!0,s)),void 0===i&&(i=C(e,t,o)),"normal"===i&&t in Ye&&(i=Ye[t]),""===s||s?(c=parseFloat(i),s===!0||n.isNumeric(c)?c||0:i):i}}),n.each(["height","width"],function(e,t){n.cssHooks[t]={get:function(e,s,o){return s?ot.test(n.css(e,"display"))&&0===e.offsetWidth?n.swap(e,Je,function(){return Ke(e,t,o)}):Ke(e,t,o):void 0},set:function(e,s,o){var i=o&&$(e);return de(e,s,o?Xe(e,t,o,"border-box"===n.css(e,"boxSizing",!1,i),i):0)}}}),n.cssHooks.marginRight=Oe(i.reliableMarginRight,function(e,t){return t?n.swap(e,{display:"inline-block"},C,[e,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(e,t){n.cssHooks[e+t]={expand:function(n){for(var s=0,i={},o="string"==typeof n?n.split(" "):[n];4>s;s++)i[e+v[s]+t]=o[s]||o[s-2]||o[0];return i}},Be.test(e)||(n.cssHooks[e+t].set=de)}),n.fn.extend({css:function(e,t){return u(this,function(e,t,s){var i,a,r={},o=0;if(n.isArray(t)){for(i=$(e),a=t.length;a>o;o++)r[t[o]]=n.css(e,t[o],!1,i);return r}return void 0!==s?n.style(e,t,s):n.css(e,t)},e,t,arguments.length>1)},show:function(){return Ue(this,!0)},hide:function(){return Ue(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){O(this)?n(this).show():n(this).hide()})}}),n.Tween=c,c.prototype={constructor:c,init:function(e,t,s,o,i,a){this.elem=e,this.prop=s,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=o,this.unit=a||(n.cssNumber[s]?"":"px")},cur:function(){var e=c.propHooks[this.prop];return e&&e.get?e.get(this):c.propHooks._default.get(this)},run:function(e){var s,t=c.propHooks[this.prop];return this.pos=s=this.options.duration?n.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*s+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),t&&t.set?t.set(this):c.propHooks._default.set(this),this}},c.prototype.init.prototype=c.prototype,c.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=n.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){n.fx.step[e.prop]?n.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[n.cssProps[e.prop]]||n.cssHooks[e.prop])?n.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},c.propHooks.scrollTop=c.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},n.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},n.fx=c.prototype.init,n.fx.step={};var _,z,Ze=/^(?:toggle|show|hide)$/,qe=new RegExp("^(?:([+-])=|)("+P+")([a-z%]*)$","i"),et=/queueHooks$/,H=[zt],x={"*":[function(e,t){var i=this.createTween(e,t),c=i.cur(),s=qe.exec(t),a=s&&s[3]||(n.cssNumber[e]?"":"px"),o=(n.cssNumber[e]||"px"!==a&&+c)&&qe.exec(n.css(i.elem,e)),r=1,l=20;if(o&&o[3]!==a){a=a||o[3],s=s||[],o=+c||1;do r=r||".5",o/=r,n.style(i.elem,e,o+a);while(r!==(r=i.cur()/c)&&1!==r&&--l)}return s&&(o=i.start=+o||+c||0,i.unit=a,i.end=s[1]?o+(s[1]+1)*s[2]:+s[2]),i}]};n.Animation=n.extend(De,{tweener:function(e,t){n.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var s,o=0,i=e.length;i>o;o++)s=e[o],x[s]=x[s]||[],x[s].unshift(t)},prefilter:function(e,t){t?H.unshift(e):H.push(e)}}),n.speed=function(e,t,s){var o=e&&"object"==typeof e?n.extend({},e):{complete:s||!s&&t||n.isFunction(e)&&e,duration:e,easing:s&&t||t&&!n.isFunction(t)&&t};return o.duration=n.fx.off?0:"number"==typeof o.duration?o.duration:o.duration in n.fx.speeds?n.fx.speeds[o.duration]:n.fx.speeds._default,(null==o.queue||o.queue===!0)&&(o.queue="fx"),o.old=o.complete,o.complete=function(){n.isFunction(o.old)&&o.old.call(this),o.queue&&n.dequeue(this,o.queue)},o},n.fn.extend({fadeTo:function(e,t,n,s){return this.filter(O).css("opacity",0).show().end().animate({opacity:t},e,n,s)},animate:function(e,t,o,i){var c=n.isEmptyObject(e),r=n.speed(t,o,i),a=function(){var t=De(this,n.extend({},e),r);(c||s.get(this,"finish"))&&t.stop(!0)};return a.finish=a,c||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,o){var i=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof e&&(o=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var c=!0,t=e!=null&&e+"queueHooks",r=n.timers,a=s.get(this);if(t)a[t]&&a[t].stop&&i(a[t]);else for(t in a)a[t]&&a[t].stop&&et.test(t)&&i(a[t]);for(t=r.length;t--;)r[t].elem!==this||e!=null&&r[t].queue!==e||(r[t].anim.stop(o),c=!1,r.splice(t,1));(c||!o)&&n.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,a=s.get(this),o=a[e+"queue"],r=a[e+"queueHooks"],i=n.timers,c=o?o.length:0;for(a.finish=!0,n.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;c>t;t++)o[t]&&o[t].finish&&o[t].finish.call(this);delete a.finish})}}),n.each(["toggle","show","hide"],function(e,t){var s=n.fn[t];n.fn[t]=function(e,n,o){return e==null||"boolean"==typeof e?s.apply(this,arguments):this.animate(M(t,!0),e,n,o)}}),n.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){n.fn[e]=function(e,n,s){return this.animate(t,e,n,s)}}),n.timers=[],n.fx.tick=function(){var s,e=0,t=n.timers;for(_=n.now();e<t.length;e++)s=t[e],s()||t[e]!==s||t.splice(e--,1);t.length||n.fx.stop(),_=void 0},n.fx.timer=function(e){n.timers.push(e),e()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){z||(z=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(z),z=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(e,t){return e=n.fx?n.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var s=setTimeout(t,e);n.stop=function(){clearTimeout(s)}})},function(){var e=o.createElement("input"),t=o.createElement("select"),n=t.appendChild(o.createElement("option"));e.type="checkbox",i.checkOn=""!==e.value,i.optSelected=n.selected,t.disabled=!0,i.optDisabled=!n.disabled,e=o.createElement("input"),e.value="t",e.type="radio",i.radioValue="t"===e.value}(),y=n.expr.attrHandle,n.fn.extend({attr:function(e,t){return u(this,n.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){n.removeAttr(this,e)})}}),n.extend({attr:function(e,t,s){var o,i,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?typeof e.getAttribute===b?n.prop(e,t,s):(1===a&&n.isXMLDoc(e)||(t=t.toLowerCase(),o=n.attrHooks[t]||(n.expr.match.bool.test(t)?We:st)),void 0===s?o&&"get"in o&&null!==(i=o.get(e,t))?i:(i=n.find.attr(e,t),i??void 0):null!==s?o&&"set"in o&&void 0!==(i=o.set(e,s,t))?i:(e.setAttribute(t,s+""),s):void n.removeAttr(e,t)):void 0},removeAttr:function(e,t){var s,o,a=0,i=t&&t.match(d);if(i&&1===e.nodeType)for(;s=i[a++];)o=n.propFix[s]||s,n.expr.match.bool.test(s)&&(e[o]=!1),e.removeAttribute(s)},attrHooks:{type:{set:function(e,t){if(!i.radioValue&&"radio"===t&&n.nodeName(e,"input")){var s=e.value;return e.setAttribute("type",t),s&&(e.value=s),t}}}}}),We={set:function(e,t,s){return t===!1?n.removeAttr(e,s):e.setAttribute(s,s),s}},n.each(n.expr.match.bool.source.match(/\w+/g),function(e,t){var s=y[t]||n.find.attr;y[t]=function(e,t,n){var o,i;return n||(i=y[t],y[t]=o,o=null!=s(e,t,n)?t.toLowerCase():null,y[t]=i),o}}),Le=/^(?:input|select|textarea|button)$/i,n.fn.extend({prop:function(e,t){return u(this,n.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[n.propFix[e]||e]})}}),n.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,s){var o,i,r,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?(r=1!==a||!n.isXMLDoc(e),r&&(t=n.propFix[t]||t,o=n.propHooks[t]),void 0!==s?o&&"set"in o&&void 0!==(i=o.set(e,s,t))?i:e[t]=s:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]):void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||Le.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),i.optSelected||(n.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this}),D=/[\t\r\n\f]/g,n.fn.extend({addClass:function(e){var t,s,o,i,r,c,l="string"==typeof e&&e,a=0,u=this.length;if(n.isFunction(e))return this.each(function(t){n(this).addClass(e.call(this,t,this.className))});if(l)for(r=(e||"").match(d)||[];u>a;a++)if(t=this[a],s=1===t.nodeType&&(t.className?(" "+t.className+" ").replace(D," "):" ")){for(c=0;o=r[c++];)s.indexOf(" "+o+" ")<0&&(s+=o+" ");i=n.trim(s),t.className!==i&&(t.className=i)}return this},removeClass:function(e){var t,s,o,i,r,c,l=0===arguments.length||"string"==typeof e&&e,a=0,u=this.length;if(n.isFunction(e))return this.each(function(t){n(this).removeClass(e.call(this,t,this.className))});if(l)for(r=(e||"").match(d)||[];u>a;a++)if(t=this[a],s=1===t.nodeType&&(t.className?(" "+t.className+" ").replace(D," "):"")){for(c=0;o=r[c++];)for(;s.indexOf(" "+o+" ")>=0;)s=s.replace(" "+o+" "," ");i=e?n.trim(s):"",t.className!==i&&(t.className=i)}return this},toggleClass:function(e,t){var o=typeof e;return"boolean"==typeof t&&"string"===o?t?this.addClass(e):this.removeClass(e):this.each(n.isFunction(e)?function(s){n(this).toggleClass(e.call(this,s,this.className,t),t)}:function(){if("string"===o)for(var t,a=0,i=n(this),r=e.match(d)||[];t=r[a++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else(o===b||"boolean"===o)&&(this.className&&s.set(this,"__className__",this.className),this.className=this.className||e===!1?"":s.get(this,"__className__")||"")})},hasClass:function(e){for(var n=" "+e+" ",t=0,s=this.length;s>t;t++)if(1===this[t].nodeType&&(" "+this[t].className+" ").replace(D," ").indexOf(n)>=0)return!0;return!1}}),ze=/\r/g,n.fn.extend({val:function(e){var t,s,i,o=this[0];return arguments.length?(i=n.isFunction(e),this.each(function(s){var o;1===this.nodeType&&(o=i?e.call(this,s,n(this).val()):e,o==null?o="":"number"==typeof o?o+="":n.isArray(o)&&(o=n.map(o,function(e){return e==null?"":e+""})),t=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))})):o?(t=n.valHooks[o.type]||n.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(s=t.get(o,"value"))?s:(s=o.value,"string"==typeof s?s.replace(ze,""):s??"")):void 0}}),n.extend({valHooks:{option:{get:function(e){var t=n.find.attr(e,"value");return t??n.trim(n.text(e))}},select:{get:function(e){for(var t,r,c=e.options,s=e.selectedIndex,o="select-one"===e.type||0>s,l=o?null:[],d=o?s+1:c.length,a=0>s?d:o?s:0;d>a;a++)if(t=c[a],!(!t.selected&&a!==s||(i.optDisabled?t.disabled:null!==t.getAttribute("disabled"))||t.parentNode.disabled&&n.nodeName(t.parentNode,"optgroup"))){if(r=n(t).val(),o)return r;l.push(r)}return l},set:function(e,t){for(var s,o,i=e.options,a=n.makeArray(t),r=i.length;r--;)s=i[r],(s.selected=n.inArray(s.value,a)>=0)&&(o=!0);return o||(e.selectedIndex=-1),a}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(e,t){return n.isArray(t)?e.checked=n.inArray(n(e).val(),t)>=0:void 0}},i.checkOn||(n.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){n.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),n.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,s){return this.on(t,e,n,s)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),N=n.now(),A=/\?/,n.parseJSON=function(e){return JSON.parse(e+"")},n.parseXML=function(e){var t,s;if(!e||"string"!=typeof e)return null;try{s=new DOMParser,t=s.parseFromString(e,"text/xml")}catch{t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+e),t};var h,p,mt=/#.*$/,je=/([?&])_=[^&]*/,pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,gt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,vt=/^(?:GET|HEAD)$/,bt=/^\/\//,re=/^([\w.+-]+:)(?:\/\/(?:[^/?#]*@|)([^/?#:]*)(?::(\d+)|)|)/,me={},ne={},fe="*/".concat("*");try{h=location.href}catch{h=o.createElement("a"),h.href="",h=h.href}p=re.exec(h.toLowerCase())||[],n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:h,type:"GET",isLocal:gt.test(p[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":fe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ee(ee(e,n.ajaxSettings),t):ee(n.ajaxSettings,e)},ajaxPrefilter:Te(me),ajaxTransport:Te(ne),ajax:function(e,t){function v(e,t,c,l){var h,p,g,v,O,d=t;2!==a&&(a=2,b&&clearTimeout(b),u=void 0,_=l||"",o.readyState=e>0?4:0,h=e>=200&&300>e||304===e,c&&(p=Qe(s,o,c)),p=Ft(s,p,o,h),h?(s.ifModified&&(g=o.getResponseHeader("Last-Modified"),g&&(n.lastModified[i]=g),g=o.getResponseHeader("etag"),g&&(n.etag[i]=g)),204===e||"HEAD"===s.type?d="nocontent":304===e?d="notmodified":(d=p.state,O=p.data,v=p.error,h=!v)):(v=d,(e||!d)&&(d="error",0>e&&(e=0))),o.status=e,o.statusText=(t||d)+"",h?j.resolveWith(r,[O,d,o]):j.rejectWith(r,[o,d,v]),o.statusCode(f),f=void 0,m&&y.trigger(h?"ajaxSuccess":"ajaxError",[o,s,h?O:v]),w.fireWith(r,[o,d]),m&&(y.trigger("ajaxComplete",[o,s]),--n.active||n.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,c,l,u,m,g,b,_,s=n.ajaxSetup({},t),r=s.context||s,y=s.context&&(r.nodeType||r.jquery)?n(r):n.event,j=n.Deferred(),w=n.Callbacks("once memory"),f=s.statusCode||{},O={},x={},a=0,C="canceled",o={readyState:0,getResponseHeader:function(e){var t;if(2===a){if(!g)for(g={};t=pt.exec(_);)g[t[1].toLowerCase()]=t[2];t=g[e.toLowerCase()]}return t??null},getAllResponseHeaders:function(){return 2===a?_:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return a||(e=x[n]=x[n]||e,O[e]=t),this},overrideMimeType:function(e){return a||(s.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>a)for(t in e)f[t]=[f[t],e[t]];else o.always(e[o.status]);return this},abort:function(e){var t=e||C;return u&&u.abort(t),v(0,t),this}};if(j.promise(o).complete=w.add,o.success=o.done,o.error=o.fail,s.url=((e||s.url||h)+"").replace(mt,"").replace(bt,p[1]+"//"),s.type=t.method||t.type||s.method||s.type,s.dataTypes=n.trim(s.dataType||"*").toLowerCase().match(d)||[""],null==s.crossDomain&&(c=re.exec(s.url.toLowerCase()),s.crossDomain=!(!c||c[1]===p[1]&&c[2]===p[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(p[3]||("http:"===p[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=n.param(s.data,s.traditional)),ie(me,s,t,o),2===a)return o;m=s.global,m&&0===n.active++&&n.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!vt.test(s.type),i=s.url,s.hasContent||(s.data&&(i=s.url+=(A.test(i)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=je.test(i)?i.replace(je,"$1_="+N++):i+(A.test(i)?"&":"?")+"_="+N++)),s.ifModified&&(n.lastModified[i]&&o.setRequestHeader("If-Modified-Since",n.lastModified[i]),n.etag[i]&&o.setRequestHeader("If-None-Match",n.etag[i])),(s.data&&s.hasContent&&s.contentType!==!1||t.contentType)&&o.setRequestHeader("Content-Type",s.contentType),o.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+fe+"; q=0.01":""):s.accepts["*"]);for(l in s.headers)o.setRequestHeader(l,s.headers[l]);if(s.beforeSend&&(s.beforeSend.call(r,o,s)===!1||2===a))return o.abort();C="abort";for(l in{success:1,error:1,complete:1})o[l](s[l]);if(u=ie(ne,s,t,o)){o.readyState=1,m&&y.trigger("ajaxSend",[o,s]),s.async&&s.timeout>0&&(b=setTimeout(function(){o.abort("timeout")},s.timeout));try{a=1,u.send(O,v)}catch(e){if(!(2>a))throw e;v(-1,e)}}else v(-1,"No Transport");return o},getJSON:function(e,t,s){return n.get(e,t,s,"json")},getScript:function(e,t){return n.get(e,void 0,t,"script")}}),n.each(["get","post"],function(e,t){n[t]=function(e,s,o,i){return n.isFunction(s)&&(i=i||o,o=s,s=void 0),n.ajax({url:e,type:t,dataType:i,data:s,success:o})}}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){n.fn[t]=function(e){return this.on(t,e)}}),n._evalUrl=function(e){return n.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},n.fn.extend({wrapAll:function(e){var t;return n.isFunction(e)?this.each(function(t){n(this).wrapAll(e.call(this,t))}):(this[0]&&(t=n(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(n.isFunction(e)?function(t){n(this).wrapInner(e.call(this,t))}:function(){var t=n(this),s=t.contents();s.length?s.wrapAll(e):t.append(e)})},wrap:function(e){var t=n.isFunction(e);return this.each(function(s){n(this).wrapAll(t?e.call(this,s):e)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},n.expr.filters.visible=function(e){return!n.expr.filters.hidden(e)};var Ot=/%20/g,xt=/\[\]$/,pe=/\r?\n/g,Et=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;n.param=function(e,t){var s,o=[],i=function(e,t){t=n.isFunction(t)?t():t??"",o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(e)||e.jquery&&!n.isPlainObject(e))n.each(e,function(){i(this.name,this.value)});else for(s in e)Y(s,e[s],t,i);return o.join("&").replace(Ot,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=n.prop(this,"elements");return e?n.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!n(this).is(":disabled")&&kt.test(this.nodeName)&&!Et.test(e)&&(this.checked||!xe.test(e))}).map(function(e,t){var s=n(this).val();return s==null?null:n.isArray(s)?n.map(s,function(e){return{name:t.name,value:e.replace(pe,`
`)}}):{name:t.name,value:s.replace(pe,`
`)}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch{}};var At=0,k={},Mt={0:200,1223:204},E=n.ajaxSettings.xhr();return e.ActiveXObject&&n(e).on("unload",function(){for(var e in k)k[e]()}),i.cors=!!E&&"withCredentials"in E,i.ajax=E=!!E,n.ajaxTransport(function(e){var t;return i.cors||E&&!e.crossDomain?{send:function(n,s){var i,o=e.xhr(),a=++At;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete k[a],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?s(o.status,o.statusText):s(Mt[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=k[a]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return n.globalEval(e),e}}}),n.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),n.ajaxTransport("script",function(e){if(e.crossDomain){var t,s;return{send:function(i,a){s=n("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",t=function(e){s.remove(),t=null,e&&a("error"===e.type?404:200,e.type)}),o.head.appendChild(s[0])},abort:function(){t&&t()}}}}),se=[],T=/(=)\?(?=&|$)|\?\?/,n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=se.pop()||n.expando+"_"+N++;return this[e]=!0,e}}),n.ajaxPrefilter("json jsonp",function(t,s,o){var i,a,r,c=t.jsonp!==!1&&(T.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&T.test(t.data)&&"data");return c||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=n.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,c?t[c]=t[c].replace(T,"$1"+i):t.jsonp!==!1&&(t.url+=(A.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||n.error(i+" was not called"),a[0]},t.dataTypes[0]="json",r=e[i],e[i]=function(){a=arguments},o.always(function(){e[i]=r,t[i]&&(t.jsonpCallback=s.jsonpCallback,se.push(i)),a&&n.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),n.parseHTML=function(e,t,s){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(s=t,t=!1),t=t||o;var i=ae.exec(e),a=!s&&[];return i?[t.createElement(i[1])]:(i=n.buildFragment([e],t,a),a&&a.length&&n(a).remove(),n.merge([],i.childNodes))},J=n.fn.load,n.fn.load=function(e,t,s){if("string"!=typeof e&&J)return J.apply(this,arguments);var o,r,c,i=this,a=e.indexOf(" ");return a>=0&&(o=n.trim(e.slice(a)),e=e.slice(0,a)),n.isFunction(t)?(s=t,t=void 0):t&&"object"==typeof t&&(r="POST"),i.length>0&&n.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){c=arguments,i.html(o?n("<div>").append(n.parseHTML(e)).find(o):e)}).complete(s&&function(e,t){i.each(s,c||[e.responseText,t,e])}),this},n.expr.filters.animated=function(e){return n.grep(n.timers,function(t){return e===t.elem}).length},Z=e.document.documentElement,n.offset={setOffset:function(e,t,s){var o,a,r,c,l,d,m,u=n.css(e,"position"),h=n(e),i={};"static"===u&&(e.style.position="relative"),o=h.offset(),c=n.css(e,"top"),d=n.css(e,"left"),m=("absolute"===u||"fixed"===u)&&(c+d).indexOf("auto")>-1,m?(a=h.position(),l=a.top,r=a.left):(l=parseFloat(c)||0,r=parseFloat(d)||0),n.isFunction(t)&&(t=t.call(e,s,o)),null!=t.top&&(i.top=t.top-o.top+l),null!=t.left&&(i.left=t.left-o.left+r),"using"in t?t.using.call(e,i):h.css(i)}},n.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){n.offset.setOffset(this,e,t)});var s,i,t=this[0],o={top:0,left:0},a=t&&t.ownerDocument;return a?(s=a.documentElement,n.contains(s,t)?(typeof t.getBoundingClientRect!==b&&(o=t.getBoundingClientRect()),i=Ee(a),{top:o.top+i.pageYOffset-s.clientTop,left:o.left+i.pageXOffset-s.clientLeft}):o):void 0},position:function(){if(this[0]){var e,s,o=this[0],t={top:0,left:0};return"fixed"===n.css(o,"position")?s=o.getBoundingClientRect():(e=this.offsetParent(),s=this.offset(),n.nodeName(e[0],"html")||(t=e.offset()),t.top+=n.css(e[0],"borderTopWidth",!0),t.left+=n.css(e[0],"borderLeftWidth",!0)),{top:s.top-t.top-n.css(o,"marginTop",!0),left:s.left-t.left-n.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Z;e&&!n.nodeName(e,"html")&&"static"===n.css(e,"position");)e=e.offsetParent;return e||Z})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,s){var o="pageYOffset"===s;n.fn[t]=function(n){return u(this,function(t,n,i){var a=Ee(t);return void 0===i?a?a[s]:t[n]:void(a?a.scrollTo(o?e.pageXOffset:i,o?i:e.pageYOffset):t[n]=i)},t,n,arguments.length,null)}}),n.each(["top","left"],function(e,t){n.cssHooks[t]=Oe(i.pixelPosition,function(e,s){return s?(s=C(e,t),q.test(s)?n(e).position()[t]+"px":s):void 0})}),n.each({Height:"height",Width:"width"},function(e,t){n.each({padding:"inner"+e,content:t,"":"outer"+e},function(s,o){n.fn[o]=function(o,i){var a=arguments.length&&(s||"boolean"!=typeof o),r=s||(o===!0||i===!0?"margin":"border");return u(this,function(t,s,o){var i;return n.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===o?n.css(t,s,r):n.style(t,s,o,r)},t,a?o:void 0,a,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n}),ve=e.jQuery,Re=e.$,n.noConflict=function(t){return e.$===n&&(e.$=Re),t&&e.jQuery===n&&(e.jQuery=ve),n},typeof t===b&&(e.jQuery=e.$=n),n}),Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch{return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join(`
`):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join(`
`)),e},addGetWebGLMessage:function(e){var t,n,s;e=e||{},n=void 0!==e.parent?e.parent:document.body,s=void 0!==e.id?e.id:"oldie",t=Detector.getWebGLErrorMessage(),t.id=s,n.appendChild(t)}},"object"==typeof module&&(module.exports=Detector),dat=dat||{},dat.gui=dat.gui||{},dat.utils=dat.utils||{},dat.controllers=dat.controllers||{},dat.dom=dat.dom||{},dat.color=dat.color||{},dat.utils.css=function(){return{load:function(e,t){var t=t||document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){var t=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}}}(),dat.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),s=t.length-1;s>=0;s--)n=[t[s].apply(this,n)];return n[0]}},each:function(e,n,s){if(t&&e.forEach===t)e.forEach(n,s);else if(e.length===e.length+0)for(var o=0,i=e.length;i>o&&!(o in e&&n.call(s,e[o],o)===this.BREAK);o++);else for(o in e)if(n.call(s,e[o],o)===this.BREAK)break},defer:function(e){setTimeout(e,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),dat.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onFinishChange=this.__onChange=void 0};return e.extend(t.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),t}(dat.utils.common),dat.dom.dom=function(e){function t(t){return"0"===t||e.isUndefined(t)?0:(t=t.match(o),e.isNull(t)?0:parseFloat(t[1]))}s={},e.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,n){e.each(t,function(e){s[e]=n})});var s,o=/(\d+(\.\d+)?)px/,n={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,n,s){e.isUndefined(n)&&(n=!0),e.isUndefined(s)&&(s=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),s&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,n,o,i){var a,o=o||{},r=s[n];if(!r)throw Error("Event type "+n+" not supported.");switch(a=document.createEvent(r),r){case"MouseEvents":a.initMouseEvent(n,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,o.x||o.clientX||0,o.y||o.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":r=a.initKeyboardEvent||a.initKeyEvent,e.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),r(n,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:a.initEvent(n,o.bubbles||!1,o.cancelable||!0)}e.defaults(a,i),t.dispatchEvent(a)},bind:function(e,t,s,o){return e.addEventListener?e.addEventListener(t,s,o||!1):e.attachEvent&&e.attachEvent("on"+t,s),n},unbind:function(e,t,s,o){return e.removeEventListener?e.removeEventListener(t,s,o||!1):e.detachEvent&&e.detachEvent("on"+t,s),n},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var s=e.className.split(/ +/);-1==s.indexOf(t)&&(s.push(t),e.className=s.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return n},removeClass:function(e,t){if(t){if(void 0!==e.className)if(e.className===t)e.removeAttribute("class");else{var s=e.className.split(/ +/),o=s.indexOf(t);-1!=o&&(s.splice(o,1),e.className=s.join(" "))}}else e.className=void 0;return n},hasClass:function(e,t){return RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){return e=getComputedStyle(e),t(e["border-left-width"])+t(e["border-right-width"])+t(e["padding-left"])+t(e["padding-right"])+t(e.width)},getHeight:function(e){return e=getComputedStyle(e),t(e["border-top-width"])+t(e["border-bottom-width"])+t(e["padding-top"])+t(e["padding-bottom"])+t(e.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent)return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return n}(dat.utils.common),dat.controllers.OptionController=function(e,t,n){var s=function(e,o,i){s.superclass.call(this,e,o);var a,r=this;(this.__select=document.createElement("select"),n.isArray(i))&&(a={},n.each(i,function(e){a[e]=e}),i=a),n.each(i,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),r.__select.appendChild(n)}),this.updateDisplay(),t.bind(this.__select,"change",function(){r.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)};return s.superclass=e,n.extend(s.prototype,e.prototype,{setValue:function(e){return e=s.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),s.superclass.prototype.updateDisplay.call(this)}}),s}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.NumberController=function(e,t){var n=function(e,s,o){n.superclass.call(this,e,s),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,e=this.__impliedStep=t.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,e=e.toString(),this.__precision=e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0};return n.superclass=e,t.extend(n.prototype,e.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),n.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),n}(dat.controllers.Controller,dat.utils.common),dat.controllers.NumberControllerBox=function(e,t,n){var s=function(e,o,i){function c(){var e=parseFloat(a.__input.value);n.isNaN(e)||a.setValue(e)}function l(e){var t=r-e.clientY;a.setValue(a.getValue()+t*a.__impliedStep),r=e.clientY}function d(){t.unbind(window,"mousemove",l),t.unbind(window,"mouseup",d)}this.__truncationSuspended=!1,s.superclass.call(this,e,o,i);var r,a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",c),t.bind(this.__input,"blur",function(){c(),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}),t.bind(this.__input,"mousedown",function(e){t.bind(window,"mousemove",l),t.bind(window,"mouseup",d),r=e.clientY}),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&(a.__truncationSuspended=!0,this.blur(),a.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return s.superclass=e,n.extend(s.prototype,e.prototype,{updateDisplay:function(){var e,t,n=this.__input;return this.__truncationSuspended?e=this.getValue():(e=this.getValue(),t=Math.pow(10,this.__precision),e=Math.round(e*t)/t),n.value=e,s.superclass.prototype.updateDisplay.call(this)}}),s}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common),dat.controllers.NumberControllerSlider=function(e,t,n,s,o){var i=function(e,n,s,o,a){function c(e){e.preventDefault();var n=t.getOffset(r.__background),s=t.getWidth(r.__background);return r.setValue(r.__min+(r.__max-r.__min)*((e.clientX-n.left)/(n.left+s-n.left))),!1}function l(){t.unbind(window,"mousemove",c),t.unbind(window,"mouseup",l),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}i.superclass.call(this,e,n,{min:s,max:o,step:a});var r=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",function(e){t.bind(window,"mousemove",c),t.bind(window,"mouseup",l),c(e)}),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return i.superclass=e,i.useDefaultStyles=function(){n.inject(o)},s.extend(i.prototype,e.prototype,{updateDisplay:function(){return this.__foreground.style.width=(this.getValue()-this.__min)/(this.__max-this.__min)*100+"%",i.superclass.prototype.updateDisplay.call(this)}}),i}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,`.slider {
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);
  height: 1em;
  border-radius: 1em;
  background-color: #eee;
  padding: 0 0.5em;
  overflow: hidden;
}

.slider-fg {
  padding: 1px 0 2px 0;
  background-color: #aaa;
  height: 1em;
  margin-left: -0.5em;
  padding-right: 0.5em;
  border-radius: 1em 0 0 1em;
}

.slider-fg:after {
  display: inline-block;
  border-radius: 1em;
  background-color: #fff;
  border:  1px solid #aaa;
  content: '';
  float: right;
  margin-right: -1em;
  margin-top: -1px;
  height: 0.9em;
  width: 0.9em;
}`),dat.controllers.FunctionController=function(e,t,n){var s=function(e,n,o){s.superclass.call(this,e,n);var i=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===o?"Fire":o,t.bind(this.__button,"click",function(e){return e.preventDefault(),i.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return s.superclass=e,n.extend(s.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),s}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.BooleanController=function(e,t,n){var s=function(e,n){s.superclass.call(this,e,n);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",function(){o.setValue(!o.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return s.superclass=e,n.extend(s.prototype,e.prototype,{setValue:function(e){return e=s.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,s.superclass.prototype.updateDisplay.call(this)}}),s}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(t=t.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(dat.utils.common),dat.color.interpret=function(e,t){var n,s,o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){return e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i),null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){return e=e.match(/^#([A-F0-9]{6})$/i),null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:e},CSS_RGB:{read:function(e){return e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/),null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:e},CSS_RGBA:{read:function(e){return e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/),null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){s=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(o){return o.litmus(e)?(t.each(o.conversions,function(o,i){return n=o.read(e),s===!1&&n!==!1?(s=n,n.conversionName=i,n.conversion=o,t.BREAK):void 0}),t.BREAK):void 0}),s}}(dat.color.toString,dat.utils.common),dat.GUI=dat.gui.GUI=function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f){function j(e,t,n,i){if(void 0===t[n])throw Error("Object "+t+' has no property "'+n+'"');i.color?t=new d(t,n):(t=[t,n].concat(i.factoryArgs),t=s.apply(e,t)),i.before instanceof o&&(i.before=i.before.__li),A(e,t),m.addClass(t.domElement,"c"),n=document.createElement("span"),m.addClass(n,"property-name"),n.innerHTML=t.property;var a=document.createElement("div");return a.appendChild(n),a.appendChild(t.domElement),i=E(e,a,i.before),m.addClass(i,p.CLASS_CONTROLLER_ROW),m.addClass(i,typeof t.getValue()),z(e,i,t),e.__controllers.push(t),t}function E(e,t,n){var s=document.createElement("li");return t&&s.appendChild(t),n?e.__ul.insertBefore(s,params.before):e.__ul.appendChild(s),e.onResize(),s}function z(e,t,n){if(n.__li=t,n.__gui=e,f.extend(n,{options:function(t){return arguments.length>1?(n.remove(),j(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[f.toArray(arguments)]})):f.isArray(t)||f.isObject(t)?(n.remove(),j(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof c){var o,s=new r(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});f.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=n[e],o=s[e];n[e]=s[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e),o.apply(s,e)}}),m.addClass(t,"has-slider"),n.domElement.insertBefore(s.domElement,n.domElement.firstElementChild)}else n instanceof r?(o=function(t){return f.isNumber(n.__min)&&f.isNumber(n.__max)?(n.remove(),j(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):t},n.min=f.compose(o,n.min),n.max=f.compose(o,n.max)):n instanceof i?(m.bind(t,"click",function(){m.fakeEvent(n.__checkbox,"click")}),m.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof a?(m.bind(t,"click",function(){m.fakeEvent(n.__button,"click")}),m.bind(t,"mouseover",function(){m.addClass(n.__button,"hover")}),m.bind(t,"mouseout",function(){m.removeClass(n.__button,"hover")})):n instanceof d&&(m.addClass(t,"color"),n.updateDisplay=f.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=f.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&x(e.getRoot(),!0),t},n.setValue)}function A(e,t){var o,n=e.getRoot(),s=n.__rememberedObjects.indexOf(t.object);if(-1!=s&&(o=n.__rememberedObjectIndecesToControllers[s],void 0===o&&(o={},n.__rememberedObjectIndecesToControllers[s]=o),o[t.property]=t,n.load&&n.load.remembered)){if(n=n.load.remembered,n[e.preset])n=n[e.preset];else{if(!n[v])return;n=n[v]}n[s]&&void 0!==n[s][t.property]&&(s=n[s][t.property],t.initialValue=s,t.setValue(s))}}function T(e){if(t=e.__save_row=document.createElement("li"),m.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),m.addClass(t,"save-row"),i=document.createElement("span"),i.innerHTML="&nbsp;",m.addClass(i,"button gears"),n=document.createElement("span"),n.innerHTML="Save",m.addClass(n,"button"),m.addClass(n,"save"),s=document.createElement("span"),s.innerHTML="New",m.addClass(s,"button"),m.addClass(s,"save-as"),o=document.createElement("span"),o.innerHTML="Revert",m.addClass(o,"button"),m.addClass(o,"revert"),r=e.__preset_select=document.createElement("select"),e.load&&e.load.remembered?f.each(e.load.remembered,function(t,n){O(e,n,n==e.preset)}):O(e,v,!1),m.bind(r,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(r),t.appendChild(i),t.appendChild(n),t.appendChild(s),t.appendChild(o),b){var n,s,o,i,a,r,c,t=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");t.style.display="block",t=document.getElementById("dg-local-storage"),"true"===localStorage.getItem(document.location.href+".isLocal")&&t.setAttribute("checked","checked"),c=function(){l.style.display=e.useLocalStorage?"block":"none"},c(),m.bind(t,"change",function(){e.useLocalStorage=!e.useLocalStorage,c()})}a=document.getElementById("dg-new-constructor"),m.bind(a,"keydown",function(e){e.metaKey&&(67===e.which||67==e.keyCode)&&y.hide()}),m.bind(i,"click",function(){a.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),y.show(),a.focus(),a.select()}),m.bind(n,"click",function(){e.save()}),m.bind(s,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),m.bind(o,"click",function(){e.revert()})}function F(e){function n(n){return n.preventDefault(),t=n.clientX,m.addClass(e.__closeButton,p.CLASS_DRAG),m.bind(window,"mousemove",s),m.bind(window,"mouseup",o),!1}function s(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function o(){m.removeClass(e.__closeButton,p.CLASS_DRAG),m.unbind(window,"mousemove",s),m.unbind(window,"mouseup",o)}e.__resize_handle=document.createElement("div"),f.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var t;m.bind(e.__resize_handle,"mousedown",n),m.bind(e.__closeButton,"mousedown",n),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function C(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function w(e,t){var n={};return f.each(e.__rememberedObjects,function(s,o){var i={};f.each(e.__rememberedObjectIndecesToControllers[o],function(e,n){i[n]=t?e.initialValue:e.getValue()}),n[o]=i}),n}function O(e,t,n){var s=document.createElement("option");s.innerHTML=t,s.value=t,e.__preset_select.appendChild(s),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function x(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function k(e){0!=e.length&&u(function(){k(e)}),f.each(e,function(e){e.updateDisplay()})}e.inject(n),v="Default";try{b="localStorage"in window&&null!==window.localStorage}catch{b=!1}var g,v,b,y,S=!0,_=!1,M=[],p=function(e){function i(){localStorage.setItem(document.location.href+".gui",JSON.stringify(t.getSaveObject()))}function a(){var e=t.getRoot();e.width+=1,f.defer(function(){e.width-=1})}var n,s,o,t=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),m.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=e||{},e=f.defaults(e,{autoPlace:!0,width:p.DEFAULT_WIDTH}),e=f.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),f.isUndefined(e.load)?e.load={preset:v}:e.preset&&(e.load.preset=e.preset),f.isUndefined(e.parent)&&e.hideable&&M.push(this),e.resizable=f.isUndefined(e.parent)&&e.resizable,e.autoPlace&&f.isUndefined(e.scrollable)&&(e.scrollable=!0),o=b&&"true"===localStorage.getItem(document.location.href+".isLocal"),Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return t.parent?t.getRoot().preset:e.load.preset},set:function(n){for(t.parent?t.getRoot().preset=n:e.load.preset=n,n=0;n<this.__preset_select.length;n++)this.__preset_select[n].value==this.preset&&(this.__preset_select.selectedIndex=n);t.revert()}},width:{get:function(){return e.width},set:function(n){e.width=n,C(t,n)}},name:{get:function(){return e.name},set:function(t){e.name=t,s&&(s.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(n){e.closed=n,e.closed?m.addClass(t.__ul,p.CLASS_CLOSED):m.removeClass(t.__ul,p.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=n?p.TEXT_OPEN:p.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return o},set:function(e){b&&((o=e)?m.bind(window,"unload",i):m.unbind(window,"unload",i),localStorage.setItem(document.location.href+".isLocal",e))}}}),f.isUndefined(e.parent)?((e.closed=!1,m.addClass(this.domElement,p.CLASS_MAIN),m.makeSelectable(this.domElement,!1),b&&o)&&(t.useLocalStorage=!0,n=localStorage.getItem(document.location.href+".gui"),n&&(e.load=JSON.parse(n))),this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=p.TEXT_CLOSED,m.addClass(this.__closeButton,p.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),m.bind(this.__closeButton,"click",function(){t.closed=!t.closed})):(void 0===e.closed&&(e.closed=!0),s=document.createTextNode(e.name),m.addClass(s,"controller-name"),n=E(t,s),m.addClass(this.__ul,p.CLASS_CLOSED),m.addClass(n,"title"),m.bind(n,"click",function(e){return e.preventDefault(),t.closed=!t.closed,!1}),e.closed||(this.closed=!1)),e.autoPlace&&(f.isUndefined(e.parent)&&(S&&(g=document.createElement("div"),m.addClass(g,"dg"),m.addClass(g,p.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(g),S=!1),g.appendChild(this.domElement),m.addClass(this.domElement,p.CLASS_AUTO_PLACE)),this.parent||C(t,e.width)),m.bind(window,"resize",function(){t.onResize()}),m.bind(this.__ul,"webkitTransitionEnd",function(){t.onResize()}),m.bind(this.__ul,"transitionend",function(){t.onResize()}),m.bind(this.__ul,"oTransitionEnd",function(){t.onResize()}),this.onResize(),e.resizable&&F(this),t.getRoot(),e.parent||a()};return p.toggleHide=function(){_=!_,f.each(M,function(e){e.domElement.style.zIndex=_?-999:999,e.domElement.style.opacity=_?0:1})},p.CLASS_AUTO_PLACE="a",p.CLASS_AUTO_PLACE_CONTAINER="ac",p.CLASS_MAIN="main",p.CLASS_CONTROLLER_ROW="cr",p.CLASS_TOO_TALL="taller-than-window",p.CLASS_CLOSED="closed",p.CLASS_CLOSE_BUTTON="close-button",p.CLASS_DRAG="drag",p.DEFAULT_WIDTH=245,p.TEXT_CLOSED="Close Controls",p.TEXT_OPEN="Open Controls",m.bind(window,"keydown",function(e){"text"!==document.activeElement.type&&(72===e.which||72==e.keyCode)&&p.toggleHide()},!1),f.extend(p.prototype,{add:function(e,t){return j(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return j(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;f.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&g.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};return t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]),t=new p(t),this.__folders[e]=t,e=E(this,t.domElement),m.addClass(e,"folder"),t},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){if(e=this.getRoot(),e.scrollable){var e,t=m.getOffset(e.__ul).top,n=0;f.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=m.getHeight(t))}),window.innerHeight-t-20<n?(m.addClass(e.domElement,p.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(m.removeClass(e.domElement,p.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&f.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(f.isUndefined(y)&&(y=new h,y.domElement.innerHTML=t),this.parent)throw Error("You can only call remember on a top level GUI.");var e=this;f.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&T(e),-1==e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&C(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=w(this)),e.folders={},f.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=w(this),x(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[v]=w(this,!0)),this.load.remembered[e]=w(this),this.preset=e,O(this,e,!0)},revert:function(e){f.each(this.__controllers,function(t){this.getRoot().load.remembered?A(e||this.getRoot(),t):t.setValue(t.initialValue)},this),f.each(this.__folders,function(e){e.revert(e)}),e||x(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&k(this.__listening)}}),p}(dat.utils.css,`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.
      
    </div>
    
  </div>

</div>`,`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`,dat.controllers.factory=function(e,t,n,s,o,i,a){return function(r,c,l,d){var u=r[c];return a.isArray(l)||a.isObject(l)?new e(r,c,l):a.isNumber(u)?a.isNumber(l)&&a.isNumber(d)?new n(r,c,l,d):new t(r,c,{min:l,max:d}):a.isString(u)?new s(r,c):a.isFunction(u)?new o(r,c,""):a.isBoolean(u)?new i(r,c):void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(e,t,n){var s=function(e,n){function i(){o.setValue(o.__input.value)}s.superclass.call(this,e,n);var o=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",i),t.bind(this.__input,"change",i),t.bind(this.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return s.superclass=e,n.extend(s.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),s.superclass.prototype.updateDisplay.call(this)}}),s}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(e,t,n,s,o){function a(e,t,n,s){e.style.background="",o.each(r,function(o){e.style.cssText+="background: "+o+"linear-gradient("+t+", "+n+" 0%, "+s+" 100%); "})}function c(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var r,i=function(e,r){function m(e){u(e),t.bind(window,"mousemove",u),t.bind(window,"mouseup",f)}function f(){t.unbind(window,"mousemove",u),t.unbind(window,"mouseup",f)}function p(){var e=s(this.value);e!==!1?(l.__color.__state=e,l.setValue(l.__color.toOriginal())):this.value=l.__color.toString()}function g(){t.unbind(window,"mousemove",h),t.unbind(window,"mouseup",g)}function u(e){e.preventDefault();var s=t.getWidth(l.__saturation_field),o=t.getOffset(l.__saturation_field),n=(e.clientX-o.left+document.body.scrollLeft)/s,e=1-(e.clientY-o.top+document.body.scrollTop)/s;return e>1?e=1:0>e&&(e=0),n>1?n=1:0>n&&(n=0),l.__color.v=e,l.__color.s=n,l.setValue(l.__color.toOriginal()),!1}function h(e){e.preventDefault();var n=t.getHeight(l.__hue_field),s=t.getOffset(l.__hue_field),e=1-(e.clientY-s.top+document.body.scrollTop)/n;return e>1?e=1:0>e&&(e=0),l.__color.h=360*e,l.setValue(l.__color.toOriginal()),!1}i.superclass.call(this,e,r),this.__color=new n(this.getValue()),this.__temp=new n(0);var d,l=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){13===e.keyCode&&p.call(this)}),t.bind(this.__input,"blur",p),t.bind(this.__selector,"mousedown",function(){t.addClass(this,"drag").bind(window,"mouseup",function(){t.removeClass(l.__selector,"drag")})}),d=document.createElement("div"),o.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),o.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),o.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),o.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),o.extend(d.style,{width:"100%",height:"100%",background:"none"}),a(d,"top","rgba(0,0,0,0)","#000"),o.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),c(this.__hue_field),o.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",m),t.bind(this.__field_knob,"mousedown",m),t.bind(this.__hue_field,"mousedown",function(e){h(e),t.bind(window,"mousemove",h),t.bind(window,"mouseup",g)}),this.__saturation_field.appendChild(d),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};return i.superclass=e,o.extend(i.prototype,e.prototype,{updateDisplay:function(){t=s(this.getValue()),t!==!1&&(i=!1,o.each(n.COMPONENTS,function(e){return o.isUndefined(t[e])||o.isUndefined(this.__color.__state[e])||t[e]===this.__color.__state[e]?void 0:(i=!0,{})},this),i&&o.extend(this.__color.__state,t)),o.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var t,i,e=this.__color.v<.5||this.__color.s>.5?255:0,r=255-e;o.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,a(this.__saturation_field,"left","#fff",this.__temp.toString()),o.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}),r=["-moz-","-o-","-webkit-","-ms-",""],i}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(e,t,n,s){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(r(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(r(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function a(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(c(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(c(this),this.__state.space="HSV"),this.__state[t]=e}})}function r(e,n,o){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,o);else{if("HSV"!==e.__state.space)throw"Corrupted color state";s.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function c(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);s.extend(e.__state,{s:n.s,v:n.v}),s.isNaN(n.h)?s.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var o=function(){if(this.__state=e.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return o.COMPONENTS="r,g,b,h,s,v,hex,a".split(","),s.extend(o.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(o.prototype,"r",2),i(o.prototype,"g",1),i(o.prototype,"b",0),a(o.prototype,"h"),a(o.prototype,"s"),a(o.prototype,"v"),Object.defineProperty(o.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(o.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),o}(dat.color.interpret,dat.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var i=e/60-Math.floor(e/60),s=n*(1-t),o=n*(1-i*t),t=n*(1-(1-i)*t),e=[[n,t,s],[o,n,s],[s,n,t],[s,o,n],[t,s,n],[n,s,o]][Math.floor(e/60)%6];return{r:255*e[0],g:255*e[1],b:255*e[2]}},rgb_to_hsv:function(e,t,n){var s=Math.min(e,t,n),o=Math.max(e,t,n),s=o-s;return 0==o?{h:NaN,s:0,v:0}:(e=e==o?(t-n)/s:t==o?2+(n-e)/s:4+(e-t)/s,e/=6,0>e&&(e+=1),{h:360*e,s:s/o,v:o/255})},rgb_to_hex:function(e,t,n){return e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t),e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,s){return s<<(e=8*n)|t&~(255<<e)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),dat.dom.CenteredDiv=function(e,t){var n=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;e.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var n=this,t=function(){n.domElement.style.display="none",n.backgroundElement.style.display="none",e.unbind(n.domElement,"webkitTransitionEnd",t),e.unbind(n.domElement,"transitionend",t),e.unbind(n.domElement,"oTransitionEnd",t)};e.bind(this.domElement,"webkitTransitionEnd",t),e.bind(this.domElement,"transitionend",t),e.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},n}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);var Detector,dat,Stats=function(){var e,t,n,s,o,i,a,v,d=Date.now(),g=d,c=0,p=1/0,u=0,l=0,f=1/0,m=0,h=0,b=0,r=document.createElement("div");r.id="stats",r.addEventListener("mousedown",function(e){e.preventDefault(),v(++b%2)},!1),r.style.cssText="width:80px;opacity:0.9;cursor:pointer",e=document.createElement("div"),e.id="fps",e.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",r.appendChild(e),a=document.createElement("div"),a.id="fpsText",a.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",a.innerHTML="FPS",e.appendChild(a),s=document.createElement("div");for(s.id="fpsGraph",s.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",e.appendChild(s);74>s.children.length;)i=document.createElement("span"),i.style.cssText="width:1px;height:30px;float:left;background-color:#113",s.appendChild(i);n=document.createElement("div"),n.id="ms",n.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",r.appendChild(n),o=document.createElement("div"),o.id="msText",o.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",o.innerHTML="MS",n.appendChild(o),t=document.createElement("div");for(t.id="msGraph",t.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",n.appendChild(t);74>t.children.length;)i=document.createElement("span"),i.style.cssText="width:1px;height:30px;float:left;background-color:#131",t.appendChild(i);return v=function(t){switch(b=t){case 0:e.style.display="block",n.style.display="none";break;case 1:e.style.display="none",n.style.display="block"}},{REVISION:11,domElement:r,setMode:v,begin:function(){d=Date.now()},end:function(){var n,e=Date.now();return c=e-d,p=Math.min(p,c),u=Math.max(u,c),o.textContent=c+" MS ("+p+"-"+u+")",n=Math.min(30,30-30*(c/200)),t.appendChild(t.firstChild).style.height=n+"px",h++,e>g+1e3&&(l=Math.round(1e3*h/(e-g)),f=Math.min(f,l),m=Math.max(m,l),a.textContent=l+" FPS ("+f+"-"+m+")",n=Math.min(30,30-30*(l/100)),s.appendChild(s.firstChild).style.height=n+"px",g=e,h=0),e},update:function(){d=this.end()}}},THREE={REVISION:"71"},loadingManager,shaderLoader,SHADER_CONTAINER,OBJ_MODELS,OBJloader,TEXTURES,textureLoader,container,stats,scene,light,camera,cameraCtrl,renderer,WIDTH,HEIGHT,pixelRatio,screenRatio,clock,FRAME_COUNT,sceneSettings,canvas,gridHelper,axisHelper,gui,gui_info,gui_settings;"object"==typeof module&&(module.exports=THREE),void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:e>0?1:+e}),THREE.log=function(){console.log.apply(console,arguments)},THREE.warn=function(){console.warn.apply(console,arguments)},THREE.error=function(){console.error.apply(console,arguments)},THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.MinEquation=103,THREE.MaxEquation=104,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=300,THREE.CubeReflectionMapping=301,THREE.CubeRefractionMapping=302,THREE.EquirectangularReflectionMapping=303,THREE.EquirectangularRefractionMapping=304,THREE.SphericalReflectionMapping=305,THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.HalfFloatType=1025,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGBEFormat=THREE.RGBAFormat,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.RGB_PVRTC_4BPPV1_Format=2100,THREE.RGB_PVRTC_2BPPV1_Format=2101,THREE.RGBA_PVRTC_4BPPV1_Format=2102,THREE.RGBA_PVRTC_2BPPV1_Format=2103,THREE.Projector=function(){THREE.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){THREE.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){THREE.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){THREE.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},THREE.CanvasRenderer=function(){THREE.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},THREE.Color=function(e){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(e)},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){return e instanceof THREE.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(0===t)this.r=this.g=this.b=n;else{var o=function(e,t,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?e+6*(t-e)*n:.5>n?t:2/3>n?e+6*(t-e)*(2/3-n):e},s=.5>=n?n*(1+t):n+t-n*t,i=2*n-s;this.r=o(i,s,e+1/3),this.g=o(i,s,e),this.b=o(i,s,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this}return/^rgb\((\d+)%, ?(\d+)%, ?(\d+)%\)$/i.test(e)?(t=/^rgb\((\d+)%, ?(\d+)%, ?(\d+)%\)$/i.exec(e),this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this):/^#([0-9a-f]{6})$/i.test(e)?(t=/^#([0-9a-f]{6})$/i.exec(e),this.setHex(parseInt(t[1],16)),this):/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)?(t=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e),this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this):/^(\w+)$/i.test(e)?(this.setHex(THREE.ColorKeywords[e]),this):void 0},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,i,l,c=e||{h:0,s:0,l:0},a=this.r,n=this.g,s=this.b,o=Math.max(a,n,s),r=Math.min(a,n,s),d=(r+o)/2;if(r===o)t=0,l=0;else{switch(i=o-r,l=.5>=d?i/(o+r):i/(2-o-r),o){case a:t=(n-s)/i+(s>n?6:0);break;case n:t=(s-a)/i+2;break;case s:t=(a-n)/i+4}t/=6}return c.h=t,c.s=l,c.l=d,c},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){var s=this.getHSL();return s.h+=e,s.s+=t,s.l+=n,this.setHSL(s.h,s.s,s.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(e,t,n,s){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==s?s:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this.onChangeCallback(),this},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(e instanceof THREE.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(e._x/2),s=Math.cos(e._y/2),o=Math.cos(e._z/2),i=Math.sin(e._x/2),a=Math.sin(e._y/2),r=Math.sin(e._z/2);return"XYZ"===e.order?(this._x=i*s*o+n*a*r,this._y=n*a*o-i*s*r,this._z=n*s*r+i*a*o,this._w=n*s*o-i*a*r):"YXZ"===e.order?(this._x=i*s*o+n*a*r,this._y=n*a*o-i*s*r,this._z=n*s*r-i*a*o,this._w=n*s*o+i*a*r):"ZXY"===e.order?(this._x=i*s*o-n*a*r,this._y=n*a*o+i*s*r,this._z=n*s*r+i*a*o,this._w=n*s*o-i*a*r):"ZYX"===e.order?(this._x=i*s*o-n*a*r,this._y=n*a*o+i*s*r,this._z=n*s*r-i*a*o,this._w=n*s*o+i*a*r):"YZX"===e.order?(this._x=i*s*o+n*a*r,this._y=n*a*o+i*s*r,this._z=n*s*r-i*a*o,this._w=n*s*o-i*a*r):"XZY"===e.order&&(this._x=i*s*o-n*a*r,this._y=n*a*o-i*s*r,this._z=n*s*r+i*a*o,this._w=n*s*o+i*a*r),t!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var s=t/2,n=Math.sin(s);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(s),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,s=n[0],a=n[4],r=n[8],c=n[1],o=n[5],l=n[9],d=n[2],u=n[6],i=n[10],h=s+o+i;return h>0?(t=.5/Math.sqrt(h+1),this._w=.25/t,this._x=(u-l)*t,this._y=(r-d)*t,this._z=(c-a)*t):s>o&&s>i?(t=2*Math.sqrt(1+s-o-i),this._w=(u-l)/t,this._x=.25*t,this._y=(a+c)/t,this._z=(r+d)/t):o>i?(t=2*Math.sqrt(1+o-s-i),this._w=(r-d)/t,this._x=(a+c)/t,this._y=.25*t,this._z=(l+u)/t):(t=2*Math.sqrt(1+i-s-o),this._w=(c-a)/t,this._x=(r+d)/t,this._y=(l+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t,n=1e-6;return function(s,o){return void 0===e&&(e=new THREE.Vector3),t=s.dot(o)+1,n>t?(t=0,Math.abs(s.x)>Math.abs(s.z)?e.set(-s.y,s.x,0):e.set(0,-s.z,s.y)):e.crossVectors(s,o),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(THREE.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e._x,s=e._y,o=e._z,i=e._w,a=t._x,r=t._y,c=t._z,l=t._w;return this._x=n*l+i*a+s*c-o*r,this._y=s*l+i*r+o*a-n*c,this._z=o*l+i*c+n*r-s*a,this._w=i*l-n*a-s*r-o*c,this.onChangeCallback(),this},multiplyVector3:function(e){return THREE.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var s,o,l,d,i=this._x,a=this._y,r=this._z,c=this._w,n=c*e._w+i*e._x+a*e._y+r*e._z;return 0>n?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,n=-n):this.copy(e),n>=1?(this._w=c,this._x=i,this._y=a,this._z=r,this):(d=Math.acos(n),l=Math.sqrt(1-n*n),Math.abs(l)<.001?(this._w=.5*(c+this._w),this._x=.5*(i+this._x),this._y=.5*(a+this._y),this._z=.5*(r+this._z),this):(s=Math.sin((1-t)*d)/l,o=Math.sin(t*d)/l,this._w=c*s+this._w*o,this._x=i*s+this._x*o,this._y=a*s+this._y*o,this._z=r*s+this._z*o,this.onChangeCallback(),this))},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(e,t,n,s){return n.copy(e).slerp(t,s)},THREE.Vector2=function(e,t){this.x=e||0,this.y=t||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},sub:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(){var e,t;return function(n,s){return void 0===e&&(e=new THREE.Vector2,t=new THREE.Vector2),e.set(n,n),t.set(s,s),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e;return function(t){return t instanceof THREE.Euler==!1&&THREE.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===e&&(e=new THREE.Quaternion),this.applyQuaternion(e.setFromEuler(t)),this}}(),applyAxisAngle:function(){var e;return function(t,n){return void 0===e&&(e=new THREE.Quaternion),this.applyQuaternion(e.setFromAxisAngle(t,n)),this}}(),applyMatrix3:function(e){var n=this.x,s=this.y,o=this.z,t=e.elements;return this.x=t[0]*n+t[3]*s+t[6]*o,this.y=t[1]*n+t[4]*s+t[7]*o,this.z=t[2]*n+t[5]*s+t[8]*o,this},applyMatrix4:function(e){var n=this.x,s=this.y,o=this.z,t=e.elements;return this.x=t[0]*n+t[4]*s+t[8]*o+t[12],this.y=t[1]*n+t[5]*s+t[9]*o+t[13],this.z=t[2]*n+t[6]*s+t[10]*o+t[14],this},applyProjection:function(e){var n=this.x,s=this.y,o=this.z,t=e.elements,i=1/(t[3]*n+t[7]*s+t[11]*o+t[15]);return this.x=(t[0]*n+t[4]*s+t[8]*o+t[12])*i,this.y=(t[1]*n+t[5]*s+t[9]*o+t[13])*i,this.z=(t[2]*n+t[6]*s+t[10]*o+t[14])*i,this},applyQuaternion:function(e){var i=this.x,a=this.y,r=this.z,t=e.x,n=e.y,s=e.z,o=e.w,c=o*i+n*r-s*a,l=o*a+s*i-t*r,d=o*r+t*a-n*i,u=-t*i-n*a-s*r;return this.x=c*o+u*-t+l*-s-d*-n,this.y=l*o+u*-n+d*-t-c*-s,this.z=d*o+u*-s+c*-n-l*-t,this},project:function(){var e;return function(t){return void 0===e&&(e=new THREE.Matrix4),e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyProjection(e)}}(),unproject:function(){var e;return function(t){return void 0===e&&(e=new THREE.Matrix4),e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var n=this.x,s=this.y,o=this.z,t=e.elements;return this.x=t[0]*n+t[4]*s+t[8]*o,this.y=t[1]*n+t[5]*s+t[9]*o,this.z=t[2]*n+t[6]*s+t[10]*o,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,t;return function(n,s){return void 0===e&&(e=new THREE.Vector3,t=new THREE.Vector3),e.set(n,n,n),t.set(s,s,s),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},cross:function(e,t){if(void 0!==t)return THREE.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,s=this.y,o=this.z;return this.x=s*e.z-o*e.y,this.y=o*e.x-n*e.z,this.z=n*e.y-s*e.x,this},crossVectors:function(e,t){var n=e.x,s=e.y,o=e.z,i=t.x,a=t.y,r=t.z;return this.x=s*r-o*a,this.y=o*i-n*r,this.z=n*a-s*i,this},projectOnVector:function(){var e,t;return function(n){return void 0===e&&(e=new THREE.Vector3),e.copy(n).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new THREE.Vector3),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new THREE.Vector3),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(THREE.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s},setEulerFromRotationMatrix:function(){THREE.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){THREE.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return THREE.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return THREE.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return THREE.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),s=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=s,this},setFromMatrixColumn:function(e,t){var n=4*e,s=t.elements;return this.x=s[n],this.y=s[n+1],this.z=s[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.Vector4=function(e,t,n,s){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==s?s:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(THREE.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var n=this.x,s=this.y,o=this.z,i=this.w,t=e.elements;return this.x=t[0]*n+t[4]*s+t[8]*o+t[12]*i,this.y=t[1]*n+t[5]*s+t[9]*o+t[13]*i,this.z=t[2]*n+t[6]*s+t[10]*o+t[14]*i,this.w=t[3]*n+t[7]*s+t[11]*o+t[15]*i,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,s,r,O,a=.01,m=.1,o=e.elements,b=o[0],l=o[4],d=o[8],u=o[1],v=o[5],i=o[9],h=o[2],c=o[6],j=o[10];if(Math.abs(l-u)<a&&Math.abs(d-h)<a&&Math.abs(i-c)<a){if(Math.abs(l+u)<m&&Math.abs(d+h)<m&&Math.abs(i+c)<m&&Math.abs(b+v+j-3)<m)return this.set(1,0,0,0),this;O=Math.PI;var f=(b+1)/2,p=(v+1)/2,g=(j+1)/2,y=(l+u)/4,_=(d+h)/4,w=(i+c)/4;return f>p&&f>g?a>f?(t=0,n=.707106781,s=.707106781):(t=Math.sqrt(f),n=y/t,s=_/t):p>g?a>p?(t=.707106781,n=0,s=.707106781):(n=Math.sqrt(p),t=y/n,s=w/n):a>g?(t=.707106781,n=.707106781,s=0):(s=Math.sqrt(g),t=_/s,n=w/s),this.set(t,n,s,O),this}return r=Math.sqrt((c-i)*(c-i)+(d-h)*(d-h)+(u-l)*(u-l)),Math.abs(r)<.001&&(r=1),this.x=(c-i)/r,this.y=(d-h)/r,this.z=(u-l)/r,this.w=Math.acos((b+v+j-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},clampScalar:function(){var e,t;return function(n,s){return void 0===e&&(e=new THREE.Vector4,t=new THREE.Vector4),e.set(n,n,n,n),t.set(s,s,s,s),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this.w=e.array[t+3],this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(e,t,n,s){this._x=e||0,this._y=t||0,this._z=n||0,this._order=s||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._order=s||this._order,this.onChangeCallback(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var o=THREE.Math.clamp,s=e.elements,i=s[0],c=s[4],l=s[8],d=s[1],a=s[5],u=s[9],h=s[2],m=s[6],r=s[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(o(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,r),this._z=Math.atan2(-c,i)):(this._x=Math.atan2(m,a),this._z=0)):"YXZ"===t?(this._x=Math.asin(-o(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(l,r),this._z=Math.atan2(d,a)):(this._y=Math.atan2(-h,i),this._z=0)):"ZXY"===t?(this._x=Math.asin(o(m,-1,1)),Math.abs(m)<.99999?(this._y=Math.atan2(-h,r),this._z=Math.atan2(-c,a)):(this._y=0,this._z=Math.atan2(d,i))):"ZYX"===t?(this._y=Math.asin(-o(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(m,r),this._z=Math.atan2(d,i)):(this._x=0,this._z=Math.atan2(-c,a))):"YZX"===t?(this._z=Math.asin(o(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(-u,a),this._y=Math.atan2(-h,i)):(this._x=0,this._y=Math.atan2(l,r))):"XZY"===t?(this._z=Math.asin(-o(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(m,a),this._y=Math.atan2(l,i)):(this._x=Math.atan2(-u,r),this._y=0)):THREE.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var e;return function(t,n,s){return void 0===e&&(e=new THREE.Matrix4),e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,s),this}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new THREE.Quaternion;return function(t){e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3,this.end=void 0!==t?t:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var n=t||new THREE.Vector3;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(n,s){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),a=e.dot(t),o=a/i;return s&&(o=THREE.Math.clamp(o,0,1)),o}}(),closestPointToPoint:function(e,t,n){var s=this.closestPointToPointParameter(e,t),o=n||new THREE.Vector3;return this.delta(o).multiplyScalar(s).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(1/0,1/0),this.max=void 0!==t?t:new THREE.Vector2(-(1/0),-(1/0))},THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;n>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,n){var s=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(s),this.max.copy(t).add(s),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new THREE.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){var n=t||new THREE.Vector2;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){var n=t||new THREE.Vector2;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){var n=e.copy(t).clamp(this.min,this.max);return n.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new THREE.Vector3(-(1/0),-(1/0),-(1/0))},THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;n>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,n){var s=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(s),this.max.copy(t).add(s),this}}(),setFromObject:function(){var e=new THREE.Vector3;return function(t){var n=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse(function(t){if(o=t.geometry,void 0!==o)if(o instanceof THREE.Geometry)for(var o,r=o.vertices,s=0,a=r.length;a>s;s++)e.copy(r[s]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e);else if(o instanceof THREE.BufferGeometry&&void 0!==o.attributes.position)for(var i=o.attributes.position.array,s=0,a=i.length;a>s;s+=3)e.set(i[s],i[s+1],i[s+2]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e)}),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){var n=t||new THREE.Vector3;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},clampPoint:function(e,t){var n=t||new THREE.Vector3;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var n=e.copy(t).clamp(this.min,this.max);return n.sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){var n=t||new THREE.Sphere;return n.center=this.center(),n.radius=.5*this.size(e).length(),n}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&THREE.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,n,s,o,i,a,r,c){var l=this.elements;return l[0]=e,l[3]=t,l[6]=n,l[1]=s,l[4]=o,l[7]=i,l[2]=a,l[5]=r,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return THREE.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return THREE.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new THREE.Vector3;return function(t,n,s){void 0===n&&(n=0),void 0===s&&(s=t.length);for(var i=0,o=n;s>i;i+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix3(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],s=e[2],o=e[3],i=e[4],a=e[5],r=e[6],c=e[7],l=e[8];return t*i*l-t*a*c-n*o*l+n*a*r+s*o*c-s*i*r},getInverse:function(e,t){var o,i,n=e.elements,s=this.elements;if(s[0]=n[10]*n[5]-n[6]*n[9],s[1]=-n[10]*n[1]+n[2]*n[9],s[2]=n[6]*n[1]-n[2]*n[5],s[3]=-n[10]*n[4]+n[6]*n[8],s[4]=n[10]*n[0]-n[2]*n[8],s[5]=-n[6]*n[0]+n[2]*n[4],s[6]=n[9]*n[4]-n[5]*n[8],s[7]=-n[9]*n[0]+n[1]*n[8],s[8]=n[5]*n[0]-n[1]*n[4],o=n[0]*s[0]+n[1]*s[3]+n[2]*s[6],0===o){if(i="Matrix3.getInverse(): can't invert matrix, determinant is 0",t)throw new Error(i);return THREE.warn(i),this.identity(),this}return this.multiplyScalar(1/o),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){return(new THREE.Matrix3).fromArray(this.elements)}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&THREE.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=s,g[1]=o,g[5]=i,g[9]=a,g[13]=r,g[2]=c,g[6]=l,g[10]=d,g[14]=u,g[3]=h,g[7]=m,g[11]=f,g[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return THREE.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){var s=this.elements;return e.set(s[0],s[1],s[2]),t.set(s[4],s[5],s[6]),n.set(s[8],s[9],s[10]),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var s=this.elements,n=t.elements,o=1/e.set(n[0],n[1],n[2]).length(),i=1/e.set(n[4],n[5],n[6]).length(),a=1/e.set(n[8],n[9],n[10]).length();return s[0]=n[0]*o,s[1]=n[1]*o,s[2]=n[2]*o,s[4]=n[4]*i,s[5]=n[5]*i,s[6]=n[6]*i,s[8]=n[8]*a,s[9]=n[9]*a,s[10]=n[10]*a,this}}(),makeRotationFromEuler:function(e){e instanceof THREE.Euler==!1&&THREE.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,_=e.x,w=e.y,y=e.z,a=Math.cos(_),o=Math.sin(_),r=Math.cos(w),n=Math.sin(w),i=Math.cos(y),s=Math.sin(y);if("XYZ"===e.order){var c=a*i,h=a*s,m=o*i,f=o*s;t[0]=r*i,t[4]=-r*s,t[8]=n,t[1]=h+m*n,t[5]=c-f*n,t[9]=-o*r,t[2]=f-c*n,t[6]=m+h*n,t[10]=a*r}else if("YXZ"===e.order){var l=r*i,g=r*s,v=n*i,b=n*s;t[0]=l+b*o,t[4]=v*o-g,t[8]=a*n,t[1]=a*s,t[5]=a*i,t[9]=-o,t[2]=g*o-v,t[6]=b+l*o,t[10]=a*r}else if("ZXY"===e.order){var l=r*i,g=r*s,v=n*i,b=n*s;t[0]=l-b*o,t[4]=-a*s,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*i,t[9]=b-l*o,t[2]=-a*n,t[6]=o,t[10]=a*r}else if("ZYX"===e.order){var c=a*i,h=a*s,m=o*i,f=o*s;t[0]=r*i,t[4]=m*n-h,t[8]=c*n+f,t[1]=r*s,t[5]=f*n+c,t[9]=h*n-m,t[2]=-n,t[6]=o*r,t[10]=a*r}else if("YZX"===e.order){var j=a*r,p=a*n,u=o*r,d=o*n;t[0]=r*i,t[4]=d-j*s,t[8]=u*s+p,t[1]=s,t[5]=a*i,t[9]=-o*i,t[2]=-n*i,t[6]=p*s+u,t[10]=j-d*s}else if("XZY"===e.order){var j=a*r,p=a*n,u=o*r,d=o*n;t[0]=r*i,t[4]=-s,t[8]=n*i,t[1]=j*s+d,t[5]=a*i,t[9]=p*s-u,t[2]=u*s-p,t[6]=o*i,t[10]=d*s+j}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return THREE.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,o=e.y,i=e.z,a=e.w,l=n+n,r=o+o,s=i+i,c=n*l,d=n*r,u=n*s,h=o*r,m=o*s,f=i*s,p=a*l,g=a*r,v=a*s;return t[0]=1-(h+f),t[4]=d-v,t[8]=u+g,t[1]=d+v,t[5]=1-(c+f),t[9]=m-p,t[2]=u-g,t[6]=m+p,t[10]=1-(c+h),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var t=new THREE.Vector3,n=new THREE.Vector3,e=new THREE.Vector3;return function(s,o,i){var a=this.elements;return e.subVectors(s,o).normalize(),0===e.length()&&(e.z=1),t.crossVectors(i,e).normalize(),0===t.length()&&(e.x+=1e-4,t.crossVectors(i,e).normalize()),n.crossVectors(e,t),a[0]=t.x,a[4]=n.x,a[8]=e.x,a[1]=t.y,a[5]=n.y,a[9]=e.y,a[2]=t.z,a[6]=n.z,a[10]=e.z,this}}(),multiply:function(e,t){return void 0!==t?(THREE.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,s=t.elements,o=this.elements,i=n[0],a=n[4],r=n[8],c=n[12],l=n[1],d=n[5],u=n[9],h=n[13],m=n[2],f=n[6],p=n[10],g=n[14],v=n[3],b=n[7],j=n[11],y=n[15],_=s[0],w=s[4],O=s[8],x=s[12],C=s[1],E=s[5],k=s[9],A=s[13],S=s[2],M=s[6],F=s[10],T=s[14],z=s[3],D=s[7],N=s[11],L=s[15];return o[0]=i*_+a*C+r*S+c*z,o[4]=i*w+a*E+r*M+c*D,o[8]=i*O+a*k+r*F+c*N,o[12]=i*x+a*A+r*T+c*L,o[1]=l*_+d*C+u*S+h*z,o[5]=l*w+d*E+u*M+h*D,o[9]=l*O+d*k+u*F+h*N,o[13]=l*x+d*A+u*T+h*L,o[2]=m*_+f*C+p*S+g*z,o[6]=m*w+f*E+p*M+g*D,o[10]=m*O+f*k+p*F+g*N,o[14]=m*x+f*A+p*T+g*L,o[3]=v*_+b*C+j*S+y*z,o[7]=v*w+b*E+j*M+y*D,o[11]=v*O+b*k+j*F+y*N,o[15]=v*x+b*A+j*T+y*L,this},multiplyToArray:function(e,t,n){var s=this.elements;return this.multiplyMatrices(e,t),n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return THREE.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return THREE.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return THREE.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new THREE.Vector3;return function(t,n,s){void 0===n&&(n=0),void 0===s&&(s=t.length);for(var i=0,o=n;s>i;i+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),rotateAxis:function(e){THREE.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return THREE.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],n=e[4],s=e[8],o=e[12],i=e[1],a=e[5],r=e[9],c=e[13],l=e[2],d=e[6],u=e[10],h=e[14],m=e[3],f=e[7],p=e[11],g=e[15];return m*(+o*r*d-s*c*d-o*a*u+n*c*u+s*a*h-n*r*h)+f*(+t*r*h-t*c*u+o*i*u-s*i*h+s*c*l-o*r*l)+p*(+t*c*d-t*a*h-o*i*d+n*i*h+o*a*l-n*c*l)+g*(-s*a*l-t*r*d+t*a*u+s*i*d-n*i*u+n*r*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},getPosition:function(){var e=new THREE.Vector3;return function(){THREE.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var y,_,n=this.elements,j=e.elements,o=j[0],h=j[4],f=j[8],r=j[12],a=j[1],l=j[5],d=j[9],u=j[13],i=j[2],m=j[6],c=j[10],p=j[14],s=j[3],v=j[7],b=j[11],g=j[15];if(n[0]=d*p*v-u*c*v+u*m*b-l*p*b-d*m*g+l*c*g,n[4]=r*c*v-f*p*v-r*m*b+h*p*b+f*m*g-h*c*g,n[8]=f*u*v-r*d*v+r*l*b-h*u*b-f*l*g+h*d*g,n[12]=r*d*m-f*u*m-r*l*c+h*u*c+f*l*p-h*d*p,n[1]=u*c*s-d*p*s-u*i*b+a*p*b+d*i*g-a*c*g,n[5]=f*p*s-r*c*s+r*i*b-o*p*b-f*i*g+o*c*g,n[9]=r*d*s-f*u*s-r*a*b+o*u*b+f*a*g-o*d*g,n[13]=f*u*i-r*d*i+r*a*c-o*u*c-f*a*p+o*d*p,n[2]=l*p*s-u*m*s+u*i*v-a*p*v-l*i*g+a*m*g,n[6]=r*m*s-h*p*s-r*i*v+o*p*v+h*i*g-o*m*g,n[10]=h*u*s-r*l*s+r*a*v-o*u*v-h*a*g+o*l*g,n[14]=r*l*i-h*u*i-r*a*m+o*u*m+h*a*p-o*l*p,n[3]=d*m*s-l*c*s-d*i*v+a*c*v+l*i*b-a*m*b,n[7]=h*c*s-f*m*s+f*i*v-o*c*v-h*i*b+o*m*b,n[11]=f*l*s-h*d*s-f*a*v+o*d*v+h*a*b-o*l*b,n[15]=h*d*i-f*l*i+f*a*m-o*d*m-h*a*c+o*l*c,y=o*n[0]+a*n[4]+i*n[8]+s*n[12],0==y){if(_="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0",t)throw new Error(_);return THREE.warn(_),this.identity(),this}return this.multiplyScalar(1/y),this},translate:function(){THREE.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){THREE.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){THREE.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){THREE.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){THREE.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,n=e.x,s=e.y,o=e.z;return t[0]*=n,t[4]*=s,t[8]*=o,t[1]*=n,t[5]*=s,t[9]*=o,t[2]*=n,t[6]*=s,t[10]*=o,t[3]*=n,t[7]*=s,t[11]*=o,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(n,s)))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var a=Math.cos(t),s=Math.sin(t),c=1-a,r=e.x,o=e.y,n=e.z,i=c*r,l=c*o;return this.set(i*r+a,i*o-s*n,i*n+s*o,0,i*o+s*n,l*o+a,l*n-s*r,0,i*n-s*o,l*n+s*r,c*n*n+a,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var t=new THREE.Vector3,e=new THREE.Matrix4;return function(n,s,o){var i=this.elements,a=t.set(i[0],i[1],i[2]).length(),d=t.set(i[4],i[5],i[6]).length(),u=t.set(i[8],i[9],i[10]).length(),h=this.determinant();0>h&&(a=-a),n.x=i[12],n.y=i[13],n.z=i[14],e.elements.set(this.elements);var r=1/a,c=1/d,l=1/u;return e.elements[0]*=r,e.elements[1]*=r,e.elements[2]*=r,e.elements[4]*=c,e.elements[5]*=c,e.elements[6]*=c,e.elements[8]*=l,e.elements[9]*=l,e.elements[10]*=l,s.setFromRotationMatrix(e),o.x=a,o.y=d,o.z=u,this}}(),makeFrustum:function(e,t,n,s,o,i){var a=this.elements,r=2*o/(t-e),c=2*o/(s-n),l=(t+e)/(t-e),d=(s+n)/(s-n),u=-(i+o)/(i-o),h=-2*i*o/(i-o);return a[0]=r,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,n,s){var o=n*Math.tan(THREE.Math.degToRad(.5*e)),i=-o,a=i*t,r=o*t;return this.makeFrustum(a,r,i,o,n,s)},makeOrthographic:function(e,t,n,s,o,i){var a=this.elements,r=t-e,c=n-s,l=i-o,d=(t+e)/r,u=(n+s)/c,h=(i+o)/l;return a[0]=2/r,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2/c,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/l,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)}},THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3,this.direction=void 0!==t?t:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var n=t||new THREE.Vector3;return n.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new THREE.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var s,n=t||new THREE.Vector3;return n.subVectors(e,this.origin),s=n.dot(this.direction),0>s?n.copy(this.origin):n.copy(this.direction).multiplyScalar(s).add(this.origin)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return 0>n?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:function(){var n=new THREE.Vector3,e=new THREE.Vector3,t=new THREE.Vector3;return function(s,o,i,a){n.copy(s).add(o).multiplyScalar(.5),e.copy(o).sub(s).normalize(),t.copy(this.origin).sub(n);var r,c,h,p,v,l=.5*s.distanceTo(o),d=-this.direction.dot(e),m=t.dot(this.direction),u=-t.dot(e),f=t.lengthSq(),g=Math.abs(1-d*d);return g>0?(c=d*u-m,r=d*m-u,p=l*g,c>=0?r>=-p?p>=r?(v=1/g,c*=v,r*=v,h=c*(c+d*r+2*m)+r*(d*c+r+2*u)+f):(r=l,c=Math.max(0,-(d*r+m)),h=-c*c+r*(r+2*u)+f):(r=-l,c=Math.max(0,-(d*r+m)),h=-c*c+r*(r+2*u)+f):-p>=r?(c=Math.max(0,-(-d*l+m)),r=c>0?-l:Math.min(Math.max(-l,-u),l),h=-c*c+r*(r+2*u)+f):p>=r?(c=0,r=Math.min(Math.max(-l,-u),l),h=r*(r+2*u)+f):(c=Math.max(0,-(d*l+m)),r=c>0?l:Math.min(Math.max(-l,-u),l),h=-c*c+r*(r+2*u)+f)):(r=d>0?-l:l,c=Math.max(0,-(d*r+m)),h=-c*c+r*(r+2*u)+f),i&&i.copy(this.direction).multiplyScalar(c).add(this.origin),a&&a.copy(e).multiplyScalar(r).add(n),h}}(),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new THREE.Vector3;return function(t,n){e.subVectors(t.center,this.origin);var s=e.dot(this.direction),i=e.dot(e)-s*s,a=t.radius*t.radius;if(i>a)return null;var r=Math.sqrt(a-i),o=s-r,c=s+r;return 0>o&&0>c?null:0>o?this.at(c,n):this.at(o,n)}}(),isIntersectionPlane:function(e){var n,t=e.distanceToPoint(this.origin);return 0===t||(n=e.normal.dot(this.direction),0>n*t)},distanceToPlane:function(e){var t,n=e.normal.dot(this.direction);return 0==n?0==e.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(e.normal)+e.constant)/n,t>=0?t:null)},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},isIntersectionBox:function(){var e=new THREE.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectBox:function(e,t){var n,s,i,a,r,c,l=1/this.direction.x,d=1/this.direction.y,u=1/this.direction.z,o=this.origin;return l>=0?(n=(e.min.x-o.x)*l,s=(e.max.x-o.x)*l):(n=(e.max.x-o.x)*l,s=(e.min.x-o.x)*l),d>=0?(i=(e.min.y-o.y)*d,a=(e.max.y-o.y)*d):(i=(e.max.y-o.y)*d,a=(e.min.y-o.y)*d),n>a||i>s?null:((i>n||n!==n)&&(n=i),(s>a||s!==s)&&(s=a),u>=0?(r=(e.min.z-o.z)*u,c=(e.max.z-o.z)*u):(r=(e.max.z-o.z)*u,c=(e.min.z-o.z)*u),n>c||r>s?null:((r>n||n!==n)&&(n=r),(s>c||s!==s)&&(s=c),0>s?null:this.at(n>=0?n:s,t)))},intersectTriangle:function(){var e=new THREE.Vector3,n=new THREE.Vector3,t=new THREE.Vector3,s=new THREE.Vector3;return function(o,i,a,r,c){n.subVectors(i,o),t.subVectors(a,o),s.crossVectors(n,t);var d,u,h,m,l=this.direction.dot(s);if(l>0){if(r)return null;d=1}else{if(!(0>l))return null;d=-1,l=-l}return e.subVectors(this.origin,o),u=d*this.direction.dot(t.crossVectors(e,t)),0>u?null:(h=d*this.direction.dot(n.cross(e)),0>h?null:u+h>l?null:(m=-d*e.dot(s),0>m?null:this.at(m/l,c)))}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3,this.radius=void 0!==t?t:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new THREE.Box3;return function(t,n){s=this.center,void 0!==n?s.copy(n):e.setFromPoints(t).center(s);for(var s,o=0,i=0,a=t.length;a>i;i++)o=Math.max(o,s.distanceToSquared(t[i]));return this.radius=Math.sqrt(o),this}}(),copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var s=this.center.distanceToSquared(e),n=t||new THREE.Vector3;return n.copy(e),s>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new THREE.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(e,t,n,s,o,i){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==s?s:new THREE.Plane,void 0!==o?o:new THREE.Plane,void 0!==i?i:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,n,s,o,i){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(s),a[4].copy(o),a[5].copy(i),this},copy:function(e){for(var n=this.planes,t=0;6>t;t++)n[t].copy(e.planes[t]);return this},setFromMatrix:function(e){var n=this.planes,t=e.elements,b=t[0],f=t[1],d=t[2],a=t[3],l=t[4],c=t[5],r=t[6],i=t[7],u=t[8],h=t[9],m=t[10],o=t[11],p=t[12],g=t[13],v=t[14],s=t[15];return n[0].setComponents(a-b,i-l,o-u,s-p).normalize(),n[1].setComponents(a+b,i+l,o+u,s+p).normalize(),n[2].setComponents(a+f,i+c,o+h,s+g).normalize(),n[3].setComponents(a-f,i-c,o-h,s-g).normalize(),n[4].setComponents(a-d,i-r,o-m,s-v).normalize(),n[5].setComponents(a+d,i+r,o+m,s+v).normalize(),this},intersectsObject:function(){var e=new THREE.Sphere;return function(t){var n=t.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),e.copy(n.boundingSphere),e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var n,s=this.planes,o=e.center,i=-e.radius,t=0;6>t;t++)if(n=s[t].distanceToPoint(o),i>n)return!1;return!0},intersectsBox:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n){for(var s,i,a,r=this.planes,o=0;6>o;o++)if(s=r[o],e.x=s.normal.x>0?n.min.x:n.max.x,t.x=s.normal.x>0?n.max.x:n.min.x,e.y=s.normal.y>0?n.min.y:n.max.y,t.y=s.normal.y>0?n.max.y:n.min.y,e.z=s.normal.z>0?n.min.z:n.max.z,t.z=s.normal.z>0?n.max.z:n.min.z,i=s.distanceToPoint(e),a=s.distanceToPoint(t),0>i&&0>a)return!1;return!0}}(),containsPoint:function(e){for(var n=this.planes,t=0;6>t;t++)if(n[t].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0),this.constant=void 0!==t?t:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,s,o){var i=e.subVectors(o,s).cross(t.subVectors(n,s)).normalize();return this.setFromNormalAndCoplanarPoint(i,n),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e),s=t||new THREE.Vector3;return s.copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return 0>t&&n>0||0>n&&t>0},intersectLine:function(){var e=new THREE.Vector3;return function(t,n){var s,o=n||new THREE.Vector3,i=t.delta(e),a=this.normal.dot(i);return 0==a?0==this.distanceToPoint(t.start)?o.copy(t.start):void 0:(s=-(t.start.dot(this.normal)+this.constant)/a,0>s||s>1?void 0:o.copy(i).multiplyScalar(s).add(t.start))}}(),coplanarPoint:function(e){var t=e||new THREE.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Matrix3;return function(s,o){var a=o||n.getNormalMatrix(s),r=e.copy(this.normal).applyMatrix3(a),i=this.coplanarPoint(t);return i.applyMatrix4(s),this.setFromNormalAndCoplanarPoint(r,i),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={generateUUID:function(){var n,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=new Array(36),t=0;return function(){for(var o=0;36>o;o++)8==o||13==o||18==o||23==o?e[o]="-":14==o?e[o]="4":(2>=t&&(t=33554432+16777216*Math.random()|0),n=15&t,t>>=4,e[o]=s[19==o?3&n|8:n]);return e.join("")}}(),clamp:function(e,t,n){return t>e?t:e>n?n:e},clampBottom:function(e,t){return t>e?t:e},mapLinear:function(e,t,n,s,o){return s+(e-t)*(o-s)/(n-t)},smoothstep:function(e,t,n){return t>=e?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return t>=e?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return Math.floor(this.randFloat(e,t))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}},THREE.Spline=function(e){function u(e,t,n,s,o,i,a){var r=.5*(n-e),c=.5*(s-t);return(2*(t-n)+r+c)*a+(-3*(t-n)-2*r-c)*i+r*o+t}this.points=e;var t,s,o,i,a,r,c,l,h,n=[],d={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return h=(this.points.length-1)*e,t=Math.floor(h),s=h-t,n[0]=0===t?t:t-1,n[1]=t,n[2]=t>this.points.length-2?this.points.length-1:t+1,n[3]=t>this.points.length-3?this.points.length-1:t+2,a=this.points[n[0]],r=this.points[n[1]],c=this.points[n[2]],l=this.points[n[3]],o=s*s,i=s*o,d.x=u(a.x,r.x,c.x,l.x,s,o,i),d.y=u(a.y,r.y,c.y,l.y,s,o,i),d.z=u(a.z,r.z,c.z,l.z,s,o,i),d},this.getControlPointsArray=function(){var e,t,s=this.points.length,n=[];for(e=0;s>e;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var n,i,a,r,l=0,s=0,d=0,c=new THREE.Vector3,u=new THREE.Vector3,t=[],o=0;for(t[0]=0,e||(e=100),a=this.points.length*e,c.copy(this.points[0]),n=1;a>n;n++)i=n/a,r=this.getPoint(i),u.copy(r),o+=u.distanceTo(c),c.copy(r),l=(this.points.length-1)*i,s=Math.floor(l),s!=d&&(t[s]=o,d=s);return t[t.length]=o,{chunks:t,total:o}},this.reparametrizeByArcLength=function(e){var t,n,o,i,c,l,d,u,s=[],a=new THREE.Vector3,r=this.getLength();for(s.push(a.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(d=r.chunks[t]-r.chunks[t-1],i=Math.ceil(e*d/r.total),o=(t-1)/(this.points.length-1),l=t/(this.points.length-1),n=1;i-1>n;n++)c=o+n*(1/i)*(l-o),u=this.getPoint(c),s.push(a.copy(u).clone());s.push(a.copy(this.points[t]).clone())}this.points=s}},THREE.Triangle=function(e,t,n){this.a=void 0!==e?e:new THREE.Vector3,this.b=void 0!==t?t:new THREE.Vector3,this.c=void 0!==n?n:new THREE.Vector3},THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,n,s,o){var a,i=o||new THREE.Vector3;return i.subVectors(s,n),e.subVectors(t,n),i.cross(e),a=i.lengthSq(),a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(s,o,i,a,r){e.subVectors(a,o),t.subVectors(i,o),n.subVectors(s,o);var l=e.dot(e),c=e.dot(t),d=e.dot(n),u=t.dot(t),h=t.dot(n),m=l*u-c*c,f=r||new THREE.Vector3;if(0==m)return f.set(-2,-1,-1);var p=1/m,g=(u*d-c*h)*p,v=(l*h-c*d)*p;return f.set(1-g-v,v,g)}}(),THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,n,s,o){var i=THREE.Triangle.barycoordFromPoint(t,n,s,o,e);return i.x>=0&&i.y>=0&&i.x+i.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new THREE.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Clock=function(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return(this.autoStart&&!this.running&&this.start(),this.running)&&(t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e),e}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(e){e.addEventListener=THREE.EventDispatcher.prototype.addEventListener,e.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,e.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var s,o=this._listeners,n=o[e];void 0!==n&&(s=n.indexOf(t),-1!==s&&n.splice(s,1))}},dispatchEvent:function(e){if(void 0!==this._listeners&&(s=this._listeners,n=s[e.type],void 0!==n)){e.target=this;for(var n,s,o=[],i=n.length,t=0;i>t;t++)o[t]=n[t];for(t=0;i>t;t++)o[t].call(this,e)}}},function(e){e.Raycaster=function(t,n,s,o){this.ray=new e.Ray(t,n),this.near=s||0,this.far=o||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var n=function(e,t){return e.distance-t.distance},t=function(e,n,s,o){if(e.raycast(n,s),o===!0)for(var a=e.children,i=0,r=a.length;r>i;i++)t(a[i],n,s,!0)};e.Raycaster.prototype={constructor:e.Raycaster,precision:1e-4,linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,n){n instanceof e.PerspectiveCamera?(this.ray.origin.copy(n.position),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(n.position).normalize()):n instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld)):e.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,s){var o=[];return t(e,this,o,s),o.sort(n),o},intersectObjects:function(s,o){if(i=[],s instanceof Array==!1)return e.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var i,a=0,r=s.length;r>a;a++)t(s[a],this,i,o);return i.sort(n),i}}}(THREE),THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=THREE.Object3D.DefaultUp.clone();var n=new THREE.Vector3,e=new THREE.Euler,t=new THREE.Quaternion,s=new THREE.Vector3(1,1,1),o=function(){t.setFromEuler(e,!1)},i=function(){e.setFromQuaternion(t,void 0,!1)};e.onChange(o),t.onChange(i),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:t},scale:{enumerable:!0,value:s}}),this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0),THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){return THREE.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(e){THREE.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=e},get useQuaternion(){THREE.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){THREE.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new THREE.Quaternion;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translate:function(e,t){return THREE.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(THREE.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e instanceof THREE.Object3D?(void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):THREE.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1)for(var n,t=0;t<arguments.length;t++)this.remove(arguments[t]);n=this.children.indexOf(e),-1!==n&&(e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getChildByName:function(e){return THREE.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var s,o,n=0,i=this.children.length;i>n;n++)if(o=this.children[n],s=o.getObjectByProperty(e,t),void 0!==s)return s},getWorldPosition:function(e){var t=e||new THREE.Vector3;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n){var s=n||new THREE.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,s,t),s}}(),getWorldRotation:function(){var e=new THREE.Quaternion;return function(t){var n=t||new THREE.Euler;return this.getWorldQuaternion(e),n.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new THREE.Vector3,t=new THREE.Quaternion;return function(n){var s=n||new THREE.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,s),s}}(),getWorldDirection:function(){var e=new THREE.Quaternion;return function(t){var n=t||new THREE.Vector3;return this.getWorldQuaternion(e),n.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=0,n=this.children.length;n>t;t++)this.children[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=0,n=this.children.length;n>t;t++)this.children[t].traverseVisible(e)}},traverseAncestors:function(e){this.parent&&(e(this.parent),this.parent.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||e===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,n=this.children.length;n>t;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(){var e={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},t={},i=function(n){if(void 0===e.geometries&&(e.geometries=[]),void 0===t[n.uuid]){var s=n.toJSON();delete s.metadata,t[n.uuid]=s,e.geometries.push(s)}return n.uuid},n={},s=function(t){if(void 0===e.materials&&(e.materials=[]),void 0===n[t.uuid]){var s=t.toJSON();delete s.metadata,n[t.uuid]=s,e.materials.push(s)}return t.uuid},o=function(e){var n,t={};if(t.uuid=e.uuid,t.type=e.type,""!==e.name&&(t.name=e.name),"{}"!==JSON.stringify(e.userData)&&(t.userData=e.userData),e.visible!==!0&&(t.visible=e.visible),e instanceof THREE.PerspectiveCamera?(t.fov=e.fov,t.aspect=e.aspect,t.near=e.near,t.far=e.far):e instanceof THREE.OrthographicCamera?(t.left=e.left,t.right=e.right,t.top=e.top,t.bottom=e.bottom,t.near=e.near,t.far=e.far):e instanceof THREE.AmbientLight?t.color=e.color.getHex():e instanceof THREE.DirectionalLight?(t.color=e.color.getHex(),t.intensity=e.intensity):e instanceof THREE.PointLight?(t.color=e.color.getHex(),t.intensity=e.intensity,t.distance=e.distance,t.decay=e.decay):e instanceof THREE.SpotLight?(t.color=e.color.getHex(),t.intensity=e.intensity,t.distance=e.distance,t.angle=e.angle,t.exponent=e.exponent,t.decay=e.decay):e instanceof THREE.HemisphereLight?(t.color=e.color.getHex(),t.groundColor=e.groundColor.getHex()):e instanceof THREE.Mesh||e instanceof THREE.Line||e instanceof THREE.PointCloud?(t.geometry=i(e.geometry),t.material=s(e.material),e instanceof THREE.Line&&(t.mode=e.mode)):e instanceof THREE.Sprite&&(t.material=s(e.material)),t.matrix=e.matrix.toArray(),e.children.length>0){t.children=[];for(n=0;n<e.children.length;n++)t.children.push(o(e.children[n]))}return t};return e.object=o(this),e},clone:function(e,t){if(void 0===e&&(e=new THREE.Object3D),void 0===t&&(t=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData)),t===!0)for(var s,n=0;n<this.children.length;n++)s=this.children[n],e.add(s.clone());return e}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Face3=function(e,t,n,s,o,i){this.a=e,this.b=t,this.c=n,this.normal=s instanceof THREE.Vector3?s:new THREE.Vector3,this.vertexNormals=s instanceof Array?s:[],this.color=o instanceof THREE.Color?o:new THREE.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=void 0!==i?i:0},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){t=new THREE.Face3(this.a,this.b,this.c),t.normal.copy(this.normal),t.color.copy(this.color),t.materialIndex=this.materialIndex;for(var t,e=0,n=this.vertexNormals.length;n>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,n=this.vertexColors.length;n>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,n=this.vertexTangents.length;n>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},THREE.Face4=function(e,t,n,s,o,i,a){return THREE.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(e,t,n,o,i,a)},THREE.BufferAttribute=function(e,t){this.array=e,this.itemSize=t,this.needsUpdate=!1},THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){return this.array.length},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var s=0,o=this.itemSize;o>s;s++)this.array[e+s]=t.array[n+s];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},setX:function(e,t){return this.array[e*this.itemSize]=t,this},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,s){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=n,this.array[e+2]=s,this},setXYZW:function(e,t,n,s,o){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=o,this},clone:function(){return new THREE.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},THREE.Int8Attribute=function(e,t){return THREE.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Uint8Attribute=function(e,t){return THREE.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Uint8ClampedAttribute=function(e,t){return THREE.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Int16Attribute=function(e,t){return THREE.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Uint16Attribute=function(e,t){return THREE.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Int32Attribute=function(e,t){return THREE.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Uint32Attribute=function(e,t){return THREE.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Float32Attribute=function(e,t){return THREE.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.Float64Attribute=function(e,t){return THREE.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(e,t)},THREE.DynamicBufferAttribute=function(e,t){THREE.BufferAttribute.call(this,e,t),this.updateRange={offset:0,count:-1}},THREE.DynamicBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype),THREE.DynamicBufferAttribute.prototype.constructor=THREE.DynamicBufferAttribute,THREE.DynamicBufferAttribute.prototype.clone=function(){return new THREE.DynamicBufferAttribute(new this.array.constructor(this.array),this.itemSize)},THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(e,t){return t instanceof THREE.BufferAttribute==!1?(THREE.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void(this.attributes[e]={array:arguments[1],itemSize:arguments[2]})):(this.attributes[e]=t,void(this.attributesKeys=Object.keys(this.attributes)))},getAttribute:function(e){return this.attributes[e]},addDrawCall:function(e,t,n){this.drawcalls.push({start:e,count:t,index:void 0!==n?n:0})},applyMatrix:function(e){var t,s,n=this.attributes.position;void 0!==n&&(e.applyToVector3Array(n.array),n.needsUpdate=!0),t=this.attributes.normal,void 0!==t&&(s=(new THREE.Matrix3).getNormalMatrix(e),s.applyToVector3Array(t.array),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.applyMatrix((new THREE.Matrix4).setPosition(e)),e},fromGeometry:function(e,t){t=t||{vertexColors:THREE.NoColors};var s,o,a,c,l,O=e.vertices,u=e.faces,m=e.faceVertexUvs,y=t.vertexColors,C=m[0].length>0,S=3==u[0].vertexNormals.length,r=new Float32Array(3*u.length*3);this.addAttribute("position",new THREE.BufferAttribute(r,3)),s=new Float32Array(3*u.length*3),(this.addAttribute("normal",new THREE.BufferAttribute(s,3)),y!==THREE.NoColors)&&(o=new Float32Array(3*u.length*3),this.addAttribute("color",new THREE.BufferAttribute(o,3))),C===!0&&(l=new Float32Array(3*u.length*2),this.addAttribute("uv",new THREE.BufferAttribute(l,2)));for(var h=0,d=0,n=0;h<u.length;h++,d+=6,n+=9){var i=u[h],g=O[i.a],v=O[i.b],w=O[i.c];if(r[n]=g.x,r[n+1]=g.y,r[n+2]=g.z,r[n+3]=v.x,r[n+4]=v.y,r[n+5]=v.z,r[n+6]=w.x,r[n+7]=w.y,r[n+8]=w.z,S===!0){var j=i.vertexNormals[0],_=i.vertexNormals[1],f=i.vertexNormals[2];s[n]=j.x,s[n+1]=j.y,s[n+2]=j.z,s[n+3]=_.x,s[n+4]=_.y,s[n+5]=_.z,s[n+6]=f.x,s[n+7]=f.y,s[n+8]=f.z}else c=i.normal,s[n]=c.x,s[n+1]=c.y,s[n+2]=c.z,s[n+3]=c.x,s[n+4]=c.y,s[n+5]=c.z,s[n+6]=c.x,s[n+7]=c.y,s[n+8]=c.z;if(y===THREE.FaceColors)a=i.color,o[n]=a.r,o[n+1]=a.g,o[n+2]=a.b,o[n+3]=a.r,o[n+4]=a.g,o[n+5]=a.b,o[n+6]=a.r,o[n+7]=a.g,o[n+8]=a.b;else if(y===THREE.VertexColors){var p=i.vertexColors[0],x=i.vertexColors[1],b=i.vertexColors[2];o[n]=p.r,o[n+1]=p.g,o[n+2]=p.b,o[n+3]=x.r,o[n+4]=x.g,o[n+5]=x.b,o[n+6]=b.r,o[n+7]=b.g,o[n+8]=b.b}if(C===!0){var E=m[0][h][0],k=m[0][h][1],A=m[0][h][2];l[d]=E.x,l[d+1]=E.y,l[d+2]=k.x,l[d+3]=k.y,l[d+4]=A.x,l[d+5]=A.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var e=new THREE.Vector3;return function(){if(null===this.boundingBox&&(this.boundingBox=new THREE.Box3),t=this.attributes.position.array,t){s=this.boundingBox,s.makeEmpty();for(var t,s,n=0,o=t.length;o>n;n+=3)e.set(t[n],t[n+1],t[n+2]),s.expandByPoint(e)}(void 0===t||0===t.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&THREE.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var t=new THREE.Box3,e=new THREE.Vector3;return function(){if(null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),s=this.attributes.position.array,s){t.makeEmpty();for(var s,a=this.boundingSphere.center,n=0,o=s.length;o>n;n+=3)e.set(s[n],s[n+1],s[n+2]),t.expandByPoint(e);t.center(a);for(var i=0,n=0,o=s.length;o>n;n+=3)e.set(s[n],s[n+1],s[n+2]),i=Math.max(i,a.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&THREE.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){if(o=this.attributes,o.position){if(s=o.position.array,void 0===o.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(s.length),3));else for(var n=o.normal.array,e=0,a=n.length;a>e;e++)n[e]=0;var e,s,o,a,c,l,d,n=o.normal.array,u=new THREE.Vector3,i=new THREE.Vector3,h=new THREE.Vector3,t=new THREE.Vector3,m=new THREE.Vector3;if(o.index)for(var f=o.index.array,p=this.offsets.length>0?this.offsets:[{start:0,count:f.length,index:0}],r=0,b=p.length;b>r;++r)for(var v=p[r].start,j=p[r].count,g=p[r].index,e=v,a=v+j;a>e;e+=3)d=3*(g+f[e]),l=3*(g+f[e+1]),c=3*(g+f[e+2]),u.fromArray(s,d),i.fromArray(s,l),h.fromArray(s,c),t.subVectors(h,i),m.subVectors(u,i),t.cross(m),n[d]+=t.x,n[d+1]+=t.y,n[d+2]+=t.z,n[l]+=t.x,n[l+1]+=t.y,n[l+2]+=t.z,n[c]+=t.x,n[c+1]+=t.y,n[c+2]+=t.z;else for(e=0,a=s.length;a>e;e+=9)u.fromArray(s,e),i.fromArray(s,e+3),h.fromArray(s,e+6),t.subVectors(h,i),m.subVectors(u,i),t.cross(m),n[e]=t.x,n[e+1]=t.y,n[e+2]=t.z,n[e+3]=t.x,n[e+4]=t.y,n[e+5]=t.z,n[e+6]=t.x,n[e+7]=t.y,n[e+8]=t.z;this.normalizeNormals(),o.normal.needsUpdate=!0}},computeTangents:function(){function K(e,t,n){s.fromArray(y,3*e),w.fromArray(y,3*t),v.fromArray(y,3*n),d.fromArray(R,2*e),I.fromArray(R,2*t),D.fromArray(R,2*n),F=w.x-s.x,N=v.x-s.x,z=w.y-s.y,M=v.y-s.y,L=w.z-s.z,H=v.z-s.z,u=I.x-d.x,p=D.x-d.x,f=I.y-d.y,m=D.y-d.y,o=1/(u*m-p*f),_.set((m*F-f*N)*o,(m*z-f*M)*o,(m*L-f*H)*o),g.set((u*N-p*F)*o,(u*M-p*z)*o,(u*H-p*L)*o),c[e].add(_),c[t].add(_),c[n].add(_),l[e].add(g),l[t].add(g),l[n].add(g)}function P(e){b.fromArray(q,3*e),W.copy(b),j=c[e],h.copy(j),h.sub(b.multiplyScalar(b.dot(j))).normalize(),U.crossVectors(W,j),$=U.dot(l[e]),V=0>$?-1:1,S[4*e]=h.x,S[4*e+1]=h.y,S[4*e+2]=h.z,S[4*e+3]=V}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return void THREE.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");var i=this.attributes.index.array,y=this.attributes.position.array,q=this.attributes.normal.array,R=this.attributes.uv.array,B=y.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*B),4));for(var S=this.attributes.tangent.array,c=[],l=[],x=0;B>x;x++)c[x]=new THREE.Vector3,l[x]=new THREE.Vector3;var e,t,n,o,u,m,f,p,O,C,E,k,A,M,F,z,N,L,H,s=new THREE.Vector3,w=new THREE.Vector3,v=new THREE.Vector3,d=new THREE.Vector2,I=new THREE.Vector2,D=new THREE.Vector2,_=new THREE.Vector3,g=new THREE.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,i.length,0),n=this.drawcalls;for(t=0,C=n.length;C>t;++t){var r=n[t].start,T=n[t].count,a=n[t].index;for(e=r,O=r+T;O>e;e+=3)E=a+i[e],k=a+i[e+1],A=a+i[e+2],K(E,k,A)}var j,V,$,h=new THREE.Vector3,U=new THREE.Vector3,b=new THREE.Vector3,W=new THREE.Vector3;for(t=0,C=n.length;C>t;++t){var r=n[t].start,T=n[t].count,a=n[t].index;for(e=r,O=r+T;O>e;e+=3)E=a+i[e],k=a+i[e+1],A=a+i[e+2],P(E),P(k),P(A)}},computeOffsets:function(e){void 0===e&&(e=65535);for(var t,s,o,i,u,p,j,m=this.attributes.index.array,f=this.attributes.position.array,y=m.length/3,b=new Uint16Array(m.length),v=0,l=0,r=[{start:0,count:0,index:0}],a=r[0],_=0,h=0,n=new Int32Array(6),c=new Int32Array(f.length),g=new Int32Array(f.length),d=0;d<f.length;d++)c[d]=-1,g[d]=-1;for(u=0;y>u;u++){h=0;for(t=0;3>t;t++)o=m[3*u+t],-1==c[o]?(n[2*t]=o,n[2*t+1]=-1,h++):c[o]<a.index?(n[2*t]=o,n[2*t+1]=-1,_++):(n[2*t]=o,n[2*t+1]=c[o]);if(j=l+h,j>a.index+e){p={start:v,count:0,index:l},r.push(p),a=p;for(s=0;6>s;s+=2)i=n[s+1],i>-1&&i<a.index&&(n[s+1]=-1)}for(s=0;6>s;s+=2)o=n[s],i=n[s+1],-1===i&&(i=l++),c[o]=i,g[i]=o,b[v++]=i-a.index,a.count++}return this.reorderBuffers(b,g,l),this.offsets=r,this.drawcalls=r,r},merge:function(e,t){if(e instanceof THREE.BufferGeometry==!1)return void THREE.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0),n=this.attributes;for(s in n)if(void 0!==e.attributes[s])for(var n,s,c=n[s],l=c.array,i=e.attributes[s],a=i.array,d=i.itemSize,o=0,r=d*t;o<a.length;o++,r++)l[r]=a[o];return this},normalizeNormals:function(){for(var n,s,o,i,t=this.attributes.normal.array,e=0,a=t.length;a>e;e+=3)s=t[e],o=t[e+1],i=t[e+2],n=1/Math.sqrt(s*s+o*o+i*i),t[e]*=n,t[e+1]*=n,t[e+2]*=n},reorderBuffers:function(e,t,n){i={};for(s in this.attributes)"index"!=s&&(c=this.attributes[s].array,i[s]=new c.constructor(this.attributes[s].itemSize*n));for(o=0;n>o;o++){l=t[o];for(s in this.attributes)if("index"!=s)for(var s,o,i,c,l,d=this.attributes[s].array,r=this.attributes[s].itemSize,u=i[s],a=0;r>a;a++)u[o*r+a]=d[l*r+a]}this.attributes.index.array=e;for(s in this.attributes)"index"!=s&&(this.attributes[s].array=i[s],this.attributes[s].numItems=this.attributes[s].itemSize*n)},toJSON:function(){var t,i,a,e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},s=this.attributes,o=this.offsets,n=this.boundingSphere;for(i in s)t=s[i],a=Array.prototype.slice.call(t.array),e.data.attributes[i]={itemSize:t.itemSize,type:t.array.constructor.name,array:a};return o.length>0&&(e.data.offsets=JSON.parse(JSON.stringify(o))),null!==n&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),e},clone:function(){e=new THREE.BufferGeometry;for(s in this.attributes)o=this.attributes[s],e.addAttribute(s,o.clone());for(var e,t,s,o,n=0,i=this.offsets.length;i>n;n++)t=this.offsets[n],e.offsets.push({start:t.start,index:t.index,count:t.count});return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(e){for(var n,s,a,r,i=(new THREE.Matrix3).getNormalMatrix(e),t=0,o=this.vertices.length;o>t;t++)a=this.vertices[t],a.applyMatrix4(e);for(t=0,o=this.faces.length;o>t;t++){n=this.faces[t],n.normal.applyMatrix3(i).normalize();for(s=0,r=n.vertexNormals.length;r>s;s++)n.vertexNormals[s].applyMatrix3(i).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},fromBufferGeometry:function(e){for(var h,m,i=this,n=e.attributes,a=n.position.array,o=void 0!==n.index?n.index.array:void 0,r=void 0!==n.normal?n.normal.array:void 0,c=void 0!==n.color?n.color.array:void 0,u=void 0!==n.uv?n.uv.array:void 0,d=[],l=[],t=0,s=0;t<a.length;t+=3,s+=2)i.vertices.push(new THREE.Vector3(a[t],a[t+1],a[t+2])),void 0!==r&&d.push(new THREE.Vector3(r[t],r[t+1],r[t+2])),void 0!==c&&i.colors.push(new THREE.Color(c[t],c[t+1],c[t+2])),void 0!==u&&l.push(new THREE.Vector2(u[s],u[s+1]));if(h=function(e,t,n){var s=void 0!==r?[d[e].clone(),d[t].clone(),d[n].clone()]:[],o=void 0!==c?[i.colors[e].clone(),i.colors[t].clone(),i.colors[n].clone()]:[];i.faces.push(new THREE.Face3(e,t,n,s,o)),void 0!==u&&i.faceVertexUvs[0].push([l[e].clone(),l[t].clone(),l[n].clone()])},void 0!==o)if(m=e.drawcalls,m.length>0)for(t=0;t<m.length;t++)for(var f=m[t],g=f.start,v=f.count,p=f.index,s=g,b=g+v;b>s;s+=3)h(p+o[s],p+o[s+1],p+o[s+2]);else for(t=0;t<o.length;t+=3)h(o[t],o[t+1],o[t+2]);else for(t=0;t<a.length/3;t+=3)h(t,t+1,t+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.applyMatrix((new THREE.Matrix4).setPosition(e)),e},computeFaceNormals:function(){for(var e=new THREE.Vector3,s=new THREE.Vector3,n=0,i=this.faces.length;i>n;n++){var t=this.faces[n],a=this.vertices[t.a],o=this.vertices[t.b],r=this.vertices[t.c];e.subVectors(r,o),s.subVectors(a,o),e.cross(s),e.normalize(),t.normal.copy(e)}},computeVertexNormals:function(e){for(s=new Array(this.vertices.length),o=0,r=this.vertices.length;r>o;o++)s[o]=new THREE.Vector3;if(e){var t,n,s,o,i,r,c,l,d,a=new THREE.Vector3,u=new THREE.Vector3;for(n=0,i=this.faces.length;i>n;n++)t=this.faces[n],l=this.vertices[t.a],c=this.vertices[t.b],d=this.vertices[t.c],a.subVectors(d,c),u.subVectors(l,c),a.cross(u),s[t.a].add(a),s[t.b].add(a),s[t.c].add(a)}else for(n=0,i=this.faces.length;i>n;n++)t=this.faces[n],s[t.a].add(t.normal),s[t.b].add(t.normal),s[t.c].add(t.normal);for(o=0,r=this.vertices.length;r>o;o++)s[o].normalize();for(n=0,i=this.faces.length;i>n;n++)t=this.faces[n],t.vertexNormals[0]=s[t.a].clone(),t.vertexNormals[1]=s[t.b].clone(),t.vertexNormals[2]=s[t.c].clone()},computeMorphNormals:function(){for(n=0,s=this.faces.length;s>n;n++)for(e=this.faces[n],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),t=0,r=e.vertexNormals.length;r>t;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone();i=new THREE.Geometry;for(i.faces=this.faces,t=0,r=this.morphTargets.length;r>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var e,t,n,s,o,i,a,r,c,l=this.morphNormals[t].faceNormals,d=this.morphNormals[t].vertexNormals;for(n=0,s=this.faces.length;s>n;n++)a=new THREE.Vector3,o={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},l.push(a),d.push(o)}c=this.morphNormals[t],i.vertices=this.morphTargets[t].vertices,i.computeFaceNormals(),i.computeVertexNormals();for(n=0,s=this.faces.length;s>n;n++)e=this.faces[n],a=c.faceNormals[n],o=c.vertexNormals[n],a.copy(e.normal),o.a.copy(e.vertexNormals[0]),o.b.copy(e.vertexNormals[1]),o.c.copy(e.vertexNormals[2])}for(n=0,s=this.faces.length;s>n;n++)e=this.faces[n],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){function L(e,t,n,r,l,g,v){o=e.vertices[t],j=e.vertices[n],b=e.vertices[r],a=y[l],w=y[g],M=y[v],S=j.x-o.x,E=b.x-o.x,C=j.y-o.y,_=b.y-o.y,O=j.z-o.z,A=b.z-o.z,h=w.x-a.x,c=M.x-a.x,d=w.y-a.y,u=M.y-a.y,s=1/(h*u-c*d),f.set((u*S-d*E)*s,(u*C-d*_)*s,(u*O-d*A)*s),p.set((h*E-c*S)*s,(h*_-c*C)*s,(h*A-c*O)*s),i[t].add(f),i[n].add(f),i[r].add(f),m[t].add(p),m[n].add(p),m[r].add(p)}var e,t,n,s,o,a,c,l,d,u,h,g,v,b,j,y,_,w,O,C,E,k,A,S,M,F,T,z,N,i=[],m=[],f=new THREE.Vector3,p=new THREE.Vector3,r=new THREE.Vector3,D=new THREE.Vector3,x=new THREE.Vector3;for(l=0,z=this.vertices.length;z>l;l++)i[l]=new THREE.Vector3,m[l]=new THREE.Vector3;for(t=0,v=this.faces.length;v>t;t++)e=this.faces[t],y=this.faceVertexUvs[0][t],L(this,e.a,e.b,e.c,0,1,2);N=["a","b","c","d"];for(t=0,v=this.faces.length;v>t;t++)for(e=this.faces[t],n=0;n<Math.min(e.vertexNormals.length,3);n++)x.copy(e.vertexNormals[n]),k=e[N[n]],g=i[k],r.copy(g),r.sub(x.multiplyScalar(x.dot(g))).normalize(),D.crossVectors(e.vertexNormals[n],g),T=D.dot(m[k]),F=0>T?-1:1,e.vertexTangents[n]=new THREE.Vector4(r.x,r.y,r.z,F);this.hasTangents=!0},computeLineDistances:function(){for(var n=0,t=this.vertices,e=0,s=t.length;s>e;e++)e>0&&(n+=t[e].distanceTo(t[e-1])),this.lineDistances[e]=n},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e instanceof THREE.Geometry==!1)return void THREE.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);var s,o,r,c,l,d,h,f,g,u=this.vertices.length,x=this.vertices,_=e.vertices,O=this.faces,p=e.faces,w=this.faceVertexUvs[0],b=e.faceVertexUvs[0];void 0===n&&(n=0),void 0!==t&&(l=(new THREE.Matrix3).getNormalMatrix(t));for(o=0,c=_.length;c>o;o++)g=_[o],f=g.clone(),void 0!==t&&f.applyMatrix4(t),x.push(f);for(o=0,c=p.length;c>o;o++){var m,v,a=p[o],j=a.vertexNormals,y=a.vertexColors,i=new THREE.Face3(a.a+u,a.b+u,a.c+u);i.normal.copy(a.normal),void 0!==l&&i.normal.applyMatrix3(l).normalize();for(s=0,r=j.length;r>s;s++)m=j[s].clone(),void 0!==l&&m.applyMatrix3(l).normalize(),i.vertexNormals.push(m);i.color.copy(a.color);for(s=0,r=y.length;r>s;s++)v=y[s],i.vertexColors.push(v.clone());i.materialIndex=a.materialIndex+n,O.push(i)}for(o=0,c=b.length;c>o;o++)if(d=b[o],h=[],void 0!==d){for(s=0,r=d.length;r>s;s++)h.push(d[s].clone());w.push(h)}},mergeMesh:function(e){return e instanceof THREE.Mesh==!1?void THREE.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e):(e.matrixAutoUpdate&&e.updateMatrix(),void this.merge(e.geometry,e.matrix))},mergeVertices:function(){var e,t,s,o,i,a,r,c,h,m,f,p,g,d={},l=[],n=[],v=4,u=Math.pow(10,v);for(e=0,i=this.vertices.length;i>e;e++)c=this.vertices[e],o=Math.round(c.x*u)+"_"+Math.round(c.y*u)+"_"+Math.round(c.z*u),void 0===d[o]?(d[o]=e,l.push(this.vertices[e]),n[e]=l.length-1):n[e]=n[d[o]];r=[];for(e=0,i=this.faces.length;i>e;e++){t=this.faces[e],t.a=n[t.a],t.b=n[t.b],t.c=n[t.c],h=[t.a,t.b,t.c];for(p=-1,s=0;3>s;s++)if(h[s]==h[(s+1)%3]){p=s,r.push(e);break}}for(e=r.length-1;e>=0;e--){m=r[e];for(this.faces.splice(m,1),a=0,f=this.faceVertexUvs.length;f>a;a++)this.faceVertexUvs[a].splice(m,1)}return g=this.vertices.length-l.length,this.vertices=l,g},toJSON:function(){function i(e,t,n){return n?e|1<<t:e&~(1<<t)}function v(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==f[t]?f[t]:(f[t]=j.length/3,j.push(e.x,e.y,e.z),f[t])}function c(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==h[t]?h[t]:(h[t]=m.length,m.push(e.getHex()),h[t])}function _(e){var t=e.x.toString()+e.y.toString();return void 0!==g[t]?g[t]:(g[t]=p.length/2,p.push(e.x,e.y),g[t])}if(n={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type},""!==this.name&&(n.name=this.name),void 0!==this.parameters){d=this.parameters;for(y in d)void 0!==d[y]&&(n[y]=d[y]);return n}for(b=[],s=0;s<this.vertices.length;s++)l=this.vertices[s],b.push(l.x,l.y,l.z);for(var o=[],j=[],f={},m=[],h={},p=[],g={},s=0;s<this.faces.length;s++){var n,s,a,r,l,d,u,b,y,t=this.faces[s],A=!1,k=!1,w=void 0!==this.faceVertexUvs[0][s],O=t.normal.length()>0,x=t.vertexNormals.length>0,C=1!==t.color.r||1!==t.color.g||1!==t.color.b,E=t.vertexColors.length>0,e=0;(e=i(e,0,0),e=i(e,1,A),e=i(e,2,k),e=i(e,3,w),e=i(e,4,O),e=i(e,5,x),e=i(e,6,C),e=i(e,7,E),o.push(e),o.push(t.a,t.b,t.c),w)&&(u=this.faceVertexUvs[0][s],o.push(_(u[0]),_(u[1]),_(u[2]))),(O&&o.push(v(t.normal)),x)&&(r=t.vertexNormals,o.push(v(r[0]),v(r[1]),v(r[2]))),(C&&o.push(c(t.color)),E)&&(a=t.vertexColors,o.push(c(a[0]),c(a[1]),c(a[2])))}return n.data={},n.data.vertices=b,n.data.normals=j,m.length>0&&(n.data.colors=m),p.length>0&&(n.data.uvs=[p]),n.data.faces=o,n},clone:function(){for(var s,o,c,u,t=new THREE.Geometry,r=this.vertices,e=0,n=r.length;n>e;e++)t.vertices.push(r[e].clone());for(var a=this.faces,e=0,n=a.length;n>e;e++)t.faces.push(a[e].clone());for(e=0,n=this.faceVertexUvs.length;n>e;e++){o=this.faceVertexUvs[e],void 0===t.faceVertexUvs[e]&&(t.faceVertexUvs[e]=[]);for(s=0,c=o.length;c>s;s++){for(var l=o[s],d=[],i=0,h=l.length;h>i;i++)u=l[i],d.push(u.clone());t.faceVertexUvs[e].push(d)}}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.Camera=function(){THREE.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.getWorldDirection=function(){var e=new THREE.Quaternion;return function(t){var n=t||new THREE.Vector3;return this.getWorldQuaternion(e),n.set(0,0,-1).applyQuaternion(e)}}(),THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),THREE.Camera.prototype.clone=function(e){return void 0===e&&(e=new THREE.Camera),THREE.Object3D.prototype.clone.call(this,e),e.matrixWorldInverse.copy(this.matrixWorldInverse),e.projectionMatrix.copy(this.projectionMatrix),e},THREE.CubeCamera=function(e,t,n){THREE.Object3D.call(this),this.type="CubeCamera";var i,a,r,c,l,s=90,o=1,d=new THREE.PerspectiveCamera(s,o,e,t);d.up.set(0,-1,0),d.lookAt(new THREE.Vector3(1,0,0)),this.add(d),i=new THREE.PerspectiveCamera(s,o,e,t),i.up.set(0,-1,0),i.lookAt(new THREE.Vector3(-1,0,0)),this.add(i),a=new THREE.PerspectiveCamera(s,o,e,t),a.up.set(0,0,1),a.lookAt(new THREE.Vector3(0,1,0)),this.add(a),r=new THREE.PerspectiveCamera(s,o,e,t),r.up.set(0,0,-1),r.lookAt(new THREE.Vector3(0,-1,0)),this.add(r),c=new THREE.PerspectiveCamera(s,o,e,t),c.up.set(0,-1,0),c.lookAt(new THREE.Vector3(0,0,1)),this.add(c),l=new THREE.PerspectiveCamera(s,o,e,t),l.up.set(0,-1,0),l.lookAt(new THREE.Vector3(0,0,-1)),this.add(l),this.renderTarget=new THREE.WebGLRenderTargetCube(n,n,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(e,t){var n=this.renderTarget,s=n.generateMipmaps;n.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,d,n),n.activeCubeFace=1,e.render(t,i,n),n.activeCubeFace=2,e.render(t,a,n),n.activeCubeFace=3,e.render(t,r,n),n.activeCubeFace=4,e.render(t,c,n),n.generateMipmaps=s,n.activeCubeFace=5,e.render(t,l,n)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CubeCamera.prototype.constructor=THREE.CubeCamera,THREE.OrthographicCamera=function(e,t,n,s,o,i){THREE.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=void 0!==o?o:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(n-e,n+e,s+t,s-t,this.near,this.far)},THREE.OrthographicCamera.prototype.clone=function(){var e=new THREE.OrthographicCamera;return THREE.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},THREE.PerspectiveCamera=function(e,t,n,s){THREE.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==n?n:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,n,s,o,i){this.fullWidth=e,this.fullHeight=t,this.x=n,this.y=s,this.width=o,this.height=i,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(t=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom)),this.fullWidth){var t,s=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(.5*t))*this.near,o=-e,n=s*o,r=s*e,i=Math.abs(r-n),a=Math.abs(e-o);this.projectionMatrix.makeFrustum(n+this.x*i/this.fullWidth,n+(this.x+this.width)*i/this.fullWidth,e-(this.y+this.height)*a/this.fullHeight,e-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.clone=function(){var e=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},THREE.Light=function(e){THREE.Object3D.call(this),this.type="Light",this.color=new THREE.Color(e)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.clone=function(e){return void 0===e&&(e=new THREE.Light),THREE.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},THREE.AmbientLight=function(e){THREE.Light.call(this,e),this.type="AmbientLight"},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.AmbientLight.prototype.clone=function(){var e=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,e),e},THREE.AreaLight=function(e,t){THREE.Light.call(this,e),this.type="AreaLight",this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.AreaLight.prototype.constructor=THREE.AreaLight,THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.DirectionalLight.prototype.clone=function(){var e=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraLeft=this.shadowCameraLeft,e.shadowCameraRight=this.shadowCameraRight,e.shadowCameraTop=this.shadowCameraTop,e.shadowCameraBottom=this.shadowCameraBottom,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e.shadowCascade=this.shadowCascade,e.shadowCascadeOffset.copy(this.shadowCascadeOffset),e.shadowCascadeCount=this.shadowCascadeCount,e.shadowCascadeBias=this.shadowCascadeBias.slice(0),e.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),e.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),e.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),e.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),e},THREE.HemisphereLight=function(e,t,n){THREE.Light.call(this,e),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new THREE.Color(t),this.intensity=void 0!==n?n:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight,THREE.HemisphereLight.prototype.clone=function(){var e=new THREE.HemisphereLight;return THREE.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},THREE.PointLight=function(e,t,n,s){THREE.Light.call(this,e),this.type="PointLight",this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.decay=void 0!==s?s:1},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.constructor=THREE.PointLight,THREE.PointLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e.decay=this.decay,e},THREE.SpotLight=function(e,t,n,s,o,i){THREE.Light.call(this,e),this.type="SpotLight",this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.angle=void 0!==s?s:Math.PI/3,this.exponent=void 0!==o?o:10,this.decay=void 0!==i?i:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.constructor=THREE.SpotLight,THREE.SpotLight.prototype.clone=function(){var e=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.decay=this.decay,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraFov=this.shadowCameraFov,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e},THREE.Cache={files:{},add:function(e,t){this.files[e]=t},get:function(e){return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},THREE.Loader=function(e){this.showStatus=e,this.statusDomElement=e?THREE.Loader.prototype.addStatusElement():null,this.imageLoader=new THREE.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";t+=e.total?(100*e.loaded/e.total).toFixed(0)+"%":(e.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t){for(var s=[],n=0;n<e.length;++n)s[n]=this.createMaterial(e[n],t);return s},needsTangents:function(e){for(var n,t=0,s=e.length;s>t;t++)if(n=e[t],n instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(e,t){function c(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function s(e,n,s,o,i,a,r){var d,h,m=t+s,u=THREE.Loader.Handlers.get(m);(null!==u?d=u.load(m):(d=new THREE.Texture,u=l.imageLoader,u.crossOrigin=l.crossOrigin,u.load(m,function(e){if(THREE.Math.isPowerOfTwo(e.width)===!1||THREE.Math.isPowerOfTwo(e.height)===!1){var o,n=c(e.width),s=c(e.height),t=document.createElement("canvas");t.width=n,t.height=s,o=t.getContext("2d"),o.drawImage(e,0,0,n,s),d.image=t}else d.image=e;d.needsUpdate=!0})),d.sourceFile=s,o&&(d.repeat.set(o[0],o[1]),1!==o[0]&&(d.wrapS=THREE.RepeatWrapping),1!==o[1]&&(d.wrapT=THREE.RepeatWrapping)),i&&d.offset.set(i[0],i[1]),a)&&(h={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==h[a[0]]&&(d.wrapS=h[a[0]]),void 0!==h[a[1]]&&(d.wrapT=h[a[1]])),r&&(d.anisotropy=r),e[n]=d}function o(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var a,r,l=this,i="MeshLambertMaterial",n={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};return e.shading&&(a=e.shading.toLowerCase(),"phong"===a?i="MeshPhongMaterial":"basic"===a&&(i="MeshBasicMaterial")),void 0!==e.blending&&void 0!==THREE[e.blending]&&(n.blending=THREE[e.blending]),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.opacity&&e.opacity<1&&(n.transparent=!0),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.flipSided&&(n.side=THREE.BackSide),void 0!==e.doubleSided&&(n.side=THREE.DoubleSide),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?n.vertexColors=THREE.FaceColors:e.vertexColors&&(n.vertexColors=THREE.VertexColors)),e.colorDiffuse?n.color=o(e.colorDiffuse):e.DbgColor&&(n.color=e.DbgColor),e.colorSpecular&&(n.specular=o(e.colorSpecular)),e.colorEmissive&&(n.emissive=o(e.colorEmissive)),void 0!==e.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),e.opacity=e.transparency),void 0!==e.opacity&&(n.opacity=e.opacity),e.specularCoef&&(n.shininess=e.specularCoef),e.mapDiffuse&&t&&s(n,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&s(n,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&s(n,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&s(n,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&s(n,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapAlpha&&t&&s(n,"alphaMap",e.mapAlpha,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy),e.mapBumpScale&&(n.bumpScale=e.mapBumpScale),e.mapNormalFactor&&(n.normalScale=new THREE.Vector2(e.mapNormalFactor,e.mapNormalFactor)),r=new THREE[i](n),void 0!==e.DbgName&&(r.name=e.DbgName),r}},THREE.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var n,s,t=0,o=this.handlers.length;o>t;t+=2)if(n=this.handlers[t],s=this.handlers[t+1],n.test(e))return s;return null}},THREE.XHRLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(e,t,n,s){var o,i=this,a=THREE.Cache.get(e);if(void 0!==a)return void(t&&t(a));o=new XMLHttpRequest,o.open("GET",e,!0),o.addEventListener("load",function(){THREE.Cache.add(e,this.response),t&&t(this.response),i.manager.itemEnd(e)},!1),void 0!==n&&o.addEventListener("progress",function(e){n(e)},!1),void 0!==s&&o.addEventListener("error",function(e){s(e)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(o.responseType=this.responseType),o.send(null),i.manager.itemStart(e)},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.ImageLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(e,t,n,s){var o,i=this,a=THREE.Cache.get(e);return void 0!==a?void t(a):(o=document.createElement("img"),o.addEventListener("load",function(){THREE.Cache.add(e,this),t&&t(this),i.manager.itemEnd(e)},!1),void 0!==n&&o.addEventListener("progress",function(e){n(e)},!1),void 0!==s&&o.addEventListener("error",function(e){s(e)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.src=e,i.manager.itemStart(e),o)},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.JSONLoader=function(e){THREE.Loader.call(this,e),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.constructor=THREE.JSONLoader,THREE.JSONLoader.prototype.load=function(e,t,n){n=n&&"string"==typeof n?n:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,n)},THREE.JSONLoader.prototype.loadAjaxJSON=function(e,t,n,s,o){var i=new XMLHttpRequest,a=0;i.onreadystatechange=function(){if(i.readyState===i.DONE)if(200===i.status||0===i.status){if(i.responseText){var c,l=JSON.parse(i.responseText),r=l.metadata;if(void 0!==r){if("object"===r.type)return void THREE.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===r.type)return void THREE.error("THREE.JSONLoader: "+t+" seems to be a Scene. Use THREE.SceneLoader instead.")}c=e.parse(l,s),n(c.geometry,c.materials)}else THREE.error("THREE.JSONLoader: "+t+" seems to be unreachable or the file is empty.");e.onLoadComplete()}else THREE.error("THREE.JSONLoader: Couldn't load "+t+" ("+i.status+")");else i.readyState===i.LOADING?o&&(0===a&&(a=i.getResponseHeader("Content-Length")),o({total:a,loaded:i.responseText.length})):i.readyState===i.HEADERS_RECEIVED&&void 0!==o&&(a=i.getResponseHeader("Content-Length"))},i.open("GET",t,!0),i.withCredentials=this.withCredentials,i.send(null)},THREE.JSONLoader.prototype.parse=function(e,t){function i(t){function p(e,t){return e&1<<t}var s,o,a,c,l,d,u,h,m,f,g,v,b,j,y,_,w,x,C,E,S,M,F,T,z,D,N,i=e.faces,O=e.vertices,r=e.normals,k=e.colors,A=0;if(void 0!==e.uvs){for(s=0;s<e.uvs.length;s++)e.uvs[s].length&&A++;for(s=0;A>s;s++)n.faceVertexUvs[s]=[]}for(o=0,E=O.length;E>o;)j=new THREE.Vector3,j.x=O[o++]*t,j.y=O[o++]*t,j.z=O[o++]*t,n.vertices.push(j);for(o=0,E=i.length;E>o;)if(h=i[o++],N=p(h,0),M=p(h,1),F=p(h,3),T=p(h,4),z=p(h,5),S=p(h,6),D=p(h,7),N){if(c=new THREE.Face3,c.a=i[o],c.b=i[o+1],c.c=i[o+3],l=new THREE.Face3,l.a=i[o+1],l.b=i[o+2],l.c=i[o+3],o+=4,M&&(w=i[o++],c.materialIndex=w,l.materialIndex=w),m=n.faces.length,F)for(s=0;A>s;s++)for(g=e.uvs[s],n.faceVertexUvs[s][m]=[],n.faceVertexUvs[s][m+1]=[],f=0;4>f;f++)b=i[o++],x=g[2*b],C=g[2*b+1],_=new THREE.Vector2(x,C),2!==f&&n.faceVertexUvs[s][m].push(_),0!==f&&n.faceVertexUvs[s][m+1].push(_);if(T&&(a=3*i[o++],c.normal.set(r[a++],r[a++],r[a]),l.normal.copy(c.normal)),z)for(s=0;4>s;s++)a=3*i[o++],y=new THREE.Vector3(r[a++],r[a++],r[a]),2!==s&&c.vertexNormals.push(y),0!==s&&l.vertexNormals.push(y);if(S&&(u=i[o++],v=k[u],c.color.setHex(v),l.color.setHex(v)),D)for(s=0;4>s;s++)u=i[o++],v=k[u],2!==s&&c.vertexColors.push(new THREE.Color(v)),0!==s&&l.vertexColors.push(new THREE.Color(v));n.faces.push(c),n.faces.push(l)}else{if(d=new THREE.Face3,d.a=i[o++],d.b=i[o++],d.c=i[o++],M&&(w=i[o++],d.materialIndex=w),m=n.faces.length,F)for(s=0;A>s;s++)for(g=e.uvs[s],n.faceVertexUvs[s][m]=[],f=0;3>f;f++)b=i[o++],x=g[2*b],C=g[2*b+1],_=new THREE.Vector2(x,C),n.faceVertexUvs[s][m].push(_);if(T&&(a=3*i[o++],d.normal.set(r[a++],r[a++],r[a])),z)for(s=0;3>s;s++)a=3*i[o++],y=new THREE.Vector3(r[a++],r[a++],r[a]),d.vertexNormals.push(y);if(S&&(u=i[o++],d.color.setHex(k[u])),D)for(s=0;3>s;s++)u=i[o++],d.vertexColors.push(new THREE.Color(k[u]));n.faces.push(d)}}function a(){if(s=void 0!==e.influencesPerVertex?e.influencesPerVertex:2,e.skinWeights)for(t=0,o=e.skinWeights.length;o>t;t+=s){var t,s,o,i=e.skinWeights[t],a=s>1?e.skinWeights[t+1]:0,r=s>2?e.skinWeights[t+2]:0,c=s>3?e.skinWeights[t+3]:0;n.skinWeights.push(new THREE.Vector4(i,a,r,c))}if(e.skinIndices)for(t=0,o=e.skinIndices.length;o>t;t+=s){var l=e.skinIndices[t],d=s>1?e.skinIndices[t+1]:0,u=s>2?e.skinIndices[t+2]:0,h=s>3?e.skinIndices[t+3]:0;n.skinIndices.push(new THREE.Vector4(l,d,u,h))}n.bones=e.bones,n.bones&&n.bones.length>0&&(n.skinWeights.length!==n.skinIndices.length||n.skinIndices.length!==n.vertices.length)&&THREE.warn("THREE.JSONLoader: When skinning, number of vertices ("+n.vertices.length+"), skinIndices ("+n.skinIndices.length+"), and skinWeights ("+n.skinWeights.length+") should match."),n.animation=e.animation,n.animations=e.animations}function r(t){if(void 0!==e.morphTargets)for(s=0,a=e.morphTargets.length;a>s;s++)for(n.morphTargets[s]={},n.morphTargets[s].name=e.morphTargets[s].name,n.morphTargets[s].vertices=[],h=n.morphTargets[s].vertices,r=e.morphTargets[s].vertices,o=0,u=r.length;u>o;o+=3){var s,o,i,a,r,c,d,u,h,m,f,l=new THREE.Vector3;l.x=r[o]*t,l.y=r[o+1]*t,l.z=r[o+2]*t,h.push(l)}if(void 0!==e.morphColors)for(s=0,a=e.morphColors.length;a>s;s++)for(n.morphColors[s]={},n.morphColors[s].name=e.morphColors[s].name,n.morphColors[s].colors=[],f=n.morphColors[s].colors,c=e.morphColors[s].colors,i=0,m=c.length;m>i;i+=3)d=new THREE.Color(16755200),d.setRGB(c[i],c[i+1],c[i+2]),f.push(d)}var s,n=new THREE.Geometry,o=void 0!==e.scale?1/e.scale:1;return i(o),a(),r(o),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:n}:(s=this.initMaterials(e.materials,t),this.needsTangents(s)&&n.computeTangents(),{geometry:n,materials:s})},THREE.LoadingManager=function(e,t,n){var s=this,o=0,i=0;this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(){i++},this.itemEnd=function(e){o++,void 0!==s.onProgress&&s.onProgress(e,o,i),o===i&&void 0!==s.onLoad&&s.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(e,t,n,s){var o=this,i=new THREE.XHRLoader(o.manager);i.setCrossOrigin(this.crossOrigin),i.load(e,function(e){t(o.parse(JSON.parse(e)))},n,s)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t,s,o,i,r,c,n=new THREE.BufferGeometry,a=e.data.attributes;for(r in a)s=a[r],c=new self[s.type](s.array),n.addAttribute(r,new THREE.BufferAttribute(c,s.itemSize));return o=e.data.offsets,void 0!==o&&(n.offsets=JSON.parse(JSON.stringify(o))),t=e.data.boundingSphere,void 0!==t&&(i=new THREE.Vector3,void 0!==t.center&&i.fromArray(t.center),n.boundingSphere=new THREE.Sphere(i,t.radius)),n}},THREE.MaterialLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(e,t,n,s){var o=this,i=new THREE.XHRLoader(o.manager);i.setCrossOrigin(this.crossOrigin),i.load(e,function(e){t(o.parse(JSON.parse(e)))},n,s)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){if(t=new THREE[e.type],void 0!==e.color&&t.color.setHex(e.color),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.shading&&(t.shading=e.shading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.materials)for(var t,n=0,s=e.materials.length;s>n;n++)t.materials.push(this.parse(e.materials[n]));return t}},THREE.ObjectLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.texturePath=""},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(e,t,n,s){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var o=this,i=new THREE.XHRLoader(o.manager);i.setCrossOrigin(this.crossOrigin),i.load(e,function(e){o.parse(JSON.parse(e),t)},n,s)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var s=this.parseGeometries(e.geometries),o=this.parseImages(e.images,function(){void 0!==t&&t(n)}),i=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,i),n=this.parseObject(e.object,s,a);return(void 0===e.images||0===e.images.length)&&void 0!==t&&t(n),n},parseGeometries:function(e){if(s={},void 0!==e)for(var t,n,s,i=new THREE.JSONLoader,a=new THREE.BufferGeometryLoader,o=0,r=e.length;r>o;o++){switch(t=e[o],t.type){case"PlaneGeometry":case"PlaneBufferGeometry":n=new THREE[t.type](t.width,t.height,t.widthSegments,t.heightSegments);break;case"BoxGeometry":case"CubeGeometry":n=new THREE.BoxGeometry(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments);break;case"CircleGeometry":n=new THREE.CircleGeometry(t.radius,t.segments);break;case"CylinderGeometry":n=new THREE.CylinderGeometry(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded);break;case"SphereGeometry":n=new THREE.SphereGeometry(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength);break;case"IcosahedronGeometry":n=new THREE.IcosahedronGeometry(t.radius,t.detail);break;case"TorusGeometry":n=new THREE.TorusGeometry(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc);break;case"TorusKnotGeometry":n=new THREE.TorusKnotGeometry(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.p,t.q,t.heightScale);break;case"BufferGeometry":n=a.parse(t);break;case"Geometry":n=i.parse(t.data).geometry}n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),s[t.uuid]=n}return s},parseMaterials:function(e,t){if(i={},void 0!==e)for(var n,s,i,o=function(e){return void 0===t[e]&&THREE.warn("THREE.ObjectLoader: Undefined texture",e),t[e]},r=new THREE.MaterialLoader,a=0,c=e.length;c>a;a++)n=e[a],s=r.parse(n),s.uuid=n.uuid,void 0!==n.name&&(s.name=n.name),void 0!==n.map&&(s.map=o(n.map)),void 0!==n.bumpMap&&(s.bumpMap=o(n.bumpMap),n.bumpScale&&(s.bumpScale=new THREE.Vector2(n.bumpScale,n.bumpScale))),void 0!==n.alphaMap&&(s.alphaMap=o(n.alphaMap)),void 0!==n.envMap&&(s.envMap=o(n.envMap)),void 0!==n.normalMap&&(s.normalMap=o(n.normalMap),n.normalScale&&(s.normalScale=new THREE.Vector2(n.normalScale,n.normalScale))),void 0!==n.lightMap&&(s.lightMap=o(n.lightMap)),void 0!==n.specularMap&&(s.specularMap=o(n.specularMap)),i[n.uuid]=s;return i},parseImages:function(e,t){if(s=this,o={},void 0!==e&&e.length>0){r=new THREE.LoadingManager(t),i=new THREE.ImageLoader(r),i.setCrossOrigin(this.crossOrigin);for(var n,s,o,i,r,c,l=function(e){return s.manager.itemStart(e),i.load(e,function(){s.manager.itemEnd(e)})},a=0,d=e.length;d>a;a++)n=e[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n.url)?n.url:s.texturePath+n.url,o[n.uuid]=l(c)}return o},parseTextures:function(e,t){if(o={},void 0!==e)for(var n,s,o,i=0,a=e.length;a>i;i++)n=e[i],void 0===n.image&&THREE.warn('THREE.ObjectLoader: No "image" speficied for',n.uuid),void 0===t[n.image]&&THREE.warn("THREE.ObjectLoader: Undefined image",n.image),s=new THREE.Texture(t[n.image]),s.needsUpdate=!0,s.uuid=n.uuid,void 0!==n.name&&(s.name=n.name),void 0!==n.repeat&&(s.repeat=new THREE.Vector2(n.repeat[0],n.repeat[1])),void 0!==n.minFilter&&(s.minFilter=THREE[n.minFilter]),void 0!==n.magFilter&&(s.magFilter=THREE[n.magFilter]),void 0!==n.anisotropy&&(s.anisotropy=n.anisotropy),n.wrap instanceof Array&&(s.wrapS=THREE[n.wrap[0]],s.wrapT=THREE[n.wrap[1]]),o[n.uuid]=s;return o},parseObject:function(){var e=new THREE.Matrix4;return function(t,n,s){var o,r,a=function(e){return void 0===n[e]&&THREE.warn("THREE.ObjectLoader: Undefined geometry",e),n[e]},i=function(e){return void 0===s[e]&&THREE.warn("THREE.ObjectLoader: Undefined material",e),s[e]};switch(t.type){case"Scene":o=new THREE.Scene;break;case"PerspectiveCamera":o=new THREE.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":o=new THREE.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":o=new THREE.AmbientLight(t.color);break;case"DirectionalLight":o=new THREE.DirectionalLight(t.color,t.intensity);break;case"PointLight":o=new THREE.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":o=new THREE.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent,t.decay);break;case"HemisphereLight":o=new THREE.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":o=new THREE.Mesh(a(t.geometry),i(t.material));break;case"Line":o=new THREE.Line(a(t.geometry),i(t.material),t.mode);break;case"PointCloud":o=new THREE.PointCloud(a(t.geometry),i(t.material));break;case"Sprite":o=new THREE.Sprite(i(t.material));break;case"Group":o=new THREE.Group;break;default:o=new THREE.Object3D}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.children)for(r in t.children)o.add(this.parseObject(t.children[r],n,s));return o}}()},THREE.TextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,t,n,s){var i=this,o=new THREE.ImageLoader(i.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,function(e){var n=new THREE.Texture(e);n.needsUpdate=!0,void 0!==t&&t(n)},n,s)},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(){this._parser=null},THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(e,t,n,s){var a=this,o=new THREE.DataTexture,i=new THREE.XHRLoader;return i.setResponseType("arraybuffer"),i.load(e,function(e){var n=a._parser(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:THREE.ClampToEdgeWrapping,o.wrapT=void 0!==n.wrapT?n.wrapT:THREE.ClampToEdgeWrapping,o.magFilter=void 0!==n.magFilter?n.magFilter:THREE.LinearFilter,o.minFilter=void 0!==n.minFilter?n.minFilter:THREE.LinearMipMapLinearFilter,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.needsUpdate=!0,t&&t(o,n))},n,s),o}},THREE.CompressedTextureLoader=function(){this._parser=null},THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(e,t){var r=this,o=[],s=new THREE.CompressedTexture;if(s.image=o,i=new THREE.XHRLoader,i.setResponseType("arraybuffer"),e instanceof Array)for(var i,c=0,l=function(n){i.load(e[n],function(e){var i=r._parser(e,!0);o[n]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},c+=1,6===c&&(1==i.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=i.format,s.needsUpdate=!0,t&&t(s))})},a=0,d=e.length;d>a;++a)l(a);else i.load(e,function(e){if(n=r._parser(e,!0),n.isCubemap)for(var n,a,c=n.mipmaps.length/n.mipmapCount,i=0;c>i;i++){o[i]={mipmaps:[]};for(a=0;a<n.mipmapCount;a++)o[i].mipmaps.push(n.mipmaps[i*n.mipmapCount+a]),o[i].format=n.format,o[i].width=n.width,o[i].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=n.format,s.needsUpdate=!0,t&&t(s)});return s}},THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Material",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){e===!0&&this.update(),this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(t in e){var t,s,n=e[t];void 0!==n?t in this&&(s=this[t],s instanceof THREE.Color?s.set(n):s instanceof THREE.Vector3&&n instanceof THREE.Vector3?s.copy(n):"overdraw"==t?this[t]=Number(n):this[t]=n):THREE.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(e.name=this.name),this instanceof THREE.MeshBasicMaterial?(e.color=this.color.getHex(),this.vertexColors!==THREE.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(e.blending=this.blending),this.side!==THREE.FrontSide&&(e.side=this.side)):this instanceof THREE.MeshLambertMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),this.vertexColors!==THREE.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==THREE.SmoothShading&&(e.shading=this.shading),this.blending!==THREE.NormalBlending&&(e.blending=this.blending),this.side!==THREE.FrontSide&&(e.side=this.side)):this instanceof THREE.MeshPhongMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),e.specular=this.specular.getHex(),e.shininess=this.shininess,this.vertexColors!==THREE.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==THREE.SmoothShading&&(e.shading=this.shading),this.blending!==THREE.NormalBlending&&(e.blending=this.blending),this.side!==THREE.FrontSide&&(e.side=this.side)):this instanceof THREE.MeshNormalMaterial?(this.blending!==THREE.NormalBlending&&(e.blending=this.blending),this.side!==THREE.FrontSide&&(e.side=this.side)):this instanceof THREE.MeshDepthMaterial?(this.blending!==THREE.NormalBlending&&(e.blending=this.blending),this.side!==THREE.FrontSide&&(e.side=this.side)):this instanceof THREE.PointCloudMaterial?(e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.color=this.color.getHex(),this.vertexColors!==THREE.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(e.blending=this.blending)):this instanceof THREE.ShaderMaterial?(e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader):this instanceof THREE.SpriteMaterial&&(e.color=this.color.getHex()),this.opacity<1&&(e.opacity=this.opacity),this.transparent!==!1&&(e.transparent=this.transparent),this.wireframe!==!1&&(e.wireframe=this.wireframe),e},clone:function(e){return void 0===e&&(e=new THREE.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.blendSrcAlpha=this.blendSrcAlpha,e.blendDstAlpha=this.blendDstAlpha,e.blendEquationAlpha=this.blendEquationAlpha,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(e){THREE.Material.call(this),this.type="LineBasicMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(e)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.LineBasicMaterial.prototype.clone=function(){var e=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.LineDashedMaterial=function(e){THREE.Material.call(this),this.type="LineDashedMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial,THREE.LineDashedMaterial.prototype.clone=function(){var e=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.MeshBasicMaterial=function(e){THREE.Material.call(this),this.type="MeshBasicMaterial",this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshBasicMaterial.prototype.clone=function(){var e=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},THREE.MeshLambertMaterial=function(e){THREE.Material.call(this),this.type="MeshLambertMaterial",this.color=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshLambertMaterial.prototype.clone=function(){var e=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshPhongMaterial=function(e){THREE.Material.call(this),this.type="MeshPhongMaterial",this.color=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshPhongMaterial.prototype.clone=function(){var e=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshDepthMaterial=function(e){THREE.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshDepthMaterial.prototype.clone=function(){var e=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshNormalMaterial.prototype.clone=function(){var e=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshFaceMaterial=function(e){this.uuid=THREE.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=e instanceof Array?e:[]},THREE.MeshFaceMaterial.prototype={constructor:THREE.MeshFaceMaterial,toJSON:function(){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},e=0,n=this.materials.length;n>e;e++)t.materials.push(this.materials[e].toJSON());return t},clone:function(){for(var t=new THREE.MeshFaceMaterial,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t}},THREE.PointCloudMaterial=function(e){THREE.Material.call(this),this.type="PointCloudMaterial",this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(e)},THREE.PointCloudMaterial.prototype=Object.create(THREE.Material.prototype),THREE.PointCloudMaterial.prototype.constructor=THREE.PointCloudMaterial,THREE.PointCloudMaterial.prototype.clone=function(){var e=new THREE.PointCloudMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.ParticleBasicMaterial=function(e){return THREE.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new THREE.PointCloudMaterial(e)},THREE.ParticleSystemMaterial=function(e){return THREE.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new THREE.PointCloudMaterial(e)},THREE.ShaderMaterial=function(e){THREE.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(e)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.ShaderMaterial.prototype.clone=function(){var e=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=THREE.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.RawShaderMaterial=function(e){THREE.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial,THREE.RawShaderMaterial.prototype.clone=function(){var e=new THREE.RawShaderMaterial;return THREE.ShaderMaterial.prototype.clone.call(this,e),e},THREE.SpriteMaterial=function(e){THREE.Material.call(this),this.type="SpriteMaterial",this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial,THREE.SpriteMaterial.prototype.clone=function(){var e=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.rotation=this.rotation,e.fog=this.fog,e},THREE.Texture=function(e,t,n,s,o,i,a,r,c){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:THREE.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:THREE.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==s?s:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==o?o:THREE.LinearFilter,this.minFilter=void 0!==i?i:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==r?r:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},THREE.Texture.DEFAULT_IMAGE=void 0,THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping,THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){e===!0&&this.update(),this._needsUpdate=e},clone:function(e){return void 0===e&&(e=new THREE.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CubeTexture=function(e,t,n,s,o,i,a,r,c){t=void 0!==t?t:THREE.CubeReflectionMapping,THREE.Texture.call(this,e,t,n,s,o,i,a,r,c),this.images=e},THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CubeTexture.prototype.constructor=THREE.CubeTexture,THREE.CubeTexture.clone=function(e){return void 0===e&&(e=new THREE.CubeTexture),THREE.Texture.prototype.clone.call(this,e),e.images=this.images,e},THREE.CompressedTexture=function(e,t,n,s,o,i,a,r,c,l,d){THREE.Texture.call(this,null,i,a,r,c,l,s,o,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture,THREE.CompressedTexture.prototype.clone=function(){var e=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.DataTexture=function(e,t,n,s,o,i,a,r,c,l,d){THREE.Texture.call(this,null,i,a,r,c,l,s,o,d),this.image={data:e,width:t,height:n}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.VideoTexture=function(e,t,n,s,o,i,a,r,c){THREE.Texture.call(this,e,t,n,s,o,i,a,r,c),this.generateMipmaps=!1;var d=this,l=function(){requestAnimationFrame(l),e.readyState===e.HAVE_ENOUGH_DATA&&(d.needsUpdate=!0)};l()},THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype),THREE.VideoTexture.prototype.constructor=THREE.VideoTexture,THREE.Group=function(){THREE.Object3D.call(this),this.type="Group"},THREE.Group.prototype=Object.create(THREE.Object3D.prototype),THREE.Group.prototype.constructor=THREE.Group,THREE.PointCloud=function(e,t){THREE.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.PointCloudMaterial({color:16777215*Math.random()})},THREE.PointCloud.prototype=Object.create(THREE.Object3D.prototype),THREE.PointCloud.prototype.constructor=THREE.PointCloud,THREE.PointCloud.prototype.raycast=function(){var t=new THREE.Matrix4,e=new THREE.Ray;return function(n,s){var p=this,c=p.geometry,x=n.params.PointCloud.threshold;if(t.getInverse(this.matrixWorld),e.copy(n.ray).applyMatrix4(t),null===c.boundingBox||e.isIntersectionBox(c.boundingBox)!==!1){var O=x/((this.scale.x+this.scale.y+this.scale.z)/3),l=new THREE.Vector3,m=function(t,o){var i,r,a=e.distanceToPoint(t);O>a&&(i=e.closestPointToPoint(t),i.applyMatrix4(p.matrixWorld),r=n.ray.origin.distanceTo(i),s.push({distance:r,distanceToRay:a,point:i.clone(),index:o,face:null,object:p}))};if(c instanceof THREE.BufferGeometry)if(d=c.attributes,a=d.position.array,void 0!==d.index){f=d.index.array,i=c.offsets,0===i.length&&(g={start:0,count:f.length,index:0},i=[g]);for(r=0,b=i.length;b>r;++r)for(var i,a,r,d,u,h,f,g,b,j,v=i[r].start,y=i[r].count,_=i[r].index,o=v,w=v+y;w>o;o++)h=_+f[o],l.fromArray(a,3*h),m(l,h)}else for(j=a.length/3,o=0;j>o;o++)l.set(a[3*o],a[3*o+1],a[3*o+2]),m(l,o);else for(u=this.geometry.vertices,o=0;o<u.length;o++)m(u[o],o)}}}(),THREE.PointCloud.prototype.clone=function(e){return void 0===e&&(e=new THREE.PointCloud(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.ParticleSystem=function(e,t){return THREE.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new THREE.PointCloud(e,t)},THREE.Line=function(e,t,n){THREE.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==n?n:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.constructor=THREE.Line,THREE.Line.prototype.raycast=function(){var n=new THREE.Matrix4,e=new THREE.Ray,t=new THREE.Sphere;return function(s,o){var C=s.linePrecision,y=C*C,r=this.geometry;if(null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere),t.applyMatrix4(this.matrixWorld),s.ray.isIntersectionSphere(t)!==!1){n.getInverse(this.matrixWorld),e.copy(s.ray).applyMatrix4(n);var i,a,c,l,h,f,_,w,p=new THREE.Vector3,g=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3,v=this.mode===THREE.LineStrip?1:2;if(r instanceof THREE.BufferGeometry)if(f=r.attributes,void 0!==f.index){var b=f.index.array,c=f.position.array,u=r.offsets;0===u.length&&(u=[{start:0,count:b.length,index:0}]);for(l=0;l<u.length;l++)for(var x=u[l].start,E=u[l].count,O=u[l].index,i=x;x+E-1>i;i+=v)w=O+b[i],_=O+b[i+1],p.fromArray(c,3*w),g.fromArray(c,3*_),h=e.distanceSqToSegment(p,g,m,d),h>y||(a=e.origin.distanceTo(m),a<s.near||a>s.far||o.push({distance:a,point:d.clone().applyMatrix4(this.matrixWorld),index:i,offsetIndex:l,face:null,faceIndex:null,object:this}))}else for(c=f.position.array,i=0;i<c.length/3-1;i+=v)p.fromArray(c,3*i),g.fromArray(c,3*i+3),h=e.distanceSqToSegment(p,g,m,d),h>y||(a=e.origin.distanceTo(m),a<s.near||a>s.far||o.push({distance:a,point:d.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}));else if(r instanceof THREE.Geometry)for(var j=r.vertices,k=j.length,i=0;k-1>i;i+=v)h=e.distanceSqToSegment(j[i],j[i+1],m,d),h>y||(a=e.origin.distanceTo(m),a<s.near||a>s.far||o.push({distance:a,point:d.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}}}(),THREE.Line.prototype.clone=function(e){return void 0===e&&(e=new THREE.Line(this.geometry,this.material,this.mode)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Mesh=function(e,t){THREE.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(THREE.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.raycast=function(){var i=new THREE.Matrix4,s=new THREE.Ray,o=new THREE.Sphere,e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(a,r){if(f=this.geometry,null===f.boundingSphere&&f.computeBoundingSphere(),o.copy(f.boundingSphere),o.applyMatrix4(this.matrixWorld),a.ray.isIntersectionSphere(o)!==!1&&(i.getInverse(this.matrixWorld),s.copy(a.ray).applyMatrix4(i),null===f.boundingBox||s.isIntersectionBox(f.boundingBox)!==!1))if(f instanceof THREE.BufferGeometry){if(g=this.material,void 0===g)return;if(O=f.attributes,E=a.precision,void 0!==O.index){var C=O.index.array,j=O.position.array,_=f.offsets;0===_.length&&(_=[{start:0,count:C.length,index:0}]);for(y=0,L=_.length;L>y;++y)for(var N=_[y].start,H=_[y].count,M=_[y].index,v=N,A=N+H;A>v;v+=3)u=M+C[v],h=M+C[v+1],m=M+C[v+2],e.fromArray(j,3*u),t.fromArray(j,3*h),n.fromArray(j,3*m),g.side===THREE.BackSide?(c=s.intersectTriangle(n,t,e,!0)):(c=s.intersectTriangle(e,t,n,g.side!==THREE.DoubleSide)),null!==c&&(c.applyMatrix4(this.matrixWorld),l=a.ray.origin.distanceTo(c),E>l||l<a.near||l>a.far||r.push({distance:l,point:c,face:new THREE.Face3(u,h,m,THREE.Triangle.normal(e,t,n)),faceIndex:null,object:this}))}else for(var j=O.position.array,v=0,k=0,A=j.length;A>v;v+=3,k+=9)u=v,h=v+1,m=v+2,e.fromArray(j,k),t.fromArray(j,k+3),n.fromArray(j,k+6),g.side===THREE.BackSide?(c=s.intersectTriangle(n,t,e,!0)):(c=s.intersectTriangle(e,t,n,g.side!==THREE.DoubleSide)),null!==c&&(c.applyMatrix4(this.matrixWorld),l=a.ray.origin.distanceTo(c),E>l||l<a.near||l>a.far||r.push({distance:l,point:c,face:new THREE.Face3(u,h,m,THREE.Triangle.normal(e,t,n)),faceIndex:null,object:this}))}else if(f instanceof THREE.Geometry)for(var c,l,d,u,h,m,f,p,g,b,y,w,O,F,z,D,L,T=this.material instanceof THREE.MeshFaceMaterial,R=T===!0?this.material.materials:null,E=a.precision,S=f.vertices,x=0,P=f.faces.length;P>x;x++)if(d=f.faces[x],g=T===!0?R[d.materialIndex]:this.material,void 0!==g){if(u=S[d.a],h=S[d.b],m=S[d.c],g.morphTargets===!0){F=f.morphTargets,z=this.morphTargetInfluences,e.set(0,0,0),t.set(0,0,0),n.set(0,0,0);for(w=0,D=F.length;D>w;w++)p=z[w],0!==p&&(b=F[w].vertices,e.x+=(b[d.a].x-u.x)*p,e.y+=(b[d.a].y-u.y)*p,e.z+=(b[d.a].z-u.z)*p,t.x+=(b[d.b].x-h.x)*p,t.y+=(b[d.b].y-h.y)*p,t.z+=(b[d.b].z-h.z)*p,n.x+=(b[d.c].x-m.x)*p,n.y+=(b[d.c].y-m.y)*p,n.z+=(b[d.c].z-m.z)*p);e.add(u),t.add(h),n.add(m),u=e,h=t,m=n}g.side===THREE.BackSide?(c=s.intersectTriangle(m,h,u,!0)):(c=s.intersectTriangle(u,h,m,g.side!==THREE.DoubleSide)),null!==c&&(c.applyMatrix4(this.matrixWorld),l=a.ray.origin.distanceTo(c),E>l||l<a.near||l>a.far||r.push({distance:l,point:c,face:d,faceIndex:x,object:this}))}}}(),THREE.Mesh.prototype.clone=function(e,t){return void 0===e&&(e=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e,t),e},THREE.Bone=function(e){THREE.Object3D.call(this),this.type="Bone",this.skin=e},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.constructor=THREE.Bone,THREE.Skeleton=function(e,t,n){if(this.useVertexTexture=void 0===n||n,this.identityMatrix=new THREE.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture?(s=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=s,this.boneTextureHeight=s,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{THREE.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var s,o=0,i=this.bones.length;i>o;o++)this.boneInverses.push(new THREE.Matrix4)}},THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t,e=0,n=this.bones.length;n>e;e++)t=new THREE.Matrix4,this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)},THREE.Skeleton.prototype.pose=function(){for(var e,t=0,n=this.bones.length;n>t;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;n>t;t++)e=this.bones[t],e&&(e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},THREE.Skeleton.prototype.update=function(){var e=new THREE.Matrix4;return function(){for(var n,t=0,s=this.bones.length;s>t;t++)n=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix,e.multiplyMatrices(n,this.boneInverses[t]),e.flattenToArrayOffset(this.boneMatrices,16*t);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.SkinnedMesh=function(e,t,n){if(THREE.Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new THREE.Matrix4,this.bindMatrixInverse=new THREE.Matrix4,a=[],this.geometry&&void 0!==this.geometry.bones){for(var o,i,a,r,c,l,s=0,d=this.geometry.bones.length;d>s;++s)o=this.geometry.bones[s],l=o.pos,r=o.rotq,c=o.scl,i=new THREE.Bone(this),a.push(i),i.name=o.name,i.position.set(l[0],l[1],l[2]),i.quaternion.set(r[0],r[1],r[2],r[3]),void 0!==c?i.scale.set(c[0],c[1],c[2]):i.scale.set(1,1,1);for(s=0,d=this.geometry.bones.length;d>s;++s)o=this.geometry.bones[s],-1!==o.parent?a[o.parent].add(a[s]):this.add(a[s])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new THREE.Skeleton(a,void 0,n))},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh,THREE.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(e=0;e<this.geometry.skinIndices.length;e++){var e,t=this.geometry.skinWeights[e],n=1/t.lengthManhattan();n!==1/0?t.multiplyScalar(n):t.set(1)}},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):THREE.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},THREE.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,e),e},THREE.MorphAnimMesh=function(e,t){THREE.Mesh.call(this,e,t),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.constructor=THREE.MorphAnimMesh,THREE.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){e=this.geometry,e.animations||(e.animations={});for(var e,n,s,o,i,r,a=e.animations,c=/([a-z]+)_?(\d+)/,t=0,l=e.morphTargets.length;l>t;t++)r=e.morphTargets[t],o=r.name.match(c),o&&o.length>1&&(n=o[1],a[n]||(a[n]={start:1/0,end:-(1/0)}),s=a[n],t<s.start&&(s.start=t),t>s.end&&(s.end=t),i||(i=n));e.firstAnimation=i},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,n){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:n}},THREE.MorphAnimMesh.prototype.playAnimation=function(e,t){var n=this.geometry.animations[e];n?(this.setFrameRange(n.start,n.end),this.duration=1e3*((n.end-n.start)/t),this.time=0):THREE.warn("THREE.MorphAnimMesh: animation["+e+"] undefined in .playAnimation()")},THREE.MorphAnimMesh.prototype.updateAnimation=function(e){var t,n,s=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration)),n=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/s),0,this.length-1),n!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[n]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=n),t=this.time%s/s,this.directionBackwards&&(t=1-t),this.morphTargetInfluences[this.currentKeyframe]=t,this.morphTargetInfluences[this.lastKeyframe]=1-t},THREE.MorphAnimMesh.prototype.interpolateTargets=function(e,t,n){for(var s=this.morphTargetInfluences,o=0,i=s.length;i>o;o++)s[o]=0;e>-1&&(s[e]=1-n),t>-1&&(s[t]=n)},THREE.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,e),e},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=0;n<this.objects.length&&!(t<this.objects[n].distance);n++);this.objects.splice(n,0,{distance:t,object:e}),this.add(e)},THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=1,n=this.objects.length;n>t&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},THREE.LOD.prototype.raycast=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixPosition(this.matrixWorld);var s=t.ray.origin.distanceTo(e);this.getObjectForDistance(s).raycast(t,n)}}(),THREE.LOD.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n){if(this.objects.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld),o=e.distanceTo(t),this.objects[0].object.visible=!0;for(var o,s=1,i=this.objects.length;i>s&&o>=this.objects[s].distance;s++)this.objects[s-1].object.visible=!1,this.objects[s].object.visible=!0;for(;i>s;s++)this.objects[s].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(e){void 0===e&&(e=new THREE.LOD),THREE.Object3D.prototype.clone.call(this,e);for(var n,t=0,s=this.objects.length;s>t;t++)n=this.objects[t].object.clone(),n.visible=0===t,e.addLevel(n,this.objects[t].distance);return e},THREE.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),n=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),s=new Float32Array([0,0,1,0,1,1,0,1]),e=new THREE.BufferGeometry;return e.addAttribute("index",new THREE.BufferAttribute(t,1)),e.addAttribute("position",new THREE.BufferAttribute(n,3)),e.addAttribute("uv",new THREE.BufferAttribute(s,2)),function(t){THREE.Object3D.call(this),this.type="Sprite",this.geometry=e,this.material=void 0!==t?t:new THREE.SpriteMaterial}}(),THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.raycast=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixPosition(this.matrixWorld);var s=t.ray.distanceToPoint(e);s>this.scale.x||n.push({distance:s,point:this.position,face:null,object:this})}}(),THREE.Sprite.prototype.clone=function(e){return void 0===e&&(e=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Particle=THREE.Sprite,THREE.LensFlare=function(e,t,n,s,o){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,n,s,o)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.constructor=THREE.LensFlare,THREE.LensFlare.prototype.add=function(e,t,n,s,o,i){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===i&&(i=1),void 0===o&&(o=new THREE.Color(16777215)),void 0===s&&(s=THREE.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:i,color:o,blending:s})},THREE.LensFlare.prototype.updateLensFlares=function(){var e,t,n=this.lensFlares.length,s=2*-this.positionScreen.x,o=2*-this.positionScreen.y;for(t=0;n>t;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+s*e.distance,e.y=this.positionScreen.y+o*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},THREE.Scene=function(){THREE.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.clone=function(e){return void 0===e&&(e=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},THREE.Fog=function(e,t,n){this.name="",this.color=new THREE.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(e,t){this.name="",this.color=new THREE.Color(e),this.density=void 0!==t?t:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.ShaderChunk={},THREE.ShaderChunk.common=`#define PI 3.14159
#define PI2 6.28318
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6

float square( in float a ) { return a*a; }
vec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }
vec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }
vec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }
float saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }
vec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }
vec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }
vec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }
float average( in float a ) { return a; }
float average( in vec2 a )  { return ( a.x + a.y) * 0.5; }
float average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }
float average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }
float whiteCompliment( in float a ) { return saturate( 1.0 - a ); }
vec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }
vec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }
vec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }
vec3 transformDirection( in vec3 normal, in mat4 matrix ) {
	return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );
}
// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations
vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {
	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {
	float distance = dot( planeNormal, point-pointOnPlane );
	return point - distance * planeNormal;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );
}
float calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {
	if ( decayExponent > 0.0 ) {
	  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );
	}
	return 1.0;
}

vec3 inputToLinear( in vec3 a ) {
#ifdef GAMMA_INPUT
	return pow( a, vec3( float( GAMMA_FACTOR ) ) );
#else
	return a;
#endif
}
vec3 linearToOutput( in vec3 a ) {
#ifdef GAMMA_OUTPUT
	return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );
#else
	return a;
#endif
}
`,THREE.ShaderChunk.alphatest_fragment=`#ifdef ALPHATEST

	if ( diffuseColor.a < ALPHATEST ) discard;

#endif
`,THREE.ShaderChunk.lights_lambert_vertex=`vLightFront = vec3( 0.0 );

#ifdef DOUBLE_SIDED

	vLightBack = vec3( 0.0 );

#endif

transformedNormal = normalize( transformedNormal );

#if MAX_DIR_LIGHTS > 0

for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {

	vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );

	float dotProduct = dot( transformedNormal, dirVector );
	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

	#ifdef DOUBLE_SIDED

		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

		#ifdef WRAP_AROUND

			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );

		#endif

	#endif

	#ifdef WRAP_AROUND

		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );
		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );

		#ifdef DOUBLE_SIDED

			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );

		#endif

	#endif

	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;

	#ifdef DOUBLE_SIDED

		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;

	#endif

}

#endif

#if MAX_POINT_LIGHTS > 0

	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {

		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );
		vec3 lVector = lPosition.xyz - mvPosition.xyz;

		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );

		lVector = normalize( lVector );
		float dotProduct = dot( transformedNormal, lVector );

		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );

		#ifdef DOUBLE_SIDED

			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

			#ifdef WRAP_AROUND

				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );

			#endif

		#endif

		#ifdef WRAP_AROUND

			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );
			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );

			#ifdef DOUBLE_SIDED

				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );

			#endif

		#endif

		vLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;

		#ifdef DOUBLE_SIDED

			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;

		#endif

	}

#endif

#if MAX_SPOT_LIGHTS > 0

	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {

		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );
		vec3 lVector = lPosition.xyz - mvPosition.xyz;

		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );

		if ( spotEffect > spotLightAngleCos[ i ] ) {

			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );

			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );

			lVector = normalize( lVector );

			float dotProduct = dot( transformedNormal, lVector );
			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );

			#ifdef DOUBLE_SIDED

				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

				#ifdef WRAP_AROUND

					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );

				#endif

			#endif

			#ifdef WRAP_AROUND

				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );
				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );

				#ifdef DOUBLE_SIDED

					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );

				#endif

			#endif

			vLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;

			#ifdef DOUBLE_SIDED

				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;

			#endif

		}

	}

#endif

#if MAX_HEMI_LIGHTS > 0

	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {

		vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );

		float dotProduct = dot( transformedNormal, lVector );

		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;
		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;

		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );

		#ifdef DOUBLE_SIDED

			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );

		#endif

	}

#endif

vLightFront += ambientLightColor;

#ifdef DOUBLE_SIDED

	vLightBack += ambientLightColor;

#endif
`,THREE.ShaderChunk.map_particle_pars_fragment=`#ifdef USE_MAP

	uniform vec4 offsetRepeat;
	uniform sampler2D map;

#endif
`,THREE.ShaderChunk.default_vertex=`#ifdef USE_SKINNING

	vec4 mvPosition = modelViewMatrix * skinned;

#elif defined( USE_MORPHTARGETS )

	vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );

#else

	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

#endif

gl_Position = projectionMatrix * mvPosition;
`,THREE.ShaderChunk.map_pars_fragment=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )

	varying vec2 vUv;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif`,THREE.ShaderChunk.skinnormal_vertex=`#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;

	#ifdef USE_MORPHNORMALS

	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );

	#else

	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );

	#endif

#endif
`,THREE.ShaderChunk.logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;

	#endif

	uniform float logDepthBufFC;

#endif`,THREE.ShaderChunk.lightmap_pars_vertex=`#ifdef USE_LIGHTMAP

	varying vec2 vUv2;

#endif`,THREE.ShaderChunk.lights_phong_fragment=`#ifndef FLAT_SHADED

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );

	#endif

#else

	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );

#endif

vec3 viewPosition = normalize( vViewPosition );

#ifdef USE_NORMALMAP

	normal = perturbNormal2Arb( -vViewPosition, normal );

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );

#endif

vec3 totalDiffuseLight = vec3( 0.0 );
vec3 totalSpecularLight = vec3( 0.0 );

#if MAX_POINT_LIGHTS > 0

	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {

		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );
		vec3 lVector = lPosition.xyz + vViewPosition.xyz;

		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );

		lVector = normalize( lVector );

		// diffuse

		float dotProduct = dot( normal, lVector );

		#ifdef WRAP_AROUND

			float pointDiffuseWeightFull = max( dotProduct, 0.0 );
			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );

			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );

		#else

			float pointDiffuseWeight = max( dotProduct, 0.0 );

		#endif

		totalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;

				// specular

		vec3 pointHalfVector = normalize( lVector + viewPosition );
		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );
		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );

		float specularNormalization = ( shininess + 2.0 ) / 8.0;

		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );
		totalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;

	}

#endif

#if MAX_SPOT_LIGHTS > 0

	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {

		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );
		vec3 lVector = lPosition.xyz + vViewPosition.xyz;

		float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );

		lVector = normalize( lVector );

		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );

		if ( spotEffect > spotLightAngleCos[ i ] ) {

			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );

			// diffuse

			float dotProduct = dot( normal, lVector );

			#ifdef WRAP_AROUND

				float spotDiffuseWeightFull = max( dotProduct, 0.0 );
				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );

				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );

			#else

				float spotDiffuseWeight = max( dotProduct, 0.0 );

			#endif

			totalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;

			// specular

			vec3 spotHalfVector = normalize( lVector + viewPosition );
			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );
			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );

			float specularNormalization = ( shininess + 2.0 ) / 8.0;

			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );
			totalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;

		}

	}

#endif

#if MAX_DIR_LIGHTS > 0

	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {

		vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );

		// diffuse

		float dotProduct = dot( normal, dirVector );

		#ifdef WRAP_AROUND

			float dirDiffuseWeightFull = max( dotProduct, 0.0 );
			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );

			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );

		#else

			float dirDiffuseWeight = max( dotProduct, 0.0 );

		#endif

		totalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;

		// specular

		vec3 dirHalfVector = normalize( dirVector + viewPosition );
		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );
		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );

		/*
		// fresnel term from skin shader
		const float F0 = 0.128;

		float base = 1.0 - dot( viewPosition, dirHalfVector );
		float exponential = pow( base, 5.0 );

		float fresnel = exponential + F0 * ( 1.0 - exponential );
		*/

		/*
		// fresnel term from fresnel shader
		const float mFresnelBias = 0.08;
		const float mFresnelScale = 0.3;
		const float mFresnelPower = 5.0;

		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );
		*/

		float specularNormalization = ( shininess + 2.0 ) / 8.0;

		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;

		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );
		totalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;


	}

#endif

#if MAX_HEMI_LIGHTS > 0

	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {

		vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );

		// diffuse

		float dotProduct = dot( normal, lVector );
		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;

		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );

		totalDiffuseLight += hemiColor;

		// specular (sky light)

		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );
		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;
		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );

		// specular (ground light)

		vec3 lVectorGround = -lVector;

		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );
		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;
		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );

		float dotProductGround = dot( normal, lVectorGround );

		float specularNormalization = ( shininess + 2.0 ) / 8.0;

		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );
		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );
		totalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );

	}

#endif

#ifdef METAL

	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;

#else

	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;

#endif
`,THREE.ShaderChunk.fog_pars_fragment=`#ifdef USE_FOG

	uniform vec3 fogColor;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;
	#endif

#endif`,THREE.ShaderChunk.morphnormal_vertex=`#ifdef USE_MORPHNORMALS

	vec3 morphedNormal = vec3( 0.0 );

	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];
	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];
	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];
	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];

	morphedNormal += normal;

#endif`,THREE.ShaderChunk.envmap_pars_fragment=`#ifdef USE_ENVMAP

	uniform float reflectivity;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	uniform float flipEnvMap;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )

		uniform float refractionRatio;

	#else

		varying vec3 vReflect;

	#endif

#endif
`,THREE.ShaderChunk.logdepthbuf_fragment=`#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)

	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;

#endif`,THREE.ShaderChunk.normalmap_pars_fragment=`#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

	// Per-Pixel Tangent Space Normal Mapping
	// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {

		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 S = normalize( q0 * st1.t - q1 * st0.t );
		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );
		vec3 N = normalize( surf_norm );

		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		mapN.xy = normalScale * mapN.xy;
		mat3 tsn = mat3( S, T, N );
		return normalize( tsn * mapN );

	}

#endif
`,THREE.ShaderChunk.lights_phong_pars_vertex=`#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )

	varying vec3 vWorldPosition;

#endif
`,THREE.ShaderChunk.lightmap_pars_fragment=`#ifdef USE_LIGHTMAP

	varying vec2 vUv2;
	uniform sampler2D lightMap;

#endif`,THREE.ShaderChunk.shadowmap_vertex=`#ifdef USE_SHADOWMAP

	for( int i = 0; i < MAX_SHADOWS; i ++ ) {

		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;

	}

#endif`,THREE.ShaderChunk.lights_phong_vertex=`#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )

	vWorldPosition = worldPosition.xyz;

#endif`,THREE.ShaderChunk.map_fragment=`#ifdef USE_MAP

	vec4 texelColor = texture2D( map, vUv );

	texelColor.xyz = inputToLinear( texelColor.xyz );

	diffuseColor *= texelColor;

#endif`,THREE.ShaderChunk.lightmap_vertex=`#ifdef USE_LIGHTMAP

	vUv2 = uv2;

#endif`,THREE.ShaderChunk.map_particle_fragment=`#ifdef USE_MAP

	diffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );

#endif
`,THREE.ShaderChunk.color_pars_fragment=`#ifdef USE_COLOR

	varying vec3 vColor;

#endif
`,THREE.ShaderChunk.color_vertex=`#ifdef USE_COLOR

	vColor.xyz = inputToLinear( color.xyz );

#endif`,THREE.ShaderChunk.skinning_vertex=`#ifdef USE_SKINNING

	#ifdef USE_MORPHTARGETS

	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );

	#else

	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );

	#endif

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	skinned  = bindMatrixInverse * skinned;

#endif
`,THREE.ShaderChunk.envmap_pars_vertex=`#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )

	varying vec3 vReflect;

	uniform float refractionRatio;

#endif
`,THREE.ShaderChunk.linear_to_gamma_fragment=`
	outgoingLight = linearToOutput( outgoingLight );
`,THREE.ShaderChunk.color_pars_vertex=`#ifdef USE_COLOR

	varying vec3 vColor;

#endif`,THREE.ShaderChunk.lights_lambert_pars_vertex=`uniform vec3 ambientLightColor;

#if MAX_DIR_LIGHTS > 0

	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];
	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];

#endif

#if MAX_HEMI_LIGHTS > 0

	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];
	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];
	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];

#endif

#if MAX_POINT_LIGHTS > 0

	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];
	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];
	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];
	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];

#endif

#if MAX_SPOT_LIGHTS > 0

	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];
	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];
	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];
	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];
	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];
	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];
	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];

#endif

#ifdef WRAP_AROUND

	uniform vec3 wrapRGB;

#endif
`,THREE.ShaderChunk.map_pars_vertex=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )

	varying vec2 vUv;
	uniform vec4 offsetRepeat;

#endif
`,THREE.ShaderChunk.envmap_fragment=`#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )

		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToVertex, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef DOUBLE_SIDED
		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );
	#else
		float flipNormal = 1.0;
	#endif

	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );
		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );

	#elif defined( ENVMAP_TYPE_SPHERE )
		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#endif

	envColor.xyz = inputToLinear( envColor.xyz );

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`,THREE.ShaderChunk.specularmap_pars_fragment=`#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif`,THREE.ShaderChunk.logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF

	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;

#else

		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;

	#endif

#endif`,THREE.ShaderChunk.morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS

	#ifndef USE_MORPHNORMALS

	uniform float morphTargetInfluences[ 8 ];

	#else

	uniform float morphTargetInfluences[ 4 ];

	#endif

#endif`,THREE.ShaderChunk.specularmap_fragment=`float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif`,THREE.ShaderChunk.fog_fragment=`#ifdef USE_FOG

	#ifdef USE_LOGDEPTHBUF_EXT

		float depth = gl_FragDepthEXT / gl_FragCoord.w;

	#else

		float depth = gl_FragCoord.z / gl_FragCoord.w;

	#endif

	#ifdef FOG_EXP2

		float fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );
		fogFactor = whiteCompliment( fogFactor );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, depth );

	#endif
	
	outgoingLight = mix( outgoingLight, fogColor, fogFactor );

#endif`,THREE.ShaderChunk.bumpmap_pars_fragment=`#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen
	// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {

		vec3 vSigmaX = dFdx( surf_pos );
		vec3 vSigmaY = dFdy( surf_pos );
		vec3 vN = surf_norm;		// normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 );

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`,THREE.ShaderChunk.defaultnormal_vertex=`#ifdef USE_SKINNING

	vec3 objectNormal = skinnedNormal.xyz;

#elif defined( USE_MORPHNORMALS )

	vec3 objectNormal = morphedNormal;

#else

	vec3 objectNormal = normal;

#endif

#ifdef FLIP_SIDED

	objectNormal = -objectNormal;

#endif

vec3 transformedNormal = normalMatrix * objectNormal;
`,THREE.ShaderChunk.lights_phong_pars_fragment=`uniform vec3 ambientLightColor;

#if MAX_DIR_LIGHTS > 0

	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];
	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];

#endif

#if MAX_HEMI_LIGHTS > 0

	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];
	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];
	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];

#endif

#if MAX_POINT_LIGHTS > 0

	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];

	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];
	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];
	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];

#endif

#if MAX_SPOT_LIGHTS > 0

	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];
	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];
	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];
	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];
	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];
	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];
	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];

#endif

#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )

	varying vec3 vWorldPosition;

#endif

#ifdef WRAP_AROUND

	uniform vec3 wrapRGB;

#endif

varying vec3 vViewPosition;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif
`,THREE.ShaderChunk.skinbase_vertex=`#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif`,THREE.ShaderChunk.map_vertex=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )

	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;

#endif`,THREE.ShaderChunk.lightmap_fragment=`#ifdef USE_LIGHTMAP

	outgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;

#endif`,THREE.ShaderChunk.shadowmap_pars_vertex=`#ifdef USE_SHADOWMAP

	varying vec4 vShadowCoord[ MAX_SHADOWS ];
	uniform mat4 shadowMatrix[ MAX_SHADOWS ];

#endif`,THREE.ShaderChunk.color_fragment=`#ifdef USE_COLOR

	diffuseColor.rgb *= vColor;

#endif`,THREE.ShaderChunk.morphtarget_vertex=`#ifdef USE_MORPHTARGETS

	vec3 morphed = vec3( 0.0 );
	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];
	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];
	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];
	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];

	#ifndef USE_MORPHNORMALS

	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];
	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];
	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];
	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];

	#endif

	morphed += position;

#endif`,THREE.ShaderChunk.envmap_vertex=`#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )

	vec3 worldNormal = transformDirection( objectNormal, modelMatrix );

	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

	#ifdef ENVMAP_MODE_REFLECTION

		vReflect = reflect( cameraToVertex, worldNormal );

	#else

		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

	#endif

#endif
`,THREE.ShaderChunk.shadowmap_fragment=`#ifdef USE_SHADOWMAP

	#ifdef SHADOWMAP_DEBUG

		vec3 frustumColors[3];
		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );
		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );
		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );

	#endif

	#ifdef SHADOWMAP_CASCADE

		int inFrustumCount = 0;

	#endif

	float fDepth;
	vec3 shadowColor = vec3( 1.0 );

	for( int i = 0; i < MAX_SHADOWS; i ++ ) {

		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;

				// if ( something && something ) breaks ATI OpenGL shader compiler
				// if ( all( something, something ) ) using this instead

		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );

				// don't shadow pixels outside of light frustum
				// use just first frustum (for cascades)
				// don't shadow pixels behind far plane of light frustum

		#ifdef SHADOWMAP_CASCADE

			inFrustumCount += int( inFrustum );
			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );

		#else

			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

		#endif

		bool frustumTest = all( frustumTestVec );

		if ( frustumTest ) {

			shadowCoord.z += shadowBias[ i ];

			#if defined( SHADOWMAP_TYPE_PCF )

						// Percentage-close filtering
						// (9 pixel kernel)
						// http://fabiensanglard.net/shadowmappingPCF/

				float shadow = 0.0;

		/*
						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL
						// must enroll loop manually

				for ( float y = -1.25; y <= 1.25; y += 1.25 )
					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {

						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );

								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup
								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );

						float fDepth = unpackDepth( rgbaDepth );

						if ( fDepth < shadowCoord.z )
							shadow += 1.0;

				}

				shadow /= 9.0;

		*/

				const float shadowDelta = 1.0 / 9.0;

				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;
				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;

				float dx0 = -1.25 * xPixelOffset;
				float dy0 = -1.25 * yPixelOffset;
				float dx1 = 1.25 * xPixelOffset;
				float dy1 = 1.25 * yPixelOffset;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );
				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;

				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );

			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

						// Percentage-close filtering
						// (9 pixel kernel)
						// http://fabiensanglard.net/shadowmappingPCF/

				float shadow = 0.0;

				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;
				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;

				float dx0 = -1.0 * xPixelOffset;
				float dy0 = -1.0 * yPixelOffset;
				float dx1 = 1.0 * xPixelOffset;
				float dy1 = 1.0 * yPixelOffset;

				mat3 shadowKernel;
				mat3 depthKernel;

				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );
				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );
				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );
				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );
				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );
				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );
				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );
				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );
				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );

				vec3 shadowZ = vec3( shadowCoord.z );
				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));
				shadowKernel[0] *= vec3(0.25);

				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));
				shadowKernel[1] *= vec3(0.25);

				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));
				shadowKernel[2] *= vec3(0.25);

				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );

				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );
				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );

				vec4 shadowValues;
				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );
				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );
				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );
				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );

				shadow = dot( shadowValues, vec4( 1.0 ) );

				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );

			#else

				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );
				float fDepth = unpackDepth( rgbaDepth );

				if ( fDepth < shadowCoord.z )

		// spot with multiple shadows is darker

					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );

		// spot with multiple shadows has the same color as single shadow spot

		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );

			#endif

		}


		#ifdef SHADOWMAP_DEBUG

			#ifdef SHADOWMAP_CASCADE

				if ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];

			#else

				if ( inFrustum ) outgoingLight *= frustumColors[ i ];

			#endif

		#endif

	}

	// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014
	shadowColor = inputToLinear( shadowColor );

	outgoingLight = outgoingLight * shadowColor;

#endif
`,THREE.ShaderChunk.worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )

	#ifdef USE_SKINNING

		vec4 worldPosition = modelMatrix * skinned;

	#elif defined( USE_MORPHTARGETS )

		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );

	#else

		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );

	#endif

#endif
`,THREE.ShaderChunk.shadowmap_pars_fragment=`#ifdef USE_SHADOWMAP

	uniform sampler2D shadowMap[ MAX_SHADOWS ];
	uniform vec2 shadowMapSize[ MAX_SHADOWS ];

	uniform float shadowDarkness[ MAX_SHADOWS ];
	uniform float shadowBias[ MAX_SHADOWS ];

	varying vec4 vShadowCoord[ MAX_SHADOWS ];

	float unpackDepth( const in vec4 rgba_depth ) {

		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );
		float depth = dot( rgba_depth, bit_shift );
		return depth;

	}

#endif`,THREE.ShaderChunk.skinning_pars_vertex=`#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	#ifdef BONE_TEXTURE

		uniform sampler2D boneTexture;
		uniform int boneTextureWidth;
		uniform int boneTextureHeight;

		mat4 getBoneMatrix( const in float i ) {

			float j = i * 4.0;
			float x = mod( j, float( boneTextureWidth ) );
			float y = floor( j / float( boneTextureWidth ) );

			float dx = 1.0 / float( boneTextureWidth );
			float dy = 1.0 / float( boneTextureHeight );

			y = dy * ( y + 0.5 );

			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

			mat4 bone = mat4( v1, v2, v3, v4 );

			return bone;

		}

	#else

		uniform mat4 boneGlobalMatrices[ MAX_BONES ];

		mat4 getBoneMatrix( const in float i ) {

			mat4 bone = boneGlobalMatrices[ int(i) ];
			return bone;

		}

	#endif

#endif
`,THREE.ShaderChunk.logdepthbuf_pars_fragment=`#ifdef USE_LOGDEPTHBUF

	uniform float logDepthBufFC;

	#ifdef USE_LOGDEPTHBUF_EXT

		#extension GL_EXT_frag_depth : enable
		varying float vFragDepth;

	#endif

#endif`,THREE.ShaderChunk.alphamap_fragment=`#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`,THREE.ShaderChunk.alphamap_pars_fragment=`#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,THREE.UniformsUtils={merge:function(e){for(var n,o,s={},t=0;t<e.length;t++){n=this.clone(e[t]);for(o in n)s[o]=n[o]}return s},clone:function(e){var t,n,o,s={};for(n in e){s[n]={};for(o in e[n])t=e[n][o],t instanceof THREE.Color||t instanceof THREE.Vector2||t instanceof THREE.Vector3||t instanceof THREE.Vector4||t instanceof THREE.Matrix4||t instanceof THREE.Texture?s[n][o]=t.clone():t instanceof Array?s[n][o]=t.slice():s[n][o]=t}return s}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"	#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join(`
`),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"	outgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join(`
`)},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join(`
`),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			outgoingLight += diffuseColor.rgb * vLightFront + emissive;","		else","			outgoingLight += diffuseColor.rgb * vLightBack + emissive;","	#else","		outgoingLight += diffuseColor.rgb * vLightFront + emissive;","	#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join(`
`)},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","	varying vec3 vNormal;","#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","	vNormal = normalize( transformedNormal );","#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join(`
`),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join(`
`)},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join(`
`),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( psColor, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphatest_fragment,"	outgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join(`
`)},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join(`
`),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,"	outgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join(`
`)},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join(`
`),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join(`
`)},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join(`
`),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join(`
`)},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join(`
`),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join(`
`)},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join(`
`),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join(`
`)},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join(`
`),fragmentShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join(`
`)}},THREE.WebGLRenderer=function(e){function mt(e){e.__webglVertexBuffer=t.createBuffer(),e.__webglColorBuffer=t.createBuffer(),n.info.memory.geometries++}function St(e){e.__webglVertexBuffer=t.createBuffer(),e.__webglColorBuffer=t.createBuffer(),e.__webglLineDistanceBuffer=t.createBuffer(),n.info.memory.geometries++}function Je(e){if(e.__webglVertexBuffer=t.createBuffer(),e.__webglNormalBuffer=t.createBuffer(),e.__webglTangentBuffer=t.createBuffer(),e.__webglColorBuffer=t.createBuffer(),e.__webglUVBuffer=t.createBuffer(),e.__webglUV2Buffer=t.createBuffer(),e.__webglSkinIndicesBuffer=t.createBuffer(),e.__webglSkinWeightsBuffer=t.createBuffer(),e.__webglFaceBuffer=t.createBuffer(),e.__webglLineBuffer=t.createBuffer(),o=e.numMorphTargets,o){e.__webglMorphTargetsBuffers=[];for(var o,a,s=0,i=o;i>s;s++)e.__webglMorphTargetsBuffers.push(t.createBuffer())}if(a=e.numMorphNormals,a){e.__webglMorphNormalsBuffers=[];for(s=0,i=a;i>s;s++)e.__webglMorphNormalsBuffers.push(t.createBuffer())}n.info.memory.geometries++}function ce(e){var n,s,a,o=e.geometry,i=e.material,r=o.vertices.length;if(i.attributes){void 0===o.__webglCustomAttributesList&&(o.__webglCustomAttributesList=[]);for(a in i.attributes)n=i.attributes[a],(!n.__webglInitialized||n.createUniqueBuffers)&&(n.__webglInitialized=!0,s=1,"v2"===n.type?s=2:"v3"===n.type?s=3:"v4"===n.type?s=4:"c"===n.type&&(s=3),n.size=s,n.array=new Float32Array(r*s),n.buffer=t.createBuffer(),n.buffer.belongsToAttribute=a,n.needsUpdate=!0),o.__webglCustomAttributesList.push(n)}}function Ge(e,t){var n=e.vertices.length;e.__vertexArray=new Float32Array(3*n),e.__colorArray=new Float32Array(3*n),e.__webglParticleCount=n,ce(t)}function Ye(e,t){var n=e.vertices.length;e.__vertexArray=new Float32Array(3*n),e.__colorArray=new Float32Array(3*n),e.__lineDistanceArray=new Float32Array(1*n),e.__webglLineCount=n,ce(t)}function qe(e,n){var s,a,r,c,l,d,h,m,v,j,b=n.geometry,p=e.faces3,i=3*p.length,f=1*p.length,g=3*p.length,u=T(n,e);if(e.__vertexArray=new Float32Array(3*i),e.__normalArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__uvArray=new Float32Array(2*i),b.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*i)),b.hasTangents&&(e.__tangentArray=new Float32Array(4*i)),n.geometry.skinWeights.length&&n.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*i),e.__skinWeightArray=new Float32Array(4*i)),l=null!==o.get("OES_element_index_uint")&&f>21845?Uint32Array:Uint16Array,e.__typeArray=l,e.__faceArray=new l(3*f),e.__lineArray=new l(2*g),h=e.numMorphTargets,h){e.__morphTargetsArrays=[];for(r=0,d=h;d>r;r++)e.__morphTargetsArrays.push(new Float32Array(3*i))}if(m=e.numMorphNormals,m){e.__morphNormalsArrays=[];for(r=0,d=m;d>r;r++)e.__morphNormalsArrays.push(new Float32Array(3*i))}if(e.__webglFaceCount=3*f,e.__webglLineCount=2*g,u.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(v in u.attributes){c=u.attributes[v],s={};for(j in c)s[j]=c[j];(!s.__webglInitialized||s.createUniqueBuffers)&&(s.__webglInitialized=!0,a=1,"v2"===s.type?a=2:"v3"===s.type?a=3:"v4"===s.type?a=4:"c"===s.type&&(a=3),s.size=a,s.array=new Float32Array(i*a),s.buffer=t.createBuffer(),s.buffer.belongsToAttribute=v,c.needsUpdate=!0,s.__original=c),e.__webglCustomAttributesList.push(s)}}e.__inittedArrays=!0}function T(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function Ve(e){return e instanceof THREE.MeshPhongMaterial==!1&&e.shading===THREE.FlatShading}function Be(e,n){var o,i,a,r,c,l,d,u,h,m,v,b=e.vertices,y=b.length,j=e.colors,_=j.length,f=e.__vertexArray,p=e.__colorArray,w=e.verticesNeedUpdate,O=e.colorsNeedUpdate,g=e.__webglCustomAttributesList;if(w){for(d=0;y>d;d++)m=b[d],i=3*d,f[i]=m.x,f[i+1]=m.y,f[i+2]=m.z;t.bindBuffer(t.ARRAY_BUFFER,e.__webglVertexBuffer),t.bufferData(t.ARRAY_BUFFER,f,n)}if(O){for(l=0;_>l;l++)h=j[l],i=3*l,p[i]=h.r,p[i+1]=h.g,p[i+2]=h.b;t.bindBuffer(t.ARRAY_BUFFER,e.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,p,n)}if(g)for(u=0,v=g.length;v>u;u++){if(o=g[u],o.needsUpdate&&(void 0===o.boundTo||"vertices"===o.boundTo))if(c=o.value.length,i=0,1===o.size)for(a=0;c>a;a++)o.array[a]=o.value[a];else if(2===o.size)for(a=0;c>a;a++)r=o.value[a],o.array[i]=r.x,o.array[i+1]=r.y,i+=2;else if(3===o.size)if("c"===o.type)for(a=0;c>a;a++)r=o.value[a],o.array[i]=r.r,o.array[i+1]=r.g,o.array[i+2]=r.b,i+=3;else for(a=0;c>a;a++)r=o.value[a],o.array[i]=r.x,o.array[i+1]=r.y,o.array[i+2]=r.z,i+=3;else if(4===o.size)for(a=0;c>a;a++)r=o.value[a],o.array[i]=r.x,o.array[i+1]=r.y,o.array[i+2]=r.z,o.array[i+3]=r.w,i+=4;t.bindBuffer(t.ARRAY_BUFFER,o.buffer),t.bufferData(t.ARRAY_BUFFER,o.array,n),o.needsUpdate=!1}}function Ie(e,n){var s,o,i,a,r,c,l,d,m,f,p,_,v=e.vertices,b=e.colors,j=e.lineDistances,k=v.length,O=b.length,w=j.length,u=e.__vertexArray,h=e.__colorArray,y=e.__lineDistanceArray,x=e.verticesNeedUpdate,C=e.colorsNeedUpdate,E=e.lineDistancesNeedUpdate,g=e.__webglCustomAttributesList;if(x){for(d=0;k>d;d++)p=v[d],o=3*d,u[o]=p.x,u[o+1]=p.y,u[o+2]=p.z;t.bindBuffer(t.ARRAY_BUFFER,e.__webglVertexBuffer),t.bufferData(t.ARRAY_BUFFER,u,n)}if(C){for(c=0;O>c;c++)f=b[c],o=3*c,h[o]=f.r,h[o+1]=f.g,h[o+2]=f.b;t.bindBuffer(t.ARRAY_BUFFER,e.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,h,n)}if(E){for(l=0;w>l;l++)y[l]=j[l];t.bindBuffer(t.ARRAY_BUFFER,e.__webglLineDistanceBuffer),t.bufferData(t.ARRAY_BUFFER,y,n)}if(g)for(m=0,_=g.length;_>m;m++)if(s=g[m],s.needsUpdate&&(void 0===s.boundTo||"vertices"===s.boundTo)){if(o=0,r=s.value.length,1===s.size)for(i=0;r>i;i++)s.array[i]=s.value[i];else if(2===s.size)for(i=0;r>i;i++)a=s.value[i],s.array[o]=a.x,s.array[o+1]=a.y,o+=2;else if(3===s.size)if("c"===s.type)for(i=0;r>i;i++)a=s.value[i],s.array[o]=a.r,s.array[o+1]=a.g,s.array[o+2]=a.b,o+=3;else for(i=0;r>i;i++)a=s.value[i],s.array[o]=a.x,s.array[o+1]=a.y,s.array[o+2]=a.z,o+=3;else if(4===s.size)for(i=0;r>i;i++)a=s.value[i],s.array[o]=a.x,s.array[o+1]=a.y,s.array[o+2]=a.z,s.array[o+3]=a.w,o+=4;t.bindBuffer(t.ARRAY_BUFFER,s.buffer),t.bufferData(t.ARRAY_BUFFER,s.array,n),s.needsUpdate=!1}}function He(e,n,s,o,i){if(e.__inittedArrays){var a,c,l,d,u,h,m,p,v,j,_,A,M,L,H,I,B,V,$,W,U,K,q,Y,G,X,Q,Z,J,ue,we,oe,le,ie,_e,me,Me,ce,pe,be,Ce,re,ae,Se=Ve(i),z=0,T=0,se=0,ne=0,te=0,D=0,w=0,R=0,E=0,g=0,b=0,r=0,k=e.__vertexArray,ye=e.__uvArray,je=e.__uv2Array,P=e.__normalArray,x=e.__tangentArray,S=e.__colorArray,C=e.__skinIndexArray,O=e.__skinWeightArray,ke=e.__morphTargetsArrays,xe=e.__morphNormalsArrays,ve=e.__webglCustomAttributesList,he=e.__faceArray,N=e.__lineArray,y=n.geometry,ze=y.verticesNeedUpdate,De=y.elementsNeedUpdate,Ae=y.uvsNeedUpdate,Ne=y.normalsNeedUpdate,Re=y.tangentsNeedUpdate,Le=y.colorsNeedUpdate,Te=y.morphTargetsNeedUpdate,fe=y.vertices,f=e.faces3,F=y.faces,Fe=y.faceVertexUvs[0],Oe=y.faceVertexUvs[1],ge=y.skinIndices,ee=y.skinWeights,de=y.morphTargets,Ee=y.morphNormals;if(ze){for(c=0,m=f.length;m>c;c++)h=F[f[c]],d=fe[h.a],l=fe[h.b],u=fe[h.c],k[T]=d.x,k[T+1]=d.y,k[T+2]=d.z,k[T+3]=l.x,k[T+4]=l.y,k[T+5]=l.z,k[T+6]=u.x,k[T+7]=u.y,k[T+8]=u.z,T+=9;t.bindBuffer(t.ARRAY_BUFFER,e.__webglVertexBuffer),t.bufferData(t.ARRAY_BUFFER,k,s)}if(Te)for(_=0,Ce=de.length;Ce>_;_++){for(b=0,c=0,m=f.length;m>c;c++)re=f[c],h=F[re],d=de[_].vertices[h.a],l=de[_].vertices[h.b],u=de[_].vertices[h.c],A=ke[_],A[b]=d.x,A[b+1]=d.y,A[b+2]=d.z,A[b+3]=l.x,A[b+4]=l.y,A[b+5]=l.z,A[b+6]=u.x,A[b+7]=u.y,A[b+8]=u.z,i.morphNormals&&(Se?(L=Ee[_].faceNormals[re],U=L,I=L):(ae=Ee[_].vertexNormals[re],L=ae.a,U=ae.b,I=ae.c),M=xe[_],M[b]=L.x,M[b+1]=L.y,M[b+2]=L.z,M[b+3]=U.x,M[b+4]=U.y,M[b+5]=U.z,M[b+6]=I.x,M[b+7]=I.y,M[b+8]=I.z),b+=9;t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[_]),t.bufferData(t.ARRAY_BUFFER,ke[_],s),i.morphNormals&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[_]),t.bufferData(t.ARRAY_BUFFER,xe[_],s))}if(ee.length){for(c=0,m=f.length;m>c;c++)h=F[f[c]],Z=ee[h.a],J=ee[h.b],K=ee[h.c],O[g]=Z.x,O[g+1]=Z.y,O[g+2]=Z.z,O[g+3]=Z.w,O[g+4]=J.x,O[g+5]=J.y,O[g+6]=J.z,O[g+7]=J.w,O[g+8]=K.x,O[g+9]=K.y,O[g+10]=K.z,O[g+11]=K.w,X=ge[h.a],G=ge[h.b],q=ge[h.c],C[g]=X.x,C[g+1]=X.y,C[g+2]=X.z,C[g+3]=X.w,C[g+4]=G.x,C[g+5]=G.y,C[g+6]=G.z,C[g+7]=G.w,C[g+8]=q.x,C[g+9]=q.y,C[g+10]=q.z,C[g+11]=q.w,g+=12;g>0&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),t.bufferData(t.ARRAY_BUFFER,C,s),t.bindBuffer(t.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),t.bufferData(t.ARRAY_BUFFER,O,s))}if(Le){for(c=0,m=f.length;m>c;c++)h=F[f[c]],$=h.vertexColors,le=h.color,3===$.length&&i.vertexColors===THREE.VertexColors?(Y=$[0],H=$[1],Q=$[2]):(Y=le,H=le,Q=le),S[E]=Y.r,S[E+1]=Y.g,S[E+2]=Y.b,S[E+3]=H.r,S[E+4]=H.g,S[E+5]=H.b,S[E+6]=Q.r,S[E+7]=Q.g,S[E+8]=Q.b,E+=9;E>0&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,S,s))}if(Re&&y.hasTangents){for(c=0,m=f.length;m>c;c++)h=F[f[c]],ie=h.vertexTangents,B=ie[0],V=ie[1],W=ie[2],x[w]=B.x,x[w+1]=B.y,x[w+2]=B.z,x[w+3]=B.w,x[w+4]=V.x,x[w+5]=V.y,x[w+6]=V.z,x[w+7]=V.w,x[w+8]=W.x,x[w+9]=W.y,x[w+10]=W.z,x[w+11]=W.w,w+=12;t.bindBuffer(t.ARRAY_BUFFER,e.__webglTangentBuffer),t.bufferData(t.ARRAY_BUFFER,x,s)}if(Ne){for(c=0,m=f.length;m>c;c++)if(h=F[f[c]],we=h.vertexNormals,oe=h.normal,3===we.length&&Se===!1)for(j=0;3>j;j++)ce=we[j],P[D]=ce.x,P[D+1]=ce.y,P[D+2]=ce.z,D+=3;else for(j=0;3>j;j++)P[D]=oe.x,P[D+1]=oe.y,P[D+2]=oe.z,D+=3;t.bindBuffer(t.ARRAY_BUFFER,e.__webglNormalBuffer),t.bufferData(t.ARRAY_BUFFER,P,s)}if(Ae&&Fe){for(c=0,m=f.length;m>c;c++)if(ue=f[c],_e=Fe[ue],void 0!==_e)for(j=0;3>j;j++)pe=_e[j],ye[se]=pe.x,ye[se+1]=pe.y,se+=2;se>0&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglUVBuffer),t.bufferData(t.ARRAY_BUFFER,ye,s))}if(Ae&&Oe){for(c=0,m=f.length;m>c;c++)if(ue=f[c],me=Oe[ue],void 0!==me)for(j=0;3>j;j++)be=me[j],je[ne]=be.x,je[ne+1]=be.y,ne+=2;ne>0&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglUV2Buffer),t.bufferData(t.ARRAY_BUFFER,je,s))}if(De){for(c=0,m=f.length;m>c;c++)he[te]=z,he[te+1]=z+1,he[te+2]=z+2,te+=3,N[R]=z,N[R+1]=z+1,N[R+2]=z,N[R+3]=z+2,N[R+4]=z+1,N[R+5]=z+2,R+=6,z+=3;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,he,s),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,N,s)}if(ve)for(j=0,Me=ve.length;Me>j;j++)if(a=ve[j],a.__original.needsUpdate){if(r=0,1===a.size){if(void 0===a.boundTo||"vertices"===a.boundTo)for(c=0,m=f.length;m>c;c++)h=F[f[c]],a.array[r]=a.value[h.a],a.array[r+1]=a.value[h.b],a.array[r+2]=a.value[h.c],r+=3;else if("faces"===a.boundTo)for(c=0,m=f.length;m>c;c++)v=a.value[f[c]],a.array[r]=v,a.array[r+1]=v,a.array[r+2]=v,r+=3}else if(2===a.size){if(void 0===a.boundTo||"vertices"===a.boundTo)for(c=0,m=f.length;m>c;c++)h=F[f[c]],d=a.value[h.a],l=a.value[h.b],u=a.value[h.c],a.array[r]=d.x,a.array[r+1]=d.y,a.array[r+2]=l.x,a.array[r+3]=l.y,a.array[r+4]=u.x,a.array[r+5]=u.y,r+=6;else if("faces"===a.boundTo)for(c=0,m=f.length;m>c;c++)v=a.value[f[c]],d=v,l=v,u=v,a.array[r]=d.x,a.array[r+1]=d.y,a.array[r+2]=l.x,a.array[r+3]=l.y,a.array[r+4]=u.x,a.array[r+5]=u.y,r+=6}else if(3===a.size){if(p="c"===a.type?["r","g","b"]:["x","y","z"],void 0===a.boundTo||"vertices"===a.boundTo)for(c=0,m=f.length;m>c;c++)h=F[f[c]],d=a.value[h.a],l=a.value[h.b],u=a.value[h.c],a.array[r]=d[p[0]],a.array[r+1]=d[p[1]],a.array[r+2]=d[p[2]],a.array[r+3]=l[p[0]],a.array[r+4]=l[p[1]],a.array[r+5]=l[p[2]],a.array[r+6]=u[p[0]],a.array[r+7]=u[p[1]],a.array[r+8]=u[p[2]],r+=9;else if("faces"===a.boundTo)for(c=0,m=f.length;m>c;c++)v=a.value[f[c]],d=v,l=v,u=v,a.array[r]=d[p[0]],a.array[r+1]=d[p[1]],a.array[r+2]=d[p[2]],a.array[r+3]=l[p[0]],a.array[r+4]=l[p[1]],a.array[r+5]=l[p[2]],a.array[r+6]=u[p[0]],a.array[r+7]=u[p[1]],a.array[r+8]=u[p[2]],r+=9;else if("faceVertices"===a.boundTo)for(c=0,m=f.length;m>c;c++)v=a.value[f[c]],d=v[0],l=v[1],u=v[2],a.array[r]=d[p[0]],a.array[r+1]=d[p[1]],a.array[r+2]=d[p[2]],a.array[r+3]=l[p[0]],a.array[r+4]=l[p[1]],a.array[r+5]=l[p[2]],a.array[r+6]=u[p[0]],a.array[r+7]=u[p[1]],a.array[r+8]=u[p[2]],r+=9}else if(4===a.size)if(void 0===a.boundTo||"vertices"===a.boundTo)for(c=0,m=f.length;m>c;c++)h=F[f[c]],d=a.value[h.a],l=a.value[h.b],u=a.value[h.c],a.array[r]=d.x,a.array[r+1]=d.y,a.array[r+2]=d.z,a.array[r+3]=d.w,a.array[r+4]=l.x,a.array[r+5]=l.y,a.array[r+6]=l.z,a.array[r+7]=l.w,a.array[r+8]=u.x,a.array[r+9]=u.y,a.array[r+10]=u.z,a.array[r+11]=u.w,r+=12;else if("faces"===a.boundTo)for(c=0,m=f.length;m>c;c++)v=a.value[f[c]],d=v,l=v,u=v,a.array[r]=d.x,a.array[r+1]=d.y,a.array[r+2]=d.z,a.array[r+3]=d.w,a.array[r+4]=l.x,a.array[r+5]=l.y,a.array[r+6]=l.z,a.array[r+7]=l.w,a.array[r+8]=u.x,a.array[r+9]=u.y,a.array[r+10]=u.z,a.array[r+11]=u.w,r+=12;else if("faceVertices"===a.boundTo)for(c=0,m=f.length;m>c;c++)v=a.value[f[c]],d=v[0],l=v[1],u=v[2],a.array[r]=d.x,a.array[r+1]=d.y,a.array[r+2]=d.z,a.array[r+3]=d.w,a.array[r+4]=l.x,a.array[r+5]=l.y,a.array[r+6]=l.z,a.array[r+7]=l.w,a.array[r+8]=u.x,a.array[r+9]=u.y,a.array[r+10]=u.z,a.array[r+11]=u.w,r+=12;t.bindBuffer(t.ARRAY_BUFFER,a.buffer),t.bufferData(t.ARRAY_BUFFER,a.array,s)}o&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function m(e,n,o,i){for(var a,r,c,d,h=o.attributes,m=n.attributes,u=n.attributesKeys,l=0,f=u.length;f>l;l++)a=u[l],r=m[a],r>=0&&(c=h[a],void 0!==c?(d=c.itemSize,t.bindBuffer(t.ARRAY_BUFFER,c.buffer),s.enableAttribute(r),t.vertexAttribPointer(r,d,t.FLOAT,!1,0,i*d*4)):void 0!==e.defaultAttributeValues&&(2===e.defaultAttributeValues[a].length?t.vertexAttrib2fv(r,e.defaultAttributeValues[a]):3===e.defaultAttributeValues[a].length&&t.vertexAttrib3fv(r,e.defaultAttributeValues[a])));s.disableUnusedAttributes()}function Re(e,n,o){if(r=e.program.attributes,-1!==o.morphTargetBase&&r.position>=0?(t.bindBuffer(t.ARRAY_BUFFER,n.__webglMorphTargetsBuffers[o.morphTargetBase]),s.enableAttribute(r.position),t.vertexAttribPointer(r.position,3,t.FLOAT,!1,0,0)):r.position>=0&&(t.bindBuffer(t.ARRAY_BUFFER,n.__webglVertexBuffer),s.enableAttribute(r.position),t.vertexAttribPointer(r.position,3,t.FLOAT,!1,0,0)),o.morphTargetForcedOrder.length)for(var a,r,d,h,f,p,g,i=0,u=o.morphTargetForcedOrder,l=o.morphTargetInfluences;i<e.numSupportedMorphTargets&&i<u.length;)a=r["morphTarget"+i],a>=0&&(t.bindBuffer(t.ARRAY_BUFFER,n.__webglMorphTargetsBuffers[u[i]]),s.enableAttribute(a),t.vertexAttribPointer(a,3,t.FLOAT,!1,0,0)),a=r["morphNormal"+i],a>=0&&e.morphNormals&&(t.bindBuffer(t.ARRAY_BUFFER,n.__webglMorphNormalsBuffers[u[i]]),s.enableAttribute(a),t.vertexAttribPointer(a,3,t.FLOAT,!1,0,0)),o.__webglMorphTargetInfluences[i]=l[u[i]],i++;else{var c=[],l=o.morphTargetInfluences,m=o.geometry.morphTargets;l.length>m.length&&(console.warn("THREE.WebGLRenderer: Influences array is bigger than morphTargets array."),l.length=m.length);for(d=0,f=l.length;f>d;d++)p=l[d],c.push([p,d]);c.length>e.numSupportedMorphTargets?(c.sort(ve),c.length=e.numSupportedMorphTargets):c.length>e.numSupportedMorphNormals?c.sort(ve):0===c.length&&c.push([0,0]);for(i=0,g=e.numSupportedMorphTargets;g>i;i++)c[i]?(h=c[i][1],a=r["morphTarget"+i],a>=0&&(t.bindBuffer(t.ARRAY_BUFFER,n.__webglMorphTargetsBuffers[h]),s.enableAttribute(a),t.vertexAttribPointer(a,3,t.FLOAT,!1,0,0)),a=r["morphNormal"+i],a>=0&&e.morphNormals&&(t.bindBuffer(t.ARRAY_BUFFER,n.__webglMorphNormalsBuffers[h]),s.enableAttribute(a),t.vertexAttribPointer(a,3,t.FLOAT,!1,0,0)),o.__webglMorphTargetInfluences[i]=l[h]):o.__webglMorphTargetInfluences[i]=0}null!==e.program.uniforms.morphTargetInfluences&&t.uniform1fv(e.program.uniforms.morphTargetInfluences,o.__webglMorphTargetInfluences)}function Le(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ne(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ve(e,t){return t[0]-e[0]}function Oe(e){if(e.visible!==!1){if(e instanceof THREE.Scene||e instanceof THREE.Group);else if(Se(e),e instanceof THREE.Light)u.push(e);else if(e instanceof THREE.Sprite)X.push(e);else if(e instanceof THREE.LensFlare)R.push(e);else if(s=f[e.id],s&&(e.frustumCulled===!1||U.intersectsObject(e)===!0))for(var s,o,t=0,i=s.length;i>t;t++)o=s[t],nt(o),o.render=!0,n.sortObjects===!0&&(a.setFromMatrixPosition(e.matrixWorld),a.applyProjection(K),o.z=a.z);for(t=0,i=e.children.length;i>t;t++)Oe(e.children[t])}}function k(e,t,s,o,i){for(r=0,u=e.length;u>r;r++){var a,r,u,c=e[r],l=c.object,d=c.buffer;if(re(l,t),i)a=i;else{if(a=c.material,!a)continue;Z(a)}n.setMaterialFaces(a),d instanceof THREE.BufferGeometry?n.renderBufferDirect(t,s,o,a,d,l):n.renderBuffer(t,s,o,a,d,l)}}function P(e,t,s,o,i,a){for(var r,l,d,c=0,u=e.length;u>c;c++)if(l=e[c],d=l.object,d.visible){if(a)r=a;else{if(r=l[t],!r)continue;Z(r)}n.renderImmediateObject(s,o,i,r,d)}}function Me(e){var n=e.object,t=n.material;t.transparent?(e.transparent=t,e.opaque=null):(e.opaque=t,e.transparent=null)}function nt(e){var s,n=e.object,o=e.buffer,i=n.geometry,t=n.material;t instanceof THREE.MeshFaceMaterial?(s=i instanceof THREE.BufferGeometry?0:o.materialIndex,t=t.materials[s],e.material=t,t.transparent?y.push(e):_.push(e)):t&&(e.material=t,t.transparent?y.push(e):_.push(e))}function Se(e){if(void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new THREE.Matrix4,e._normalMatrix=new THREE.Matrix3,e.addEventListener("removed",ue)),t=e.geometry,void 0===t||void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",ee),t instanceof THREE.BufferGeometry?n.info.memory.geometries++:e instanceof THREE.Mesh?xe(e,t):e instanceof THREE.Line?void 0===t.__webglVertexBuffer&&(St(t),Ye(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0,t.lineDistancesNeedUpdate=!0):e instanceof THREE.PointCloud&&void 0===t.__webglVertexBuffer&&(mt(t),Ge(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0)),void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof THREE.Mesh){if(t instanceof THREE.BufferGeometry)E(f,t,e);else if(t instanceof THREE.Geometry)for(var t,o=b[t.id],s=0,i=o.length;i>s;s++)E(f,o[s],e)}else e instanceof THREE.Line||e instanceof THREE.PointCloud?E(f,t,e):(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&Te(g,e)}function Fe(e,t){for(var n,s,r,h,m=o.get("OES_element_index_uint")?4294967296:65535,i={},d=e.morphTargets.length,u=e.morphNormals.length,a={},l=[],c=0,f=e.faces.length;f>c;c++)h=e.faces[c],n=t?h.materialIndex:0,n in i||(i[n]={hash:n,counter:0}),s=i[n].hash+"_"+i[n].counter,s in a||(r={id:Ce++,faces3:[],materialIndex:n,vertices:0,numMorphTargets:d,numMorphNormals:u},a[s]=r,l.push(r)),a[s].vertices+3>m&&(i[n].counter+=1,s=i[n].hash+"_"+i[n].counter,s in a||(r={id:Ce++,faces3:[],materialIndex:n,vertices:0,numMorphTargets:d,numMorphNormals:u},a[s]=r,l.push(r))),a[s].faces3.push(c),a[s].vertices+=3;return l}function xe(e,t){i=e.material,s=!1,(void 0===b[t.id]||t.groupsNeedUpdate===!0)&&(delete f[e.id],b[t.id]=Fe(t,i instanceof THREE.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var n,s,i,a=b[t.id],o=0,r=a.length;r>o;o++)n=a[o],void 0===n.__webglVertexBuffer?(Je(n),qe(n,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,s=!0):s=!1,(s||void 0===e.__webglActive)&&E(f,n,e);e.__webglActive=!0}function E(e,t,n){var s=n.id;e[s]=e[s]||[],e[s].push({id:s,buffer:t,object:n,material:null,z:0})}function Te(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function we(e){if(n=e.geometry,n instanceof THREE.BufferGeometry)for(var n,o,a,f=n.attributes,l=n.attributesKeys,i=0,h=l.length;h>i;i++){var c=l[i],s=f[c],r="index"===c?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;void 0===s.buffer?(s.buffer=t.createBuffer(),t.bindBuffer(r,s.buffer),t.bufferData(r,s.array,s instanceof THREE.DynamicBufferAttribute?t.DYNAMIC_DRAW:t.STATIC_DRAW),s.needsUpdate=!1):s.needsUpdate===!0&&(t.bindBuffer(r,s.buffer),void 0===s.updateRange||-1===s.updateRange.count?t.bufferSubData(r,0,s.array):0===s.updateRange.count?console.error("THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,s.updateRange.offset*s.array.BYTES_PER_ELEMENT,s.array.subarray(s.updateRange.offset,s.updateRange.offset+s.updateRange.count)),s.updateRange.count=0),s.needsUpdate=!1)}else if(e instanceof THREE.Mesh){n.groupsNeedUpdate===!0&&xe(e,n);for(var d=b[n.id],i=0,m=d.length;m>i;i++){var u=d[i],o=T(e,u),a=o.attributes&&H(o);(n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||a)&&He(u,e,t.DYNAMIC_DRAW,!n.dynamic,o)}n.verticesNeedUpdate=!1,n.morphTargetsNeedUpdate=!1,n.elementsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.tangentsNeedUpdate=!1,o.attributes&&W(o)}else e instanceof THREE.Line?(o=T(e,n),a=o.attributes&&H(o),(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||a)&&Ie(n,t.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,n.lineDistancesNeedUpdate=!1,o.attributes&&W(o)):e instanceof THREE.PointCloud&&(o=T(e,n),a=o.attributes&&H(o),(n.verticesNeedUpdate||n.colorsNeedUpdate||a)&&Be(n,t.DYNAMIC_DRAW,e),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,o.attributes&&W(o))}function H(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function W(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function Ue(e){e instanceof THREE.Mesh||e instanceof THREE.PointCloud||e instanceof THREE.Line?delete f[e.id]:(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&Xe(g,e),delete e.__webglInit,delete e._modelViewMatrix,delete e._normalMatrix,delete e.__webglActive}function Xe(e,t){for(var n=e.length-1;n>=0;n--)e[n].object===t&&e.splice(n,1)}function tt(e,t,s,o){e.addEventListener("dispose",je),c=Ft[e.type],c?(u=THREE.ShaderLib[c],e.__webglShader={uniforms:THREE.UniformsUtils.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}):e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var i,c,l,d,u,f,p,b,y,O,m=ke(t),w=Qe(t),C=et(o),j={precision:v,supportsVertexTextures:L,map:!!e.map,envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,combine:e.combine,vertexColors:e.vertexColors,fog:s,useFog:e.fog,fogExp:s instanceof THREE.FogExp2,flatShading:e.shading===THREE.FlatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:I,skinning:e.skinning,maxBones:C,useVertexTexture:Q&&o&&o.skeleton&&o.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:n.maxMorphTargets,maxMorphNormals:n.maxMorphNormals,maxDirLights:m.directional,maxPointLights:m.point,maxSpotLights:m.spot,maxHemiLights:m.hemi,maxShadows:w,shadowMapEnabled:n.shadowMapEnabled&&o.receiveShadow&&w>0,shadowMapType:n.shadowMapType,shadowMapDebug:n.shadowMapDebug,shadowMapCascade:n.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide},a=[];if(c?a.push(c):(a.push(e.fragmentShader),a.push(e.vertexShader)),void 0!==e.defines)for(d in e.defines)a.push(d),a.push(e.defines[d]);for(d in j)a.push(d),a.push(j[d]);for(var r,_=a.join(),g=0,x=h.length;x>g;g++)if(p=h[g],p.code===_){r=p,r.usedTimes++;break}if(void 0===r&&(r=new THREE.WebGLProgram(n,_,e,j),h.push(r),n.info.memory.programs=h.length),e.program=r,b=r.attributes,e.morphTargets){e.numSupportedMorphTargets=0;for(f="morphTarget",i=0;i<n.maxMorphTargets;i++)l=f+i,b[l]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0,f="morphNormal";for(i=0;i<n.maxMorphNormals;i++)l=f+i,b[l]>=0&&e.numSupportedMorphNormals++}e.uniformsList=[];for(O in e.__webglShader.uniforms)y=e.program.uniforms[O],y&&e.uniformsList.push([e.__webglShader.uniforms[O],y])}function Z(e){e.transparent===!0?s.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):s.setBlending(THREE.NoBlending),s.setDepthTest(e.depthTest),s.setDepthWrite(e.depthWrite),s.setColorWrite(e.colorWrite),s.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function N(e,s,o,i,r){V=0,i.needsUpdate&&(i.program&&_e(i),tt(i,s,o,r),i.needsUpdate=!1),i.morphTargets&&(r.__webglMorphTargetInfluences||(r.__webglMorphTargetInfluences=new Float32Array(n.maxMorphTargets)));var m,f=!1,h=!1,u=!1,d=i.program,c=d.uniforms,l=i.__webglShader.uniforms;return(d.id!==B&&(t.useProgram(d.program),B=d.id,f=!0,h=!0,u=!0),i.id!==w&&(-1===w&&(u=!0),w=i.id,h=!0),(f||e!==O)&&(t.uniformMatrix4fv(c.projectionMatrix,!1,e.projectionMatrix.elements),I&&t.uniform1f(c.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==O&&(O=e),(i instanceof THREE.ShaderMaterial||i instanceof THREE.MeshPhongMaterial||i.envMap)&&null!==c.cameraPosition&&(a.setFromMatrixPosition(e.matrixWorld),t.uniform3f(c.cameraPosition,a.x,a.y,a.z)),(i instanceof THREE.MeshPhongMaterial||i instanceof THREE.MeshLambertMaterial||i instanceof THREE.MeshBasicMaterial||i instanceof THREE.ShaderMaterial||i.skinning)&&null!==c.viewMatrix&&t.uniformMatrix4fv(c.viewMatrix,!1,e.matrixWorldInverse.elements)),i.skinning)&&(r.bindMatrix&&null!==c.bindMatrix&&t.uniformMatrix4fv(c.bindMatrix,!1,r.bindMatrix.elements),r.bindMatrixInverse&&null!==c.bindMatrixInverse&&t.uniformMatrix4fv(c.bindMatrixInverse,!1,r.bindMatrixInverse.elements),Q&&r.skeleton&&r.skeleton.useVertexTexture?(null!==c.boneTexture&&(m=q(),t.uniform1i(c.boneTexture,m),n.setTexture(r.skeleton.boneTexture,m)),null!==c.boneTextureWidth&&t.uniform1i(c.boneTextureWidth,r.skeleton.boneTextureWidth),null!==c.boneTextureHeight&&t.uniform1i(c.boneTextureHeight,r.skeleton.boneTextureHeight)):r.skeleton&&r.skeleton.boneMatrices&&null!==c.boneGlobalMatrices&&t.uniformMatrix4fv(c.boneGlobalMatrices,!1,r.skeleton.boneMatrices)),h&&(o&&i.fog&&xt(l,o),(i instanceof THREE.MeshPhongMaterial||i instanceof THREE.MeshLambertMaterial||i.lights)&&(z&&(u=!0,ct(s),z=!1),u?(_t(l,de),me(l,!0)):me(l,!1)),(i instanceof THREE.MeshBasicMaterial||i instanceof THREE.MeshLambertMaterial||i instanceof THREE.MeshPhongMaterial)&&Ze(l,i),i instanceof THREE.LineBasicMaterial?Ee(l,i):i instanceof THREE.LineDashedMaterial?(Ee(l,i),Mt(l,i)):i instanceof THREE.PointCloudMaterial?At(l,i):i instanceof THREE.MeshPhongMaterial?Ot(l,i):i instanceof THREE.MeshLambertMaterial?wt(l,i):i instanceof THREE.MeshDepthMaterial?(l.mNear.value=e.near,l.mFar.value=e.far,l.opacity.value=i.opacity):i instanceof THREE.MeshNormalMaterial&&(l.opacity.value=i.opacity),r.receiveShadow&&!i._shadowPass&&yt(l,s),pt(i.uniformsList)),jt(c,r),null!==c.modelMatrix&&t.uniformMatrix4fv(c.modelMatrix,!1,r.matrixWorld.elements),d}function Ze(e,t){if(e.opacity.value=t.opacity,e.diffuse.value=t.color,e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.map?n=t.map:t.specularMap?n=t.specularMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.alphaMap&&(n=t.alphaMap),void 0!==n){var n,s=n.offset,o=n.repeat;e.offsetRepeat.value.set(s.x,s.y,o.x,o.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}function Ee(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Mt(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function At(e,t){if(e.psColor.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size,e.scale.value=c.height/2,e.map.value=t.map,null!==t.map){var n=t.map.offset,s=t.map.repeat;e.offsetRepeat.value.set(n.x,n.y,s.x,s.y)}}function xt(e,t){e.fogColor.value=t.color,t instanceof THREE.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof THREE.FogExp2&&(e.fogDensity.value=t.density)}function Ot(e,t){e.shininess.value=t.shininess,e.emissive.value=t.emissive,e.specular.value=t.specular,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function wt(e,t){e.emissive.value=t.emissive,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function _t(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.pointLightDecay.value=t.point.decays,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.spotLightDecay.value=t.spot.decays,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function me(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.pointLightDecay.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.spotLightDecay.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function yt(e,t){if(e.shadowMatrix)for(var n,s=0,o=0,i=t.length;i>o;o++)n=t[o],n.castShadow&&(n instanceof THREE.SpotLight||n instanceof THREE.DirectionalLight&&!n.shadowCascade)&&(e.shadowMap.value[s]=n.shadowMap,e.shadowMapSize.value[s]=n.shadowMapSize,e.shadowMatrix.value[s]=n.shadowMatrix,e.shadowDarkness.value[s]=n.shadowDarkness,e.shadowBias.value[s]=n.shadowBias,s++)}function jt(e,n){t.uniformMatrix4fv(e.modelViewMatrix,!1,n._modelViewMatrix.elements),e.normalMatrix&&t.uniformMatrix3fv(e.normalMatrix,!1,n._normalMatrix.elements)}function q(){var e=V;return e>=te&&THREE.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+te),V+=1,e}function pt(e){for(u=0,h=e.length;h>u;u++)if(i=e[u][0],i.needsUpdate!==!1){var o,i,r,c,l,d,u,h,m=i.type,s=i.value,a=e[u][1];switch(m){case"1i":t.uniform1i(a,s);break;case"1f":t.uniform1f(a,s);break;case"2f":t.uniform2f(a,s[0],s[1]);break;case"3f":t.uniform3f(a,s[0],s[1],s[2]);break;case"4f":t.uniform4f(a,s[0],s[1],s[2],s[3]);break;case"1iv":t.uniform1iv(a,s);break;case"3iv":t.uniform3iv(a,s);break;case"1fv":t.uniform1fv(a,s);break;case"2fv":t.uniform2fv(a,s);break;case"3fv":t.uniform3fv(a,s);break;case"4fv":t.uniform4fv(a,s);break;case"Matrix3fv":t.uniformMatrix3fv(a,!1,s);break;case"Matrix4fv":t.uniformMatrix4fv(a,!1,s);break;case"i":t.uniform1i(a,s);break;case"f":t.uniform1f(a,s);break;case"v2":t.uniform2f(a,s.x,s.y);break;case"v3":t.uniform3f(a,s.x,s.y,s.z);break;case"v4":t.uniform4f(a,s.x,s.y,s.z,s.w);break;case"c":t.uniform3f(a,s.r,s.g,s.b);break;case"iv1":t.uniform1iv(a,s);break;case"iv":t.uniform3iv(a,s);break;case"fv1":t.uniform1fv(a,s);break;case"fv":t.uniform3fv(a,s);break;case"v2v":void 0===i._array&&(i._array=new Float32Array(2*s.length));for(o=0,r=s.length;r>o;o++)l=2*o,i._array[l]=s[o].x,i._array[l+1]=s[o].y;t.uniform2fv(a,i._array);break;case"v3v":void 0===i._array&&(i._array=new Float32Array(3*s.length));for(o=0,r=s.length;r>o;o++)l=3*o,i._array[l]=s[o].x,i._array[l+1]=s[o].y,i._array[l+2]=s[o].z;t.uniform3fv(a,i._array);break;case"v4v":void 0===i._array&&(i._array=new Float32Array(4*s.length));for(o=0,r=s.length;r>o;o++)l=4*o,i._array[l]=s[o].x,i._array[l+1]=s[o].y,i._array[l+2]=s[o].z,i._array[l+3]=s[o].w;t.uniform4fv(a,i._array);break;case"m3":t.uniformMatrix3fv(a,!1,s.elements);break;case"m3v":void 0===i._array&&(i._array=new Float32Array(9*s.length));for(o=0,r=s.length;r>o;o++)s[o].flattenToArrayOffset(i._array,9*o);t.uniformMatrix3fv(a,!1,i._array);break;case"m4":t.uniformMatrix4fv(a,!1,s.elements);break;case"m4v":void 0===i._array&&(i._array=new Float32Array(16*s.length));for(o=0,r=s.length;r>o;o++)s[o].flattenToArrayOffset(i._array,16*o);t.uniformMatrix4fv(a,!1,i._array);break;case"t":if(c=s,d=q(),t.uniform1i(a,d),!c)continue;c instanceof THREE.CubeTexture||c.image instanceof Array&&6===c.image.length?rt(c,d):c instanceof THREE.WebGLRenderTargetCube?st(c,d):n.setTexture(c,d);break;case"tv":void 0===i._array&&(i._array=[]);for(o=0,r=i.value.length;r>o;o++)i._array[o]=q();t.uniform1iv(a,i._array);for(o=0,r=i.value.length;r>o;o++)c=i.value[o],d=i._array[o],c&&n.setTexture(c,d);break;default:THREE.warn("THREE.WebGLRenderer: Unknown uniform type: "+m)}}}function re(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function x(e,t,n,s){e[t]=n.r*s,e[t+1]=n.g*s,e[t+2]=n.b*s}function ct(e){var t,n,o,l,d,k,T,z,D=0,F=0,M=0,s=de,v=s.directional.colors,O=s.directional.positions,y=s.point.colors,b=s.point.positions,H=s.point.distances,P=s.point.decays,_=s.spot.colors,w=s.spot.positions,B=s.spot.distances,C=s.spot.directions,V=s.spot.anglesCos,$=s.spot.exponents,I=s.spot.decays,S=s.hemi.skyColors,E=s.hemi.groundColors,A=s.hemi.positions,g=0,u=0,r=0,p=0,L=0,R=0,N=0,j=0,f=0,m=0,c=0,h=0;for(n=0,o=e.length;o>n;n++)if(t=e[n],!t.onlyShadow)if(l=t.color,d=t.intensity,k=t.distance,t instanceof THREE.AmbientLight){if(!t.visible)continue;D+=l.r,F+=l.g,M+=l.b}else if(t instanceof THREE.DirectionalLight){if(L+=1,!t.visible)continue;i.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),i.sub(a),i.normalize(),f=3*g,O[f]=i.x,O[f+1]=i.y,O[f+2]=i.z,x(v,f,l,d),g+=1}else if(t instanceof THREE.PointLight){if(R+=1,!t.visible)continue;m=3*u,x(y,m,l,d),a.setFromMatrixPosition(t.matrixWorld),b[m]=a.x,b[m+1]=a.y,b[m+2]=a.z,H[u]=k,P[u]=0===t.distance?0:t.decay,u+=1}else if(t instanceof THREE.SpotLight){if(N+=1,!t.visible)continue;c=3*r,x(_,c,l,d),i.setFromMatrixPosition(t.matrixWorld),w[c]=i.x,w[c+1]=i.y,w[c+2]=i.z,B[r]=k,a.setFromMatrixPosition(t.target.matrixWorld),i.sub(a),i.normalize(),C[c]=i.x,C[c+1]=i.y,C[c+2]=i.z,V[r]=Math.cos(t.angle),$[r]=t.exponent,I[r]=0===t.distance?0:t.decay,r+=1}else if(t instanceof THREE.HemisphereLight){if(j+=1,!t.visible)continue;i.setFromMatrixPosition(t.matrixWorld),i.normalize(),h=3*p,A[h]=i.x,A[h+1]=i.y,A[h+2]=i.z,T=t.color,z=t.groundColor,x(S,h,T,d),x(E,h,z,d),p+=1}for(n=3*g,o=Math.max(v.length,3*L);o>n;n++)v[n]=0;for(n=3*u,o=Math.max(y.length,3*R);o>n;n++)y[n]=0;for(n=3*r,o=Math.max(_.length,3*N);o>n;n++)_[n]=0;for(n=3*p,o=Math.max(S.length,3*j);o>n;n++)S[n]=0;for(n=3*p,o=Math.max(E.length,3*j);o>n;n++)E[n]=0;s.directional.length=g,s.point.length=u,s.spot.length=r,s.hemi.length=p,s.ambient[0]=D,s.ambient[1]=F,s.ambient[2]=M}function D(e,s,i){var a;i?(t.texParameteri(e,t.TEXTURE_WRAP_S,d(s.wrapS)),t.texParameteri(e,t.TEXTURE_WRAP_T,d(s.wrapT)),t.texParameteri(e,t.TEXTURE_MAG_FILTER,d(s.magFilter)),t.texParameteri(e,t.TEXTURE_MIN_FILTER,d(s.minFilter))):(t.texParameteri(e,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(e,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(s.wrapS!==THREE.ClampToEdgeWrapping||s.wrapT!==THREE.ClampToEdgeWrapping)&&THREE.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+s.sourceFile+" )"),t.texParameteri(e,t.TEXTURE_MAG_FILTER,ie(s.magFilter)),t.texParameteri(e,t.TEXTURE_MIN_FILTER,ie(s.minFilter)),s.minFilter!==THREE.NearestFilter&&s.minFilter!==THREE.LinearFilter&&THREE.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+s.sourceFile+" )")),a=o.get("EXT_texture_filter_anisotropic"),a&&s.type!==THREE.FloatType&&s.type!==THREE.HalfFloatType&&(s.anisotropy>1||s.__currentAnisotropy)&&(t.texParameterf(e,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,n.getMaxAnisotropy())),s.__currentAnisotropy=s.anisotropy)}function he(e,t){if(e.width>t||e.height>t){var o,s=t/Math.max(e.width,e.height),n=document.createElement("canvas");return n.width=Math.floor(e.width*s),n.height=Math.floor(e.height*s),o=n.getContext("2d"),o.drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),THREE.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function rt(e,s){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",$),e.image.__webglTextureCube=t.createTexture(),n.info.memory.textures++),t.activeTexture(t.TEXTURE0+s),t.bindTexture(t.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var h=e instanceof THREE.CompressedTexture,l=e.image[0]instanceof THREE.DataTexture,i=[],o=0;6>o;o++)!n.autoScaleCubemaps||h||l?i[o]=l?e.image[o].image:e.image[o]:i[o]=he(e.image[o],at);var m=i[0],f=THREE.Math.isPowerOfTwo(m.width)&&THREE.Math.isPowerOfTwo(m.height),a=d(e.format),u=d(e.type);D(t.TEXTURE_CUBE_MAP,e,f);for(o=0;6>o;o++)if(h)for(var r,p=i[o].mipmaps,c=0,g=p.length;g>c;c++)r=p[c],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?oe().indexOf(a)>-1?t.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+o,c,a,r.width,r.height,0,r.data):THREE.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+o,c,a,r.width,r.height,0,a,u,r.data);else l?t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,a,i[o].width,i[o].height,0,a,u,i[o].data):t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,a,a,u,i[o]);e.generateMipmaps&&f&&t.generateMipmap(t.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else t.activeTexture(t.TEXTURE0+s),t.bindTexture(t.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function st(e,n){t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture)}function ne(e,n,s){t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,s,n.__webglTexture,0)}function se(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height)}function Ae(e){e instanceof THREE.WebGLRenderTargetCube?(t.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture),t.generateMipmap(t.TEXTURE_CUBE_MAP),t.bindTexture(t.TEXTURE_CUBE_MAP,null)):(t.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null))}function ie(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?t.NEAREST:t.LINEAR}function d(e){var n;if(e===THREE.RepeatWrapping)return t.REPEAT;if(e===THREE.ClampToEdgeWrapping)return t.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return t.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return t.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return t.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return t.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return t.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return t.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return t.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return t.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return t.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return t.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return t.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return t.BYTE;if(e===THREE.ShortType)return t.SHORT;if(e===THREE.UnsignedShortType)return t.UNSIGNED_SHORT;if(e===THREE.IntType)return t.INT;if(e===THREE.UnsignedIntType)return t.UNSIGNED_INT;if(e===THREE.FloatType)return t.FLOAT;if(n=o.get("OES_texture_half_float"),null!==n&&e===THREE.HalfFloatType)return n.HALF_FLOAT_OES;if(e===THREE.AlphaFormat)return t.ALPHA;if(e===THREE.RGBFormat)return t.RGB;if(e===THREE.RGBAFormat)return t.RGBA;if(e===THREE.LuminanceFormat)return t.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return t.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return t.FUNC_ADD;if(e===THREE.SubtractEquation)return t.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return t.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return t.ZERO;if(e===THREE.OneFactor)return t.ONE;if(e===THREE.SrcColorFactor)return t.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return t.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return t.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return t.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return t.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return t.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return t.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return t.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return t.SRC_ALPHA_SATURATE;if(n=o.get("WEBGL_compressed_texture_s3tc"),null!==n){if(e===THREE.RGB_S3TC_DXT1_Format)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n=o.get("WEBGL_compressed_texture_pvrtc"),null!==n){if(e===THREE.RGB_PVRTC_4BPPV1_Format)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===THREE.RGB_PVRTC_2BPPV1_Format)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===THREE.RGBA_PVRTC_4BPPV1_Format)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===THREE.RGBA_PVRTC_2BPPV1_Format)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n=o.get("EXT_blend_minmax"),null!==n){if(e===THREE.MinEquation)return n.MIN_EXT;if(e===THREE.MaxEquation)return n.MAX_EXT}return 0}function et(e){if(Q&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var s=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),o=Math.floor((s-20)/4),n=o;return void 0!==e&&e instanceof THREE.SkinnedMesh&&(n=Math.min(e.skeleton.bones.length,n),n<e.skeleton.bones.length&&THREE.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+n+" (try OpenGL instead of ANGLE)")),n}function ke(e){for(var t,s=0,o=0,i=0,a=0,n=0,r=e.length;r>n;n++)t=e[n],t.onlyShadow||t.visible===!1||(t instanceof THREE.DirectionalLight&&s++,t instanceof THREE.PointLight&&o++,t instanceof THREE.SpotLight&&i++,t instanceof THREE.HemisphereLight&&a++);return{directional:s,point:o,spot:i,hemi:a}}function Qe(e){for(var t,n=0,s=0,o=e.length;o>s;s++)t=e[s],t.castShadow&&(t instanceof THREE.SpotLight&&n++,t instanceof THREE.DirectionalLight&&!t.shadowCascade&&n++);return n}console.log("THREE.WebGLRenderer",THREE.REVISION),e=e||{};var s,o,Y,c=void 0!==e.canvas?e.canvas:document.createElement("canvas"),Ke=void 0!==e.context?e.context:null,r=1,v=void 0!==e.precision?e.precision:"highp",We=void 0!==e.alpha&&e.alpha,$e=void 0===e.depth||e.depth,Pe=void 0===e.stencil||e.stencil,De=void 0!==e.antialias&&e.antialias,be=void 0===e.premultipliedAlpha||e.premultipliedAlpha,ze=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,I=void 0!==e.logarithmicDepthBuffer&&e.logarithmicDepthBuffer,l=new THREE.Color(0),j=0,u=[],f={},g=[],_=[],y=[],X=[],R=[];this.domElement=c,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var t,n=this,h=[],B=null,A=null,w=-1,p="",O=null,V=0,S=0,M=0,F=c.width,C=c.height,pe=0,fe=0,U=new THREE.Frustum,K=new THREE.Matrix4,a=new THREE.Vector3,i=new THREE.Vector3,z=!0,de={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{if(Y={alpha:We,depth:$e,stencil:Pe,antialias:De,premultipliedAlpha:be,preserveDrawingBuffer:ze},t=Ke||c.getContext("webgl",Y)||c.getContext("experimental-webgl",Y),null===t)throw null!==c.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";c.addEventListener("webglcontextlost",function(e){e.preventDefault(),J(),ae(),f={}},!1)}catch(e){THREE.error("THREE.WebGLRenderer: "+e)}s=new THREE.WebGLState(t,d),void 0===t.getShaderPrecisionFormat&&(t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),o=new THREE.WebGLExtensions(t),o.get("OES_texture_float"),o.get("OES_texture_float_linear"),o.get("OES_texture_half_float"),o.get("OES_texture_half_float_linear"),o.get("OES_standard_derivatives"),I&&o.get("EXT_frag_depth");var G=function(e,n,s,o){be===!0&&(e*=o,n*=o,s*=o),t.clearColor(e,n,s,o)},ae=function(){t.clearColor(0,0,0,1),t.clearDepth(1),t.clearStencil(0),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),t.enable(t.CULL_FACE),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.viewport(S,M,F,C),G(l.r,l.g,l.b,j)},J=function(){B=null,O=null,p="",w=-1,z=!0,s.reset()};ae(),this.context=t,this.state=s;var te=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ot=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),it=t.getParameter(t.MAX_TEXTURE_SIZE),at=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),L=ot>0,Q=L&&o.get("OES_texture_float"),lt=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT),dt=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT),ut=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT),ht=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT),oe=function(){var e;return function(){if(void 0!==e)return e;if(e=[],o.get("WEBGL_compressed_texture_pvrtc")||o.get("WEBGL_compressed_texture_s3tc"))for(var s=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<s.length;n++)e.push(s[n]);return e}}(),ft=lt.precision>0&&ut.precision>0,le=dt.precision>0&&ht.precision>0;"highp"!==v||ft||(le?(v="mediump",THREE.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(v="lowp",THREE.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==v||le||(v="lowp",THREE.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var gt=new THREE.ShadowMapPlugin(this,u,f,g),vt=new THREE.SpritePlugin(this,X),bt=new THREE.LensFlarePlugin(this,R);this.getContext=function(){return t},this.forceContextLoss=function(){o.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return L},this.supportsFloatTextures=function(){return o.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return o.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return o.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return o.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return o.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return o.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var e;return function(){if(void 0!==e)return e;var n=o.get("EXT_texture_filter_anisotropic");return e=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return v},this.getPixelRatio=function(){return r},this.setPixelRatio=function(e){r=e},this.setSize=function(e,t,n){c.width=e*r,c.height=t*r,n!==!1&&(c.style.width=e+"px",c.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,n,s,o){S=e*r,M=n*r,F=s*r,C=o*r,t.viewport(S,M,F,C)},this.setScissor=function(e,n,s,o){t.scissor(e*r,n*r,s*r,o*r)},this.enableScissorTest=function(e){e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)},this.getClearColor=function(){return l},this.setClearColor=function(e,t){l.set(e),j=void 0!==t?t:1,G(l.r,l.g,l.b,j)},this.getClearAlpha=function(){return j},this.setClearAlpha=function(e){j=e,G(l.r,l.g,l.b,j)},this.clear=function(e,n,s){var o=0;(void 0===e||e)&&(o|=t.COLOR_BUFFER_BIT),(void 0===n||n)&&(o|=t.DEPTH_BUFFER_BIT),(void 0===s||s)&&(o|=t.STENCIL_BUFFER_BIT),t.clear(o)},this.clearColor=function(){t.clear(t.COLOR_BUFFER_BIT)},this.clearDepth=function(){t.clear(t.DEPTH_BUFFER_BIT)},this.clearStencil=function(){t.clear(t.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,n,s){this.setRenderTarget(e),this.clear(t,n,s)},this.resetGLState=J;var ue=function(e){var t=e.target;t.traverse(function(e){e.removeEventListener("remove",ue),Ue(e)})},ee=function(e){var t=e.target;t.removeEventListener("dispose",ee),Ct(t)},$=function(e){var t=e.target;t.removeEventListener("dispose",$),Et(t),n.info.memory.textures--},ge=function(e){var t=e.target;t.removeEventListener("dispose",ge),kt(t),n.info.memory.textures--},je=function(e){var t=e.target;t.removeEventListener("dispose",je),_e(t)},ye=function(e){for(var s,i=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"],o=0,a=i.length;a>o;o++)s=i[o],void 0!==e[s]&&(t.deleteBuffer(e[s]),delete e[s]);if(void 0!==e.__webglCustomAttributesList){for(s in e.__webglCustomAttributesList)t.deleteBuffer(e.__webglCustomAttributesList[s].buffer);delete e.__webglCustomAttributesList}n.info.memory.geometries--},Ct=function(e){if(delete e.__webglInit,e instanceof THREE.BufferGeometry){for(l in e.attributes)i=e.attributes[l],void 0!==i.buffer&&(t.deleteBuffer(i.buffer),delete i.buffer);n.info.memory.geometries--}else if(a=b[e.id],void 0!==a){for(var s,o,i,a,r,l,c=0,d=a.length;d>c;c++){if(s=a[c],void 0!==s.numMorphTargets){for(o=0,r=s.numMorphTargets;r>o;o++)t.deleteBuffer(s.__webglMorphTargetsBuffers[o]);delete s.__webglMorphTargetsBuffers}if(void 0!==s.numMorphNormals){for(o=0,r=s.numMorphNormals;r>o;o++)t.deleteBuffer(s.__webglMorphNormalsBuffers[o]);delete s.__webglMorphNormalsBuffers}ye(s)}delete b[e.id]}else ye(e);p=""},Et=function(e){if(e.image&&e.image.__webglTextureCube)t.deleteTexture(e.image.__webglTextureCube),delete e.image.__webglTextureCube;else{if(void 0===e.__webglInit)return;t.deleteTexture(e.__webglTexture),delete e.__webglTexture,delete e.__webglInit}},kt=function(e){if(e&&void 0!==e.__webglTexture){if(t.deleteTexture(e.__webglTexture),delete e.__webglTexture,e instanceof THREE.WebGLRenderTargetCube)for(var n=0;6>n;n++)t.deleteFramebuffer(e.__webglFramebuffer[n]),t.deleteRenderbuffer(e.__webglRenderbuffer[n]);else t.deleteFramebuffer(e.__webglFramebuffer),t.deleteRenderbuffer(e.__webglRenderbuffer);delete e.__webglFramebuffer,delete e.__webglRenderbuffer}},_e=function(e){var s,o,a,r,c,i=e.program.program;if(void 0!==i){e.program=void 0,r=!1;for(s=0,a=h.length;a>s;s++)if(o=h[s],o.program===i){o.usedTimes--,0===o.usedTimes&&(r=!0);break}if(r===!0){c=[];for(s=0,a=h.length;a>s;s++)o=h[s],o.program!==i&&c.push(o);h=c,t.deleteProgram(i),n.info.memory.programs--}}};this.renderBufferImmediate=function(e,n,o){if(s.initAttributes(),e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=t.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=t.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=t.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=t.createBuffer()),e.hasPositions&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglVertexBuffer),t.bufferData(t.ARRAY_BUFFER,e.positionArray,t.DYNAMIC_DRAW),s.enableAttribute(n.attributes.position),t.vertexAttribPointer(n.attributes.position,3,t.FLOAT,!1,0,0)),e.hasNormals){if(t.bindBuffer(t.ARRAY_BUFFER,e.__webglNormalBuffer),o instanceof THREE.MeshPhongMaterial==!1&&o.shading===THREE.FlatShading){var i,a,r,c,l,d,u,h,m,f,p,g,v,b,j=3*e.count;for(i=0;j>i;i+=9)a=e.normalArray,b=a[i],d=a[i+1],f=a[i+2],v=a[i+3],h=a[i+4],p=a[i+5],u=a[i+6],m=a[i+7],g=a[i+8],r=(b+v+u)/3,c=(d+h+m)/3,l=(f+p+g)/3,a[i]=r,a[i+1]=c,a[i+2]=l,a[i+3]=r,a[i+4]=c,a[i+5]=l,a[i+6]=r,a[i+7]=c,a[i+8]=l}t.bufferData(t.ARRAY_BUFFER,e.normalArray,t.DYNAMIC_DRAW),s.enableAttribute(n.attributes.normal),t.vertexAttribPointer(n.attributes.normal,3,t.FLOAT,!1,0,0)}e.hasUvs&&o.map&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglUvBuffer),t.bufferData(t.ARRAY_BUFFER,e.uvArray,t.DYNAMIC_DRAW),s.enableAttribute(n.attributes.uv),t.vertexAttribPointer(n.attributes.uv,2,t.FLOAT,!1,0,0)),e.hasColors&&o.vertexColors!==THREE.NoColors&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,e.colorArray,t.DYNAMIC_DRAW),s.enableAttribute(n.attributes.color),t.vertexAttribPointer(n.attributes.color,3,t.FLOAT,!1,0,0)),s.disableUnusedAttributes(),t.drawArrays(t.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,i,a,c,l,d){if(c.visible!==!1){we(d);var u,h,f,g,v,j,y,w,O,_=N(e,i,a,c,d),b=!1,C=c.wireframe?1:0,x="direct_"+l.id+"_"+_.id+"_"+C;if(x!==p&&(p=x,b=!0),b&&s.initAttributes(),d instanceof THREE.Mesh)if(v=c.wireframe===!0?t.LINES:t.TRIANGLES,f=l.attributes.index,f)if(f.array instanceof Uint32Array&&o.get("OES_element_index_uint")?(g=t.UNSIGNED_INT,y=4):(g=t.UNSIGNED_SHORT,y=2),u=l.offsets,0===u.length)b&&(m(c,_,l,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.buffer)),t.drawElements(v,f.array.length,g,0),n.info.render.calls++,n.info.render.vertices+=f.array.length,n.info.render.faces+=f.array.length/3;else{b=!0;for(h=0,w=u.length;w>h;h++)O=u[h].index,b&&(m(c,_,l,O),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.buffer)),t.drawElements(v,u[h].count,g,u[h].start*y),n.info.render.calls++,n.info.render.vertices+=u[h].count,n.info.render.faces+=u[h].count/3}else b&&m(c,_,l,0),j=l.attributes.position,t.drawArrays(v,0,j.array.length/j.itemSize),n.info.render.calls++,n.info.render.vertices+=j.array.length/j.itemSize,n.info.render.faces+=j.array.length/(3*j.itemSize);else if(d instanceof THREE.PointCloud)if(v=t.POINTS,f=l.attributes.index,f)if(f.array instanceof Uint32Array&&o.get("OES_element_index_uint")?(g=t.UNSIGNED_INT,y=4):(g=t.UNSIGNED_SHORT,y=2),u=l.offsets,0===u.length)b&&(m(c,_,l,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.buffer)),t.drawElements(v,f.array.length,g,0),n.info.render.calls++,n.info.render.points+=f.array.length;else{u.length>1&&(b=!0);for(h=0,w=u.length;w>h;h++)O=u[h].index,b&&(m(c,_,l,O),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.buffer)),t.drawElements(v,u[h].count,g,u[h].start*y),n.info.render.calls++,n.info.render.points+=u[h].count}else if(b&&m(c,_,l,0),j=l.attributes.position,u=l.offsets,0===u.length)t.drawArrays(v,0,j.array.length/3),n.info.render.calls++,n.info.render.points+=j.array.length/3;else for(h=0,w=u.length;w>h;h++)t.drawArrays(v,u[h].index,u[h].count),n.info.render.calls++,n.info.render.points+=u[h].count;else if(d instanceof THREE.Line)if(v=d.mode===THREE.LineStrip?t.LINE_STRIP:t.LINES,s.setLineWidth(c.linewidth*r),f=l.attributes.index,f)if(f.array instanceof Uint32Array?(g=t.UNSIGNED_INT,y=4):(g=t.UNSIGNED_SHORT,y=2),u=l.offsets,0===u.length)b&&(m(c,_,l,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.buffer)),t.drawElements(v,f.array.length,g,0),n.info.render.calls++,n.info.render.vertices+=f.array.length;else{u.length>1&&(b=!0);for(h=0,w=u.length;w>h;h++)O=u[h].index,b&&(m(c,_,l,O),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,f.buffer)),t.drawElements(v,u[h].count,g,u[h].start*y),n.info.render.calls++,n.info.render.vertices+=u[h].count}else if(b&&m(c,_,l,0),j=l.attributes.position,u=l.offsets,0===u.length)t.drawArrays(v,0,j.array.length/3),n.info.render.calls++,n.info.render.vertices+=j.array.length/3;else for(h=0,w=u.length;w>h;h++)t.drawArrays(v,u[h].index,u[h].count),n.info.render.calls++,n.info.render.vertices+=u[h].count}},this.renderBuffer=function(e,o,i,a,c,l){if(a.visible!==!1){we(l);var h,m,f,b,j,g=N(e,o,i,a,l),d=g.attributes,u=!1,y=a.wireframe?1:0,v=c.id+"_"+g.id+"_"+y;if(v!==p&&(p=v,u=!0),u&&s.initAttributes(),!a.morphTargets&&d.position>=0?u&&(t.bindBuffer(t.ARRAY_BUFFER,c.__webglVertexBuffer),s.enableAttribute(d.position),t.vertexAttribPointer(d.position,3,t.FLOAT,!1,0,0)):l.morphTargetBase&&Re(a,c,l),u){if(c.__webglCustomAttributesList)for(m=0,b=c.__webglCustomAttributesList.length;b>m;m++)h=c.__webglCustomAttributesList[m],d[h.buffer.belongsToAttribute]>=0&&(t.bindBuffer(t.ARRAY_BUFFER,h.buffer),s.enableAttribute(d[h.buffer.belongsToAttribute]),t.vertexAttribPointer(d[h.buffer.belongsToAttribute],h.size,t.FLOAT,!1,0,0));d.color>=0&&(l.geometry.colors.length>0||l.geometry.faces.length>0?(t.bindBuffer(t.ARRAY_BUFFER,c.__webglColorBuffer),s.enableAttribute(d.color),t.vertexAttribPointer(d.color,3,t.FLOAT,!1,0,0)):void 0!==a.defaultAttributeValues&&t.vertexAttrib3fv(d.color,a.defaultAttributeValues.color)),d.normal>=0&&(t.bindBuffer(t.ARRAY_BUFFER,c.__webglNormalBuffer),s.enableAttribute(d.normal),t.vertexAttribPointer(d.normal,3,t.FLOAT,!1,0,0)),d.tangent>=0&&(t.bindBuffer(t.ARRAY_BUFFER,c.__webglTangentBuffer),s.enableAttribute(d.tangent),t.vertexAttribPointer(d.tangent,4,t.FLOAT,!1,0,0)),d.uv>=0&&(l.geometry.faceVertexUvs[0]?(t.bindBuffer(t.ARRAY_BUFFER,c.__webglUVBuffer),s.enableAttribute(d.uv),t.vertexAttribPointer(d.uv,2,t.FLOAT,!1,0,0)):void 0!==a.defaultAttributeValues&&t.vertexAttrib2fv(d.uv,a.defaultAttributeValues.uv)),d.uv2>=0&&(l.geometry.faceVertexUvs[1]?(t.bindBuffer(t.ARRAY_BUFFER,c.__webglUV2Buffer),s.enableAttribute(d.uv2),t.vertexAttribPointer(d.uv2,2,t.FLOAT,!1,0,0)):void 0!==a.defaultAttributeValues&&t.vertexAttrib2fv(d.uv2,a.defaultAttributeValues.uv2)),a.skinning&&d.skinIndex>=0&&d.skinWeight>=0&&(t.bindBuffer(t.ARRAY_BUFFER,c.__webglSkinIndicesBuffer),s.enableAttribute(d.skinIndex),t.vertexAttribPointer(d.skinIndex,4,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,c.__webglSkinWeightsBuffer),s.enableAttribute(d.skinWeight),t.vertexAttribPointer(d.skinWeight,4,t.FLOAT,!1,0,0)),d.lineDistance>=0&&(t.bindBuffer(t.ARRAY_BUFFER,c.__webglLineDistanceBuffer),s.enableAttribute(d.lineDistance),t.vertexAttribPointer(d.lineDistance,1,t.FLOAT,!1,0,0))}s.disableUnusedAttributes(),l instanceof THREE.Mesh?(f=c.__typeArray===Uint32Array?t.UNSIGNED_INT:t.UNSIGNED_SHORT,a.wireframe?(s.setLineWidth(a.wireframeLinewidth*r),u&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,c.__webglLineBuffer),t.drawElements(t.LINES,c.__webglLineCount,f,0)):(u&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,c.__webglFaceBuffer),t.drawElements(t.TRIANGLES,c.__webglFaceCount,f,0)),n.info.render.calls++,n.info.render.vertices+=c.__webglFaceCount,n.info.render.faces+=c.__webglFaceCount/3):l instanceof THREE.Line?(j=l.mode===THREE.LineStrip?t.LINE_STRIP:t.LINES,s.setLineWidth(a.linewidth*r),t.drawArrays(j,0,c.__webglLineCount),n.info.render.calls++):l instanceof THREE.PointCloud&&(t.drawArrays(t.POINTS,0,c.__webglParticleCount),n.info.render.calls++,n.info.render.points+=c.__webglParticleCount)}},this.render=function(e,t,o,i){if(t instanceof THREE.Camera==!1)return void THREE.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");a=e.fog,p="",w=-1,O=null,z=!0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),e.traverse(function(e){e instanceof THREE.SkinnedMesh&&e.skeleton.update()}),t.matrixWorldInverse.getInverse(t.matrixWorld),K.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromMatrix(K),u.length=0,_.length=0,y.length=0,X.length=0,R.length=0,Oe(e),n.sortObjects===!0&&(_.sort(Le),y.sort(Ne)),gt.render(e,t),n.info.render.calls=0,n.info.render.vertices=0,n.info.render.faces=0,n.info.render.points=0,this.setRenderTarget(o),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);for(var a,r,l,d,c=0,h=g.length;h>c;c++)l=g[c],d=l.object,d.visible&&(re(d,t),Me(l));e.overrideMaterial?(r=e.overrideMaterial,Z(r),k(_,t,u,a,r),k(y,t,u,a,r),P(g,"",t,u,a,r)):(s.setBlending(THREE.NoBlending),k(_,t,u,a,null),P(g,"opaque",t,u,a,null),k(y,t,u,a,null),P(g,"transparent",t,u,a,null)),vt.render(e,t),bt.render(e,t,pe,fe),o&&o.generateMipmaps&&o.minFilter!==THREE.NearestFilter&&o.minFilter!==THREE.LinearFilter&&Ae(o),s.setDepthTest(!0),s.setDepthWrite(!0),s.setColorWrite(!0)},this.renderImmediateObject=function(e,s,o,i,a){var r=N(e,s,o,i,a);p="",n.setMaterialFaces(i),a.immediateRenderCallback?a.immediateRenderCallback(r,t,U):a.render(function(e){n.renderBufferImmediate(e,r,i)})};var b={},Ce=0,Ft={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};this.setFaceCulling=function(e,n){e===THREE.CullFaceNone?t.disable(t.CULL_FACE):(n===THREE.FrontFaceDirectionCW?t.frontFace(t.CW):t.frontFace(t.CCW),e===THREE.CullFaceBack?t.cullFace(t.BACK):e===THREE.CullFaceFront?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK),t.enable(t.CULL_FACE))},this.setMaterialFaces=function(e){s.setDoubleSided(e.side===THREE.DoubleSide),s.setFlipSided(e.side===THREE.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",$),e.__webglTexture=t.createTexture(),n.info.memory.textures++),t.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=he(e.image,it);var s,o,a,r,c=e.image,u=THREE.Math.isPowerOfTwo(c.width)&&THREE.Math.isPowerOfTwo(c.height),i=d(e.format),l=d(e.type);if(D(t.TEXTURE_2D,e,u),a=e.mipmaps,e instanceof THREE.DataTexture)if(a.length>0&&u){for(s=0,r=a.length;r>s;s++)o=a[s],t.texImage2D(t.TEXTURE_2D,s,i,o.width,o.height,0,i,l,o.data);e.generateMipmaps=!1}else t.texImage2D(t.TEXTURE_2D,0,i,c.width,c.height,0,i,l,c.data);else if(e instanceof THREE.CompressedTexture)for(s=0,r=a.length;r>s;s++)o=a[s],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?oe().indexOf(i)>-1?t.compressedTexImage2D(t.TEXTURE_2D,s,i,o.width,o.height,0,o.data):THREE.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(t.TEXTURE_2D,s,i,o.width,o.height,0,i,l,o.data);else if(a.length>0&&u){for(s=0,r=a.length;r>s;s++)o=a[s],t.texImage2D(t.TEXTURE_2D,s,i,i,l,o);e.generateMipmaps=!1}else t.texImage2D(t.TEXTURE_2D,0,i,i,l,e.image);e.generateMipmaps&&u&&t.generateMipmap(t.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,s){t.activeTexture(t.TEXTURE0+s),e.needsUpdate?n.uploadTexture(e):t.bindTexture(t.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){if(i=e instanceof THREE.WebGLRenderTargetCube,e&&void 0===e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",ge),e.__webglTexture=t.createTexture(),n.info.memory.textures++;var s,o,i,c,l,u,h,a=THREE.Math.isPowerOfTwo(e.width)&&THREE.Math.isPowerOfTwo(e.height),r=d(e.format),m=d(e.type);if(i){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],t.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture),D(t.TEXTURE_CUBE_MAP,e,a);for(s=0;6>s;s++)e.__webglFramebuffer[s]=t.createFramebuffer(),e.__webglRenderbuffer[s]=t.createRenderbuffer(),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,r,e.width,e.height,0,r,m,null),ne(e.__webglFramebuffer[s],e,t.TEXTURE_CUBE_MAP_POSITIVE_X+s),se(e.__webglRenderbuffer[s],e);a&&t.generateMipmap(t.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=t.createFramebuffer(),e.shareDepthFrom?e.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer:e.__webglRenderbuffer=t.createRenderbuffer(),t.bindTexture(t.TEXTURE_2D,e.__webglTexture),D(t.TEXTURE_2D,e,a),t.texImage2D(t.TEXTURE_2D,0,r,e.width,e.height,0,r,m,null),ne(e.__webglFramebuffer,e,t.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e.__webglRenderbuffer):se(e.__webglRenderbuffer,e),a&&t.generateMipmap(t.TEXTURE_2D);i?t.bindTexture(t.TEXTURE_CUBE_MAP,null):t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}e?(o=i?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,c=e.width,l=e.height,u=0,h=0):(o=null,c=F,l=C,u=S,h=M),o!==A&&(t.bindFramebuffer(t.FRAMEBUFFER,o),t.viewport(u,h,c,l),A=o),pe=c,fe=l},this.readRenderTargetPixels=function(e,n,s,o,i,a){if(!(e instanceof THREE.WebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");if(e.__webglFramebuffer){if(e.format!==THREE.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var r=!1;e.__webglFramebuffer!==A&&(t.bindFramebuffer(t.FRAMEBUFFER,e.__webglFramebuffer),r=!0),t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE?t.readPixels(n,s,o,i,t.RGBA,t.UNSIGNED_BYTE,a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),r&&t.bindFramebuffer(t.FRAMEBUFFER,A)}},this.initMaterial=function(){THREE.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){THREE.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){THREE.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){THREE.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},THREE.WebGLRenderTarget=function(e,t,n){this.width=e,this.height=t,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:THREE.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==n.format?n.format:THREE.RGBAFormat,this.type=void 0!==n.type?n.type:THREE.UnsignedByteType,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==n.shareDepthFrom?n.shareDepthFrom:null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(e,t){this.width=e,this.height=t},clone:function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(e,t,n){THREE.WebGLRenderTarget.call(this,e,t,n),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.WebGLExtensions=function(e){var t={};this.get=function(n){if(void 0!==t[n])return t[n];var s;switch(n){case"EXT_texture_filter_anisotropic":s=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=e.getExtension(n)}return null===s&&THREE.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=s,s}},THREE.WebGLProgram=function(){var e=0,t=function(e){var t,n,o,s=[];for(o in e)t=e[o],t!==!1&&(n="#define "+o+" "+t,s.push(n));return s.join(`
`)},n=function(e,t,n){for(var o,i={},s=0,a=n.length;a>s;s++)o=n[s],i[o]=e.getUniformLocation(t,o);return i},s=function(e,t,n){for(var o,i={},s=0,a=n.length;a>s;s++)o=n[s],i[o]=e.getAttribLocation(t,o);return i};return function(o,i,a,r){var l,u,m,f,p,g,S,F,h=o,c=h.context,M=a.defines,A=a.__webglShader.uniforms,k=a.attributes,E=a.__webglShader.vertexShader,C=a.__webglShader.fragmentShader,v=a.index0AttributeName;void 0===v&&r.morphTargets===!0&&(v="position"),m="SHADOWMAP_TYPE_BASIC",r.shadowMapType===THREE.PCFShadowMap?m="SHADOWMAP_TYPE_PCF":r.shadowMapType===THREE.PCFSoftShadowMap&&(m="SHADOWMAP_TYPE_PCF_SOFT");var b="ENVMAP_TYPE_CUBE",w="ENVMAP_MODE_REFLECTION",j="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(a.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:b="ENVMAP_TYPE_CUBE";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:b="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:b="ENVMAP_TYPE_SPHERE"}switch(a.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:w="ENVMAP_MODE_REFRACTION"}switch(a.combine){case THREE.MultiplyOperation:j="ENVMAP_BLENDING_MULTIPLY";break;case THREE.MixOperation:j="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:j="ENVMAP_BLENDING_ADD"}}var y,_,O=o.gammaFactor>0?o.gammaFactor:1,x=t(M),d=c.createProgram();a instanceof THREE.RawShaderMaterial?(y="",_=""):(y=["precision "+r.precision+" float;","precision "+r.precision+" int;",x,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",h.gammaInput?"#define GAMMA_INPUT":"",h.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+O,"#define MAX_DIR_LIGHTS "+r.maxDirLights,"#define MAX_POINT_LIGHTS "+r.maxPointLights,"#define MAX_SPOT_LIGHTS "+r.maxSpotLights,"#define MAX_HEMI_LIGHTS "+r.maxHemiLights,"#define MAX_SHADOWS "+r.maxShadows,"#define MAX_BONES "+r.maxBones,r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+w:"",r.lightMap?"#define USE_LIGHTMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals?"#define USE_MORPHNORMALS":"",r.wrapAround?"#define WRAP_AROUND":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+m:"",r.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",r.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",""].join(`
`),_=["precision "+r.precision+" float;","precision "+r.precision+" int;",r.bumpMap||r.normalMap||r.flatShading?"#extension GL_OES_standard_derivatives : enable":"",x,"#define MAX_DIR_LIGHTS "+r.maxDirLights,"#define MAX_POINT_LIGHTS "+r.maxPointLights,"#define MAX_SPOT_LIGHTS "+r.maxSpotLights,"#define MAX_HEMI_LIGHTS "+r.maxHemiLights,"#define MAX_SHADOWS "+r.maxShadows,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"",h.gammaInput?"#define GAMMA_INPUT":"",h.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+O,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+b:"",r.envMap?"#define "+w:"",r.envMap?"#define "+j:"",r.lightMap?"#define USE_LIGHTMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.metal?"#define METAL":"",r.wrapAround?"#define WRAP_AROUND":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+m:"",r.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",r.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join(`
`)),g=new THREE.WebGLShader(c,c.VERTEX_SHADER,y+E),p=new THREE.WebGLShader(c,c.FRAGMENT_SHADER,_+C),c.attachShader(d,g),c.attachShader(d,p),void 0!==v&&c.bindAttribLocation(d,0,v),c.linkProgram(d),f=c.getProgramInfoLog(d),c.getProgramParameter(d,c.LINK_STATUS)===!1&&THREE.error("THREE.WebGLProgram: shader error: "+c.getError(),"gl.VALIDATE_STATUS",c.getProgramParameter(d,c.VALIDATE_STATUS),"gl.getPRogramInfoLog",f),""!==f&&THREE.warn("THREE.WebGLProgram: gl.getProgramInfoLog()"+f),c.deleteShader(g),c.deleteShader(p),l=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"],r.useVertexTexture?(l.push("boneTexture"),l.push("boneTextureWidth"),l.push("boneTextureHeight")):l.push("boneGlobalMatrices"),r.logarithmicDepthBuffer&&l.push("logDepthBufFC");for(S in A)l.push(S);this.uniforms=n(c,d,l),l=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(u=0;u<r.maxMorphTargets;u++)l.push("morphTarget"+u);for(u=0;u<r.maxMorphNormals;u++)l.push("morphNormal"+u);for(F in k)l.push(F);return this.attributes=s(c,d,l),this.attributesKeys=Object.keys(this.attributes),this.id=e++,this.code=i,this.usedTimes=1,this.program=d,this.vertexShader=g,this.fragmentShader=p,this}}(),THREE.WebGLShader=function(){var e=function(e){for(var n=e.split(`
`),t=0;t<n.length;t++)n[t]=t+1+": "+n[t];return n.join(`
`)};return function(t,n,s){var o=t.createShader(n);return t.shaderSource(o,s),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)===!1&&THREE.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(o)&&THREE.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t.getShaderInfoLog(o),e(s)),o}}(),THREE.WebGLState=function(e,t){var s=new Uint8Array(16),n=new Uint8Array(16),d=null,u=null,a=null,r=null,c=null,l=null,o=null,i=null,h=null,m=null,f=null,p=null,g=null,v=null,b=null,j=null;this.initAttributes=function(){for(var e=0,t=s.length;t>e;e++)s[e]=0},this.enableAttribute=function(t){s[t]=1,0===n[t]&&(e.enableVertexAttribArray(t),n[t]=1)},this.disableUnusedAttributes=function(){for(var t=0,o=n.length;o>t;t++)n[t]!==s[t]&&(e.disableVertexAttribArray(t),n[t]=0)},this.setBlending=function(n,s,i,h,m,f,p){n!==d&&(n===THREE.NoBlending?e.disable(e.BLEND):n===THREE.AdditiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):n===THREE.SubtractiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):n===THREE.MultiplyBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):n===THREE.CustomBlending?e.enable(e.BLEND):(e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),d=n),n===THREE.CustomBlending?(m=m||s,f=f||i,p=p||h,(s!==u||m!==c)&&(e.blendEquationSeparate(t(s),t(m)),u=s,c=m),(i!==a||h!==r||f!==l||p!==o)&&(e.blendFuncSeparate(t(i),t(h),t(f),t(p)),a=i,r=h,l=f,o=p)):(u=null,a=null,r=null,c=null,l=null,o=null)},this.setDepthTest=function(t){i!==t&&(t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),i=t)},this.setDepthWrite=function(t){h!==t&&(e.depthMask(t),h=t)},this.setColorWrite=function(t){m!==t&&(e.colorMask(t,t,t,t),m=t)},this.setDoubleSided=function(t){f!==t&&(t?e.disable(e.CULL_FACE):e.enable(e.CULL_FACE),f=t)},this.setFlipSided=function(t){p!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),p=t)},this.setLineWidth=function(t){t!==g&&(e.lineWidth(t),g=t)},this.setPolygonOffset=function(t,n,s){v!==t&&(t?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),v=t),!t||b===n&&j===s||(e.polygonOffset(n,s),b=n,j=s)},this.reset=function(){for(var e=0;e<n.length;e++)n[e]=0;d=null,i=null,h=null,m=null,f=null,p=null}},THREE.LensFlarePlugin=function(e,t){function u(t){var s=n.createProgram(),o=n.createShader(n.FRAGMENT_SHADER),i=n.createShader(n.VERTEX_SHADER),a="precision "+e.getPrecision()+` float;
`;return n.shaderSource(o,a+t.fragmentShader),n.shaderSource(i,a+t.vertexShader),n.compileShader(o),n.compileShader(i),n.attachShader(s,o),n.attachShader(s,i),n.linkProgram(s),s}var s,o,i,a,r,c,l,d,n=e.context,h=function(){var e,t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),h=new Uint16Array([0,1,2,0,2,3]);r=n.createBuffer(),c=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,c),n.bufferData(n.ELEMENT_ARRAY_BUFFER,h,n.STATIC_DRAW),a=n.createTexture(),d=n.createTexture(),n.bindTexture(n.TEXTURE_2D,a),n.texImage2D(n.TEXTURE_2D,0,n.RGB,16,16,0,n.RGB,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.bindTexture(n.TEXTURE_2D,d),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,16,16,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),l=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,e=l?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join(`
`),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join(`
`)}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join(`
`),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join(`
`)},s=u(e),i={vertex:n.getAttribLocation(s,"position"),uv:n.getAttribLocation(s,"uv")},o={renderType:n.getUniformLocation(s,"renderType"),map:n.getUniformLocation(s,"map"),occlusionMap:n.getUniformLocation(s,"occlusionMap"),opacity:n.getUniformLocation(s,"opacity"),color:n.getUniformLocation(s,"color"),scale:n.getUniformLocation(s,"scale"),rotation:n.getUniformLocation(s,"rotation"),screenPosition:n.getUniformLocation(s,"screenPosition")}};this.render=function(u,m,f,p){if(0!==t.length){var g,b,O,x,k,A,w=new THREE.Vector3,C=p/f,S=.5*f,E=.5*p,y=16/p,_=new THREE.Vector2(y*C,y),v=new THREE.Vector3(1,1,0),j=new THREE.Vector2(1,1);void 0===s&&h(),n.useProgram(s),n.enableVertexAttribArray(i.vertex),n.enableVertexAttribArray(i.uv),n.uniform1i(o.occlusionMap,0),n.uniform1i(o.map,1),n.bindBuffer(n.ARRAY_BUFFER,r),n.vertexAttribPointer(i.vertex,2,n.FLOAT,!1,16,0),n.vertexAttribPointer(i.uv,2,n.FLOAT,!1,16,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,c),n.disable(n.CULL_FACE),n.depthMask(!1);for(O=0,k=t.length;k>O;O++)if(y=16/p,_.set(y*C,y),b=t[O],w.set(b.matrixWorld.elements[12],b.matrixWorld.elements[13],b.matrixWorld.elements[14]),w.applyMatrix4(m.matrixWorldInverse),w.applyProjection(m.projectionMatrix),v.copy(w),j.x=v.x*S+S,j.y=v.y*E+E,l||j.x>0&&j.x<f&&j.y>0&&j.y<p){n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,a),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGB,j.x-8,j.y-8,16,16,0),n.uniform1i(o.renderType,0),n.uniform2f(o.scale,_.x,_.y),n.uniform3f(o.screenPosition,v.x,v.y,v.z),n.disable(n.BLEND),n.enable(n.DEPTH_TEST),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,d),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,j.x-8,j.y-8,16,16,0),n.uniform1i(o.renderType,1),n.disable(n.DEPTH_TEST),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,a),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),b.positionScreen.copy(v),b.customUpdateCallback?b.customUpdateCallback(b):b.updateLensFlares(),n.uniform1i(o.renderType,2),n.enable(n.BLEND);for(x=0,A=b.lensFlares.length;A>x;x++)g=b.lensFlares[x],g.opacity>.001&&g.scale>.001&&(v.x=g.x,v.y=g.y,v.z=g.z,y=g.size*g.scale/p,_.x=y*C,_.y=y,n.uniform3f(o.screenPosition,v.x,v.y,v.z),n.uniform2f(o.scale,_.x,_.y),n.uniform1f(o.rotation,g.rotation),n.uniform1f(o.opacity,g.opacity),n.uniform3f(o.color,g.color.r,g.color.g,g.color.b),e.state.setBlending(g.blending,g.blendEquation,g.blendSrc,g.blendDst),e.setTexture(g.texture,1),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0))}n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST),n.depthMask(!0),e.resetGLState()}}},THREE.ShadowMapPlugin=function(e,t,n,s){function h(e,t,s){if(t.visible){if(i=n[t.id],i&&t.castShadow&&(t.frustumCulled===!1||f.intersectsObject(t)===!0))for(var i,r,o=0,a=i.length;a>o;o++)r=i[o],t._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,t.matrixWorld),l.push(r);for(o=0,a=t.children.length;a>o;o++)h(e,t.children[o],s)}}function _(e,t){n=new THREE.DirectionalLight,n.isVirtual=!0,n.onlyShadow=!0,n.castShadow=!0,n.shadowCameraNear=e.shadowCameraNear,n.shadowCameraFar=e.shadowCameraFar,n.shadowCameraLeft=e.shadowCameraLeft,n.shadowCameraRight=e.shadowCameraRight,n.shadowCameraBottom=e.shadowCameraBottom,n.shadowCameraTop=e.shadowCameraTop,n.shadowCameraVisible=e.shadowCameraVisible,n.shadowDarkness=e.shadowDarkness,n.shadowBias=e.shadowCascadeBias[t],n.shadowMapWidth=e.shadowCascadeWidth[t],n.shadowMapHeight=e.shadowCascadeHeight[t],n.pointsWorld=[],n.pointsFrustum=[];for(var n,o,i,r=n.pointsWorld,s=n.pointsFrustum,a=0;8>a;a++)r[a]=new THREE.Vector3,s[a]=new THREE.Vector3;return o=e.shadowCascadeNearZ[t],i=e.shadowCascadeFarZ[t],s[0].set(-1,-1,o),s[1].set(1,-1,o),s[2].set(-1,1,o),s[3].set(1,1,o),s[4].set(-1,-1,i),s[5].set(1,-1,i),s[6].set(-1,1,i),s[7].set(1,1,i),n}function y(e,t){n=e.shadowCascadeArray[t],n.position.copy(e.position),n.target.position.copy(e.target.position),n.lookAt(n.target),n.shadowCameraVisible=e.shadowCameraVisible,n.shadowDarkness=e.shadowDarkness,n.shadowBias=e.shadowCascadeBias[t];var n,o=e.shadowCascadeNearZ[t],i=e.shadowCascadeFarZ[t],s=n.pointsFrustum;s[0].z=o,s[1].z=o,s[2].z=o,s[3].z=o,s[4].z=i,s[5].z=i,s[6].z=i,s[7].z=i}function j(e,t){var n,o,s=t.shadowCamera,i=t.pointsFrustum,c=t.pointsWorld;r.set(1/0,1/0,1/0),a.set(-(1/0),-(1/0),-(1/0));for(o=0;8>o;o++)n=c[o],n.copy(i[o]),n.unproject(e),n.applyMatrix4(s.matrixWorldInverse),n.x<r.x&&(r.x=n.x),n.x>a.x&&(a.x=n.x),n.y<r.y&&(r.y=n.y),n.y>a.y&&(a.y=n.y),n.z<r.z&&(r.z=n.z),n.z>a.z&&(a.z=n.z);s.left=r.x,s.right=a.x,s.top=a.y,s.bottom=r.y,s.updateProjectionMatrix()}function b(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}var o=e.context,f=new THREE.Frustum,p=new THREE.Matrix4,r=new THREE.Vector3,a=new THREE.Vector3,v=new THREE.Vector3,l=[],i=THREE.ShaderLib.depthRGBA,c=THREE.UniformsUtils.clone(i.uniforms),d=new THREE.ShaderMaterial({uniforms:c,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),g=new THREE.ShaderMaterial({uniforms:c,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,morphTargets:!0}),m=new THREE.ShaderMaterial({uniforms:c,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,skinning:!0}),u=new THREE.ShaderMaterial({uniforms:c,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,morphTargets:!0,skinning:!0});d._shadowPass=!0,g._shadowPass=!0,m._shadowPass=!0,u._shadowPass=!0,this.render=function(n,i){if(e.shadowMapEnabled!==!1){var a,r,c,w,O,x,C,E,k,A,S,M,F,D,N,L,R,H,I,B,V,$,T=[],z=0,P=null;for(o.clearColor(1,1,1,1),o.disable(o.BLEND),o.enable(o.CULL_FACE),o.frontFace(o.CCW),e.shadowMapCullFace===THREE.CullFaceFront?o.cullFace(o.FRONT):o.cullFace(o.BACK),e.state.setDepthTest(!0),C=0,L=t.length;L>C;C++)if(a=t[C],a.castShadow)if(a instanceof THREE.DirectionalLight&&a.shadowCascade)for(x=0;x<a.shadowCascadeCount;x++)a.shadowCascadeArray[x]?O=a.shadowCascadeArray[x]:(O=_(a,x),O.originalCamera=i,k=new THREE.Gyroscope,k.position.copy(a.shadowCascadeOffset),k.add(O),k.add(O.target),i.add(k),a.shadowCascadeArray[x]=O),y(a,x),T[z]=O,z++;else T[z]=a,z++;for(C=0,L=T.length;L>C;C++){if((a=T[C],!a.shadowMap)&&(N=THREE.LinearFilter,e.shadowMapType===THREE.PCFSoftShadowMap&&(N=THREE.NearestFilter),I={minFilter:N,magFilter:N,format:THREE.RGBAFormat},a.shadowMap=new THREE.WebGLRenderTarget(a.shadowMapWidth,a.shadowMapHeight,I),a.shadowMapSize=new THREE.Vector2(a.shadowMapWidth,a.shadowMapHeight),a.shadowMatrix=new THREE.Matrix4),!a.shadowCamera){if(a instanceof THREE.SpotLight)a.shadowCamera=new THREE.PerspectiveCamera(a.shadowCameraFov,a.shadowMapWidth/a.shadowMapHeight,a.shadowCameraNear,a.shadowCameraFar);else{if(!(a instanceof THREE.DirectionalLight)){THREE.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",a);continue}a.shadowCamera=new THREE.OrthographicCamera(a.shadowCameraLeft,a.shadowCameraRight,a.shadowCameraTop,a.shadowCameraBottom,a.shadowCameraNear,a.shadowCameraFar)}n.add(a.shadowCamera),n.autoUpdate===!0&&n.updateMatrixWorld()}a.shadowCameraVisible&&!a.cameraHelper&&(a.cameraHelper=new THREE.CameraHelper(a.shadowCamera),n.add(a.cameraHelper)),a.isVirtual&&O.originalCamera==i&&j(i,a),V=a.shadowMap,A=a.shadowMatrix,r=a.shadowCamera,r.position.setFromMatrixPosition(a.matrixWorld),v.setFromMatrixPosition(a.target.matrixWorld),r.lookAt(v),r.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld),a.cameraHelper&&(a.cameraHelper.visible=a.shadowCameraVisible),a.shadowCameraVisible&&a.cameraHelper.update(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(r.projectionMatrix),A.multiply(r.matrixWorldInverse),p.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),f.setFromMatrix(p),e.setRenderTarget(V),e.clear(),l.length=0,h(n,n,r);for(w=0,S=l.length;S>w;w++)E=l[w],c=E.object,M=E.buffer,D=b(c),H=void 0!==c.geometry.morphTargets&&c.geometry.morphTargets.length>0&&D.morphTargets,B=c instanceof THREE.SkinnedMesh&&D.skinning,R=c.customDepthMaterial?c.customDepthMaterial:B?H?u:m:H?g:d,e.setMaterialFaces(D),M instanceof THREE.BufferGeometry?e.renderBufferDirect(r,t,P,R,M,c):e.renderBuffer(r,t,P,R,M,c);for(w=0,S=s.length;S>w;w++)E=s[w],c=E.object,c.visible&&c.castShadow&&(c._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,c.matrixWorld),e.renderImmediateObject(r,t,P,d,c))}F=e.getClearColor(),$=e.getClearAlpha(),o.clearColor(F.r,F.g,F.b,$),o.enable(o.BLEND),e.shadowMapCullFace===THREE.CullFaceFront&&o.cullFace(o.BACK),e.resetGLState()}}},THREE.SpritePlugin=function(e,t){function d(){var t=n.createProgram(),s=n.createShader(n.VERTEX_SHADER),o=n.createShader(n.FRAGMENT_SHADER);return n.shaderSource(s,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join(`
`)),n.shaderSource(o,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join(`
`)),n.compileShader(s),n.compileShader(o),n.attachShader(t,s),n.attachShader(t,o),n.linkProgram(t),t}function u(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var s,o,i,a,r,c,n=e.context,h=new THREE.Vector3,m=new THREE.Quaternion,l=new THREE.Vector3,f=function(){var e,t,l=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),u=new Uint16Array([0,1,2,0,2,3]);r=n.createBuffer(),a=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,l,n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a),n.bufferData(n.ELEMENT_ARRAY_BUFFER,u,n.STATIC_DRAW),o=d(),i={position:n.getAttribLocation(o,"position"),uv:n.getAttribLocation(o,"uv")},s={uvOffset:n.getUniformLocation(o,"uvOffset"),uvScale:n.getUniformLocation(o,"uvScale"),rotation:n.getUniformLocation(o,"rotation"),scale:n.getUniformLocation(o,"scale"),color:n.getUniformLocation(o,"color"),map:n.getUniformLocation(o,"map"),opacity:n.getUniformLocation(o,"opacity"),modelViewMatrix:n.getUniformLocation(o,"modelViewMatrix"),projectionMatrix:n.getUniformLocation(o,"projectionMatrix"),fogType:n.getUniformLocation(o,"fogType"),fogDensity:n.getUniformLocation(o,"fogDensity"),fogNear:n.getUniformLocation(o,"fogNear"),fogFar:n.getUniformLocation(o,"fogFar"),fogColor:n.getUniformLocation(o,"fogColor"),alphaTest:n.getUniformLocation(o,"alphaTest")},e=document.createElement("canvas"),e.width=8,e.height=8,t=e.getContext("2d"),t.fillStyle="white",t.fillRect(0,0,8,8),c=new THREE.Texture(e),c.needsUpdate=!0};this.render=function(d,p){if(0!==t.length){void 0===o&&f(),n.useProgram(o),n.enableVertexAttribArray(i.position),n.enableVertexAttribArray(i.uv),n.disable(n.CULL_FACE),n.enable(n.BLEND),n.bindBuffer(n.ARRAY_BUFFER,r),n.vertexAttribPointer(i.position,2,n.FLOAT,!1,16,0),n.vertexAttribPointer(i.uv,2,n.FLOAT,!1,16,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a),n.uniformMatrix4fv(s.projectionMatrix,!1,p.projectionMatrix.elements),n.activeTexture(n.TEXTURE0),n.uniform1i(s.map,0);var g,b,j,_,O,y=0,w=0,v=d.fog;v?(n.uniform3f(s.fogColor,v.color.r,v.color.g,v.color.b),v instanceof THREE.Fog?(n.uniform1f(s.fogNear,v.near),n.uniform1f(s.fogFar,v.far),n.uniform1i(s.fogType,1),y=1,w=1):v instanceof THREE.FogExp2&&(n.uniform1f(s.fogDensity,v.density),n.uniform1i(s.fogType,2),y=2,w=2)):(n.uniform1i(s.fogType,0),y=0,w=0);for(j=0,O=t.length;O>j;j++)b=t[j],b._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,b.matrixWorld),b.z=-b._modelViewMatrix.elements[14];t.sort(u);for(var x=[],j=0,O=t.length;O>j;j++)b=t[j],g=b.material,n.uniform1f(s.alphaTest,g.alphaTest),n.uniformMatrix4fv(s.modelViewMatrix,!1,b._modelViewMatrix.elements),b.matrixWorld.decompose(h,m,l),x[0]=l.x,x[1]=l.y,_=0,d.fog&&g.fog&&(_=w),y!==_&&(n.uniform1i(s.fogType,_),y=_),null!==g.map?(n.uniform2f(s.uvOffset,g.map.offset.x,g.map.offset.y),n.uniform2f(s.uvScale,g.map.repeat.x,g.map.repeat.y)):(n.uniform2f(s.uvOffset,0,0),n.uniform2f(s.uvScale,1,1)),n.uniform1f(s.opacity,g.opacity),n.uniform3f(s.color,g.color.r,g.color.g,g.color.b),n.uniform1f(s.rotation,g.rotation),n.uniform2fv(s.scale,x),e.state.setBlending(g.blending,g.blendEquation,g.blendSrc,g.blendDst),e.state.setDepthTest(g.depthTest),e.state.setDepthWrite(g.depthWrite),g.map&&g.map.image&&g.map.image.width?e.setTexture(g.map,0):e.setTexture(c,0),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0);n.enable(n.CULL_FACE),e.resetGLState()}}},THREE.GeometryUtils={merge:function(e,t,n){THREE.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var s;t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),s=t.matrix,t=t.geometry),e.merge(t,s,n)},center:function(e){return THREE.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,n,s){var o,i=new THREE.ImageLoader;return i.crossOrigin=this.crossOrigin,o=new THREE.Texture(void 0,t),i.load(e,function(e){o.image=e,o.needsUpdate=!0,n&&n(o)},void 0,function(e){s&&s(e)}),o.sourceFile=e,o},loadTextureCube:function(e,t,n,s){r=[],i=new THREE.ImageLoader,i.crossOrigin=this.crossOrigin,o=new THREE.CubeTexture(r,t),o.flipY=!1;for(var o,i,r,c=0,l=function(t){i.load(e[t],function(e){o.images[t]=e,c+=1,6===c&&(o.needsUpdate=!0,n&&n(o))},void 0,s)},a=0,d=e.length;d>a;++a)l(a);return o},loadCompressedTexture:function(){THREE.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){THREE.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var E=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},O=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},C=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var n=e.width,d=e.height,g=document.createElement("canvas");g.width=n,g.height=d,u=g.getContext("2d"),u.drawImage(e,0,0);for(var c=u.getImageData(0,0,n,d).data,x=u.createImageData(n,d),m=x.data,a=0;n>a;a++)for(i=0;d>i;i++){var s,i,r,u,h,f,p,v=0>i-1?0:i-1,b=i+1>d-1?d-1:i+1,j=0>a-1?0:a-1,y=a+1>n-1?n-1:a+1,o=[],w=[0,0,c[4*(i*n+a)]/255*t];o.push([-1,0,c[4*(i*n+j)]/255*t]),o.push([-1,-1,c[4*(v*n+j)]/255*t]),o.push([0,-1,c[4*(v*n+a)]/255*t]),o.push([1,-1,c[4*(v*n+y)]/255*t]),o.push([1,0,c[4*(i*n+y)]/255*t]),o.push([1,1,c[4*(b*n+y)]/255*t]),o.push([0,1,c[4*(b*n+a)]/255*t]),o.push([-1,1,c[4*(b*n+j)]/255*t]);for(var l=[],_=o.length,s=0;_>s;s++)p=o[s],f=o[(s+1)%_],p=O(p,w),f=O(f,w),l.push(C(E(p,f)));for(r=[0,0,0],s=0;s<l.length;s++)r[0]+=l[s][0],r[1]+=l[s][1],r[2]+=l[s][2];r[0]/=l.length,r[1]/=l.length,r[2]/=l.length,h=4*(i*n+a),m[h]=(r[0]+1)/2*255|0,m[h+1]=(r[1]+1)/2*255|0,m[h+2]=255*r[2]|0,m[h+3]=255}return u.putImageData(x,0,0),g},generateDataTexture:function(e,t,n){for(var i,a=e*t,o=new Uint8Array(3*a),r=Math.floor(255*n.r),c=Math.floor(255*n.g),l=Math.floor(255*n.b),s=0;a>s;s++)o[3*s]=r,o[3*s+1]=c,o[3*s+2]=l;return i=new THREE.DataTexture(o,e,t,THREE.RGBFormat),i.needsUpdate=!0,i}},THREE.SceneUtils={createMultiMaterialObject:function(e,t){for(var s=new THREE.Object3D,n=0,o=t.length;o>n;n++)s.add(new THREE.Mesh(e,t[n]));return s},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){var s=new THREE.Matrix4;s.getInverse(n.matrixWorld),e.applyMatrix(s),t.remove(e),n.add(e)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch{throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase(),n=this;return n.faces[t]=n.faces[t]||{},n.faces[t][e.cssFontWeight]=n.faces[t][e.cssFontWeight]||{},n.faces[t][e.cssFontWeight][e.cssFontStyle]=e,n.faces[t][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(e){var t,s,r,c,o=this.getFace(),l=this.size/o.resolution,n=0,i=String(e).split(""),d=i.length,a=[];for(t=0;d>t;t++)r=new THREE.Path,s=this.extractGlyphPoints(i[t],o,l,n,r),n+=s.offset,a.push(s.path);return c=n/2,{paths:a,offset:c}},extractGlyphPoints:function(e,t,n,s,o){var i,a,r,c,l,d,u,h,f,p,g,v,b,j,y,w,O,x,C,E,_=[],m=t.glyphs[e]||t.glyphs["?"];if(m){if(m.o)for(a=m._cachedOutline||(m._cachedOutline=m.o.split(" ")),C=a.length,r=n,l=n,i=0;C>i;)switch(E=a[i++]){case"m":w=a[i++]*r+s,y=a[i++]*l,o.moveTo(w,y);break;case"l":w=a[i++]*r+s,y=a[i++]*l,o.lineTo(w,y);break;case"q":if(p=a[i++]*r+s,g=a[i++]*l,u=a[i++]*r+s,d=a[i++]*l,o.quadraticCurveTo(u,d,p,g),f=_[_.length-1])for(j=f.x,b=f.y,c=1,v=this.divisions;v>=c;c++)h=c/v,THREE.Shape.Utils.b2(h,j,u,p),THREE.Shape.Utils.b2(h,b,d,g);break;case"b":if(p=a[i++]*r+s,g=a[i++]*l,u=a[i++]*r+s,d=a[i++]*l,O=a[i++]*r+s,x=a[i++]*l,o.bezierCurveTo(u,d,O,x,p,g),f=_[_.length-1])for(j=f.x,b=f.y,c=1,v=this.divisions;v>=c;c++)h=c/v,THREE.Shape.Utils.b3(h,j,u,O,p),THREE.Shape.Utils.b3(h,b,d,x,g)}return{offset:m.ha*n,path:o}}}},THREE.FontUtils.generateShapes=function(e,t){t=t||{};var i=void 0!==t.size?t.size:100,a=void 0!==t.curveSegments?t.curveSegments:4,r=void 0!==t.font?t.font:"helvetiker",c=void 0!==t.weight?t.weight:"normal",l=void 0!==t.style?t.style:"normal";THREE.FontUtils.size=i,THREE.FontUtils.divisions=a,THREE.FontUtils.face=r,THREE.FontUtils.weight=c,THREE.FontUtils.style=l;for(var d=THREE.FontUtils.drawText(e),s=d.paths,o=[],n=0,u=s.length;u>n;n++)Array.prototype.push.apply(o,s[n].toShapes());return o},function(e){var t=1e-10,s=function(e,t){if(l=e.length,3>l)return null;var s,i,r,c,l,d,h,m,p,g,v,f=[],a=[],u=[];if(n(e)>0)for(s=0;l>s;s++)a[s]=s;else for(s=0;l>s;s++)a[s]=l-1-s;i=l,h=2*i;for(s=i-1;i>2;){if(h--<=0)return THREE.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),t?u:f;if(r=s,r>=i&&(r=0),s=r+1,s>=i&&(s=0),c=s+1,c>=i&&(c=0),o(e,r,s,c,i,a)){for(p=a[r],g=a[s],v=a[c],f.push([e[p],e[g],e[v]]),u.push([a[r],a[s],a[c]]),m=s,d=s+1;i>d;m++,d++)a[m]=a[d];i--,h=2*i}}return t?u:f},n=function(e){for(var s=e.length,o=0,n=s-1,t=0;s>t;n=t++)o+=e[n].x*e[t].y-e[t].x*e[n].y;return.5*o},o=function(e,n,s,o,i,a){var r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M;if(r=e[a[n]].x,c=e[a[n]].y,u=e[a[s]].x,h=e[a[s]].y,m=e[a[o]].x,f=e[a[o]].y,t>(u-r)*(f-c)-(h-c)*(m-r))return!1;for(j=m-u,O=f-h,b=r-m,g=c-f,y=u-r,_=h-c,p=0;i>p;p++)if(l=e[a[p]].x,d=e[a[p]].y,!(l===r&&d===c||l===u&&d===h||l===m&&d===f)&&(w=l-r,v=d-c,x=l-u,C=d-h,E=l-m,k=d-f,M=j*C-O*x,A=y*v-_*w,S=b*k-g*E,M>=-t&&S>=-t&&A>=-t))return!1;return!0};return e.Triangulate=s,e.Triangulate.area=n,e}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Audio=function(e){THREE.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.isPlaying=!1},THREE.Audio.prototype=Object.create(THREE.Object3D.prototype),THREE.Audio.prototype.constructor=THREE.Audio,THREE.Audio.prototype.load=function(e){var t=this,n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){t.context.decodeAudioData(this.response,function(e){t.source.buffer=e,t.autoplay&&t.play()})},n.send(),this},THREE.Audio.prototype.play=function(){if(this.isPlaying===!0)return void THREE.warn("THREE.Audio: Audio is already playing.");var e=this.context.createBufferSource();e.buffer=this.source.buffer,e.loop=this.source.loop,e.onended=this.source.onended,e.connect(this.panner),e.start(0,this.startTime),this.isPlaying=!0,this.source=e},THREE.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},THREE.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1},THREE.Audio.prototype.setLoop=function(e){this.source.loop=e},THREE.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e},THREE.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e},THREE.Audio.prototype.setVolume=function(e){this.gain.gain.value=e},THREE.Audio.prototype.updateMatrixWorld=function(){var e=new THREE.Vector3;return function(t){THREE.Object3D.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}(),THREE.AudioListener=function(){THREE.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype),THREE.AudioListener.prototype.constructor=THREE.AudioListener,THREE.AudioListener.prototype.updateMatrixWorld=function(){var e=new THREE.Vector3,s=new THREE.Quaternion,i=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3;return function(a){THREE.Object3D.prototype.updateMatrixWorld.call(this,a);var r=this.context.listener,c=this.up;this.matrixWorld.decompose(e,s,i),t.set(0,0,-1).applyQuaternion(s),n.subVectors(e,o),r.setPosition(e.x,e.y,e.z),r.setOrientation(t.x,t.y,t.z,c.x,c.y,c.z),r.setVelocity(n.x,n.y,n.z),o.copy(e)}}(),THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return THREE.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},THREE.Curve.prototype.getPoints=function(e){e||(e=5);var t,n=[];for(t=0;e>=t;t++)n.push(this.getPoint(t/e));return n},THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,n=[];for(t=0;e>=t;t++)n.push(this.getPointAt(t/e));return n},THREE.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},THREE.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,s,n=[],o=this.getPoint(0),i=0;for(n.push(0),t=1;e>=t;t++)s=this.getPoint(t/e),i+=s.distanceTo(o),n.push(i),o=s;return this.cacheArcLengths=n,n},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(e,t){for(var c,s=this.getLengths(),n=0,i=s.length,r=t||e*s[i-1],a=0,o=i-1;o>=a;)if(n=Math.floor(a+(o-a)/2),c=s[n]-r,0>c)a=n+1;else{if(!(c>0)){o=n;break}o=n-1}if(n=o,s[n]==r)return l=n/(i-1),l;var c,d=s[n],u=s[n+1],h=u-d,m=(r-d)/h,l=(n+m)/(i-1);return l},THREE.Curve.prototype.getTangent=function(e){var s=1e-4,t=e-s,n=e+s;0>t&&(t=0),n>1&&(n=1);var o=this.getPoint(t),i=this.getPoint(n),a=i.clone().sub(o);return a.normalize()},THREE.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},THREE.Curve.Utils={tangentQuadraticBezier:function(e,t,n,s){return 2*(1-e)*(n-t)+2*e*(s-n)},tangentCubicBezier:function(e,t,n,s,o){return-3*t*(1-e)*(1-e)+3*n*(1-e)*(1-e)-6*e*n*(1-e)+6*e*s*(1-e)-3*e*e*s+3*e*e*o},tangentSpline:function(e){var i=6*e*e-6*e,a=3*e*e-4*e+1,r=-6*e*e+6*e,c=3*e*e-2*e;return i+a+r+c},interpolate:function(e,t,n,s,o){var i=.5*(n-e),a=.5*(s-t),r=o*o,c=o*r;return(2*t-2*n+i+a)*c+(-3*t+3*n-2*i-a)*r+i*o+t}},THREE.Curve.create=function(e,t){return e.prototype=Object.create(THREE.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.constructor=THREE.CurvePath,THREE.CurvePath.prototype.add=function(e){this.curves.push(e)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new THREE.LineCurve(t,e))},THREE.CurvePath.prototype.getPoint=function(e){for(var n,o,a,i=e*this.getLength(),s=this.getCurveLengths(),t=0;t<s.length;){if(s[t]>=i)return o=s[t]-i,n=this.curves[t],a=1-o/n.getLength(),n.getPointAt(a);t++}return null},THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,t=[],n=0,s=this.curves.length;for(e=0;s>e;e++)n+=this.curves[e].getLength(),t.push(n);return this.cacheLengths=t,t},THREE.CurvePath.prototype.getBoundingBox=function(){var e,t,n,s,i,c,d,u,h,o=this.getPoints(),a=n=Number.NEGATIVE_INFINITY,r=t=Number.POSITIVE_INFINITY,l=o[0]instanceof THREE.Vector3;for(h=l?new THREE.Vector3:new THREE.Vector2,c=0,u=o.length;u>c;c++)e=o[c],e.x>a?a=e.x:e.x<r&&(r=e.x),e.y>n?n=e.y:e.y<t&&(t=e.y),l&&(e.z>d?d=e.z:e.z<i&&(i=e.z)),h.add(e);return s={minX:r,minY:t,maxX:a,maxY:n},l&&(s.maxZ=d,s.minZ=i),s},THREE.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},THREE.CurvePath.prototype.createGeometry=function(e){for(var n=new THREE.Geometry,t=0;t<e.length;t++)n.vertices.push(new THREE.Vector3(e[t].x,e[t].y,e[t].z||0));return n},THREE.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},THREE.CurvePath.prototype.getTransformedPoints=function(e,t){var n,o,s=this.getPoints(e);for(t||(t=this.bends),n=0,o=t.length;o>n;n++)s=this.getWrapPoints(s,t[n]);return s},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var n,o,s=this.getSpacedPoints(e);for(t||(t=this.bends),n=0,o=t.length;o>n;n++)s=this.getWrapPoints(s,t[n]);return s},THREE.CurvePath.prototype.getWrapPoints=function(e,t){l=this.getBoundingBox();for(i=0,r=e.length;r>i;i++){n=e[i],a=n.x,c=n.y,s=a/l.maxX,s=t.getUtoTmapping(s,a);var n,s,i,a,r,c,l,d=t.getPoint(s),o=t.getTangent(s);o.set(-o.y,o.x).multiplyScalar(c),n.x=d.x+o.x,n.y=d.y+o.y}return e},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.constructor=THREE.Gyroscope,THREE.Gyroscope.prototype.updateMatrixWorld=function(){var s=new THREE.Vector3,e=new THREE.Quaternion,o=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Quaternion,n=new THREE.Vector3;return function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(t,i,n),this.matrix.decompose(s,e,o),this.matrixWorld.compose(t,e,n)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var r=0,c=this.children.length;c>r;r++)this.children[r].updateMatrixWorld(a)}}(),THREE.Path=function(e){THREE.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.Path.prototype.constructor=THREE.Path,THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;n>t;t++)this.lineTo(e[t].x,e[t].y)},THREE.Path.prototype.moveTo=function(){var n=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:n})},THREE.Path.prototype.lineTo=function(e,t){var s=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,o=n[n.length-2],i=n[n.length-1],a=new THREE.LineCurve(new THREE.Vector2(o,i),new THREE.Vector2(e,t));this.curves.push(a),this.actions.push({action:THREE.PathActions.LINE_TO,args:s})},THREE.Path.prototype.quadraticCurveTo=function(e,t,n,s){var i=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],r=o[o.length-1],c=new THREE.QuadraticBezierCurve(new THREE.Vector2(a,r),new THREE.Vector2(e,t),new THREE.Vector2(n,s));this.curves.push(c),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:i})},THREE.Path.prototype.bezierCurveTo=function(e,t,n,s,o,i){var r=Array.prototype.slice.call(arguments),a=this.actions[this.actions.length-1].args,c=a[a.length-2],l=a[a.length-1],d=new THREE.CubicBezierCurve(new THREE.Vector2(c,l),new THREE.Vector2(e,t),new THREE.Vector2(n,s),new THREE.Vector2(o,i));this.curves.push(d),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:r})},THREE.Path.prototype.splineThru=function(e){var s,o=Array.prototype.slice.call(arguments),t=this.actions[this.actions.length-1].args,i=t[t.length-2],a=t[t.length-1],n=[new THREE.Vector2(i,a)];Array.prototype.push.apply(n,e),s=new THREE.SplineCurve(n),this.curves.push(s),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:o})},THREE.Path.prototype.arc=function(e,t,n,s,o,i){var a=this.actions[this.actions.length-1].args,r=a[a.length-2],c=a[a.length-1];this.absarc(e+r,t+c,n,s,o,i)},THREE.Path.prototype.absarc=function(e,t,n,s,o,i){this.absellipse(e,t,n,n,s,o,i)},THREE.Path.prototype.ellipse=function(e,t,n,s,o,i,a){var r=this.actions[this.actions.length-1].args,c=r[r.length-2],l=r[r.length-1];this.absellipse(e+c,t+l,n,s,o,i,a)},THREE.Path.prototype.absellipse=function(e,t,n,s,o,i,a){var c,r=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(e,t,n,s,o,i,a);this.curves.push(l),c=l.getPoint(1),r.push(c.x),r.push(c.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:r})},THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var s=[],n=0;e>n;n++)s.push(this.getPoint(n/e));return s},THREE.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);e=e||12,s=[];for(l=0,S=this.actions.length;S>l;l++)switch(C=this.actions[l],M=C.action,n=C.args,M){case THREE.PathActions.MOVE_TO:s.push(new THREE.Vector2(n[0],n[1]));break;case THREE.PathActions.LINE_TO:s.push(new THREE.Vector2(n[0],n[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(p=n[2],b=n[3],g=n[0],v=n[1],s.length>0?(o=s[s.length-1],u=o.x,h=o.y):(o=this.actions[l-1].args,u=o[o.length-2],h=o[o.length-1]),i=1;e>=i;i++)a=i/e,c=THREE.Shape.Utils.b2(a,u,g,p),r=THREE.Shape.Utils.b2(a,h,v,b),s.push(new THREE.Vector2(c,r));break;case THREE.PathActions.BEZIER_CURVE_TO:for(p=n[4],b=n[5],g=n[0],v=n[1],T=n[2],z=n[3],s.length>0?(o=s[s.length-1],u=o.x,h=o.y):(o=this.actions[l-1].args,u=o[o.length-2],h=o[o.length-1]),i=1;e>=i;i++)a=i/e,c=THREE.Shape.Utils.b3(a,u,g,T,p),r=THREE.Shape.Utils.b3(a,h,v,z,b),s.push(new THREE.Vector2(c,r));break;case THREE.PathActions.CSPLINE_THRU:o=this.actions[l-1].args;var R=new THREE.Vector2(o[o.length-2],o[o.length-1]),w=[R],D=e*n[0].length,w=w.concat(n[0]),F=new THREE.SplineCurve(w);for(i=1;D>=i;i++)s.push(F.getPointAt(i/D));break;case THREE.PathActions.ARC:var d,E=n[0],k=n[1],A=n[2],m=n[3],y=n[4],x=!!n[5],j=y-m,f=2*e;for(i=1;f>=i;i++)a=i/f,x||(a=1-a),d=m+a*j,c=E+A*Math.cos(d),r=k+A*Math.sin(d),s.push(new THREE.Vector2(c,r));break;case THREE.PathActions.ELLIPSE:var n,s,o,i,a,r,c,l,d,u,h,p,g,v,b,_,O,C,S,M,T,z,E=n[0],k=n[1],N=n[2],L=n[3],m=n[4],y=n[5],x=!!n[6],j=y-m,f=2*e;for(i=1;f>=i;i++)a=i/f,x||(a=1-a),d=m+a*j,c=E+N*Math.cos(d),r=k+L*Math.sin(d),s.push(new THREE.Vector2(c,r))}return O=s[s.length-1],_=1e-10,Math.abs(O.x-s[0].x)<_&&Math.abs(O.y-s[0].y)<_&&s.splice(s.length-1,1),t&&s.push(s[0]),s},THREE.Path.prototype.toShapes=function(e,t){function S(e){var n,s,o,a,r,i=[],t=new THREE.Path;for(n=0,a=e.length;a>n;n++)s=e[n],r=s.args,o=s.action,o==THREE.PathActions.MOVE_TO&&0!=t.actions.length&&(i.push(t),t=new THREE.Path),t[o].apply(t,r);return 0!=t.actions.length&&i.push(t),i}function E(e){for(var t,s,o=[],n=0,i=e.length;i>n;n++)s=e[n],t=new THREE.Shape,t.actions=s.actions,t.curves=s.curves,o.push(t);return o}function A(e,t){for(var l,u=1e-10,d=t.length,a=!1,r=d-1,i=0;d>i;r=i++){var n=t[r],s=t[i],c=s.x-n.x,o=s.y-n.y;if(Math.abs(o)>u){if(0>o&&(n=t[i],c=-c,s=t[r],o=-o),e.y<n.y||e.y>s.y)continue;if(e.y==n.y){if(e.x==n.x)return!0}else{if(l=o*(e.x-n.x)-c*(e.y-n.y),0==l)return!0;if(0>l)continue;a=!a}}else{if(e.y!=n.y)continue;if(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x)return!0}}return a}if(i=S(this.actions),0==i.length)return[];if(t===!0)return E(i);if(u=[],1==i.length)return r=i[0],c=new THREE.Shape,c.actions=r.actions,c.curves=r.curves,u.push(c),u;var s,i,a,r,c,u,m,f,p,g,v,b,_,O,k,h=!THREE.Shape.Utils.isClockWise(i[0].getPoints()),h=e?!h:h,j=[],n=[],d=[],o=0;n[o]=void 0,d[o]=[];for(a=0,b=i.length;b>a;a++)r=i[a],g=r.getPoints(),m=THREE.Shape.Utils.isClockWise(g),m=e?!m:m,m?(!h&&n[o]&&o++,n[o]={s:new THREE.Shape,p:g},n[o].s.actions=r.actions,n[o].s.curves=r.curves,h&&o++,d[o]=[]):d[o].push({h:r,p:g[0]});if(!n[0])return E(i);if(n.length>1){for(var C=!1,x=[],s=0,p=n.length;p>s;s++)j[s]=[];for(s=0,p=n.length;p>s;s++)for(_=d[s],f=0;f<_.length;f++){for(var y=_[f],w=!0,l=0;l<n.length;l++)A(y.p,n[l].p)&&(s!=l&&x.push({froms:s,tos:l,hole:f}),w?(w=!1,j[l].push(y)):C=!0);w&&j[s].push(y)}x.length>0&&(C||(d=j))}for(a=0,b=n.length;b>a;a++)for(c=n[a].s,u.push(c),O=d[a],v=0,k=O.length;k>v;v++)c.holes.push(O[v].h);return u},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.constructor=THREE.Shape,THREE.Shape.prototype.extrude=function(e){var t=new THREE.ExtrudeGeometry(this,e);return t},THREE.Shape.prototype.makeGeometry=function(e){var t=new THREE.ShapeGeometry(this,e);return t},THREE.Shape.prototype.getPointsHoles=function(e){var t,s=this.holes.length,n=[];for(t=0;s>t;t++)n[t]=this.holes[t].getTransformedPoints(e,this.bends);return n},THREE.Shape.prototype.getSpacedPointsHoles=function(e){var t,s=this.holes.length,n=[];for(t=0;s>t;t++)n[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return n},THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},THREE.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},THREE.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},THREE.Shape.Utils={triangulateShape:function(e,t){function f(e,t,n){return e.x!=t.x?e.x<t.x?e.x<=n.x&&n.x<=t.x:t.x<=n.x&&n.x<=e.x:e.y<t.y?e.y<=n.y&&n.y<=t.y:t.y<=n.y&&n.y<=e.y}function h(e,t,n,s,o){var r,c,l,d,u,h,m,p,g,O,x,C,E=1e-10,j=t.x-e.x,w=t.y-e.y,b=s.x-n.x,v=s.y-n.y,y=e.x-n.x,_=e.y-n.y,i=w*b-j*v,a=w*y-j*_;if(Math.abs(i)>E){if(i>0){{if(0>a||a>i)return[];if(r=v*y-b*_,0>r||r>i)return[]}}else{if(a>0||i>a)return[];if(r=v*y-b*_,r>0||i>r)return[]}return 0==r?!o||0!=a&&a!=i?[e]:[]:r==i?!o||0!=a&&a!=i?[t]:[]:0==a?[n]:a==i?[s]:(C=r/i,[{x:e.x+C*j,y:e.y+C*w}])}return 0!=a||v*y!=b*_?[]:(x=0==j&&0==w,O=0==b&&0==v,x&&O?e.x!=n.x||e.y!=n.y?[]:[e]:x?f(n,s,e)?[e]:[]:O?f(e,t,n)?[n]:[]:(0!=j?(e.x<t.x?(d=e,u=e.x,g=t,l=t.x):(d=t,u=t.x,g=e,l=e.x),n.x<s.x?(m=n,h=n.x,p=s,c=s.x):(m=s,h=s.x,p=n,c=n.x)):(e.y<t.y?(d=e,u=e.y,g=t,l=t.y):(d=t,u=t.y,g=e,l=e.y),n.y<s.y?(m=n,h=n.y,p=s,c=s.y):(m=s,h=s.y,p=n,c=n.y)),h>=u?h>l?[]:l==h?o?[]:[m]:c>=l?[m,g]:[m,p]:u>c?[]:u==c?o?[]:[d]:c>=l?[d,g]:[d,p]))}function m(e,t,n,s){var i,m=1e-10,a=t.x-e.x,r=t.y-e.y,c=n.x-e.x,l=n.y-e.y,d=s.x-e.x,u=s.y-e.y,h=a*l-r*c,o=a*u-r*d;return Math.abs(h)>m?(i=d*l-u*c,h>0?o>=0&&i>=0:o>=0||i>=0):o>0}function g(e,t){function C(e,t){var o,i,a,r,l,d=n.length-1,c=e-1;return 0>c&&(c=d),o=e+1,o>d&&(o=0),i=m(n[e],n[c],n[o],s[t]),!!i&&(l=s.length-1,a=t-1,0>a&&(a=l),r=t+1,r>l&&(r=0),i=m(s[t],s[a],s[r],n[e]),!!i)}function O(e,t){var s,o,i;for(s=0;s<n.length;s++)if(o=s+1,o%=n.length,i=h(e,t,n[s],n[o],!0),i.length>0)return!0;return!1}function w(e,n){var s,i,a,r,c;for(a=0;a<o.length;a++)for(s=t[o[a]],i=0;i<s.length;i++)if(r=i+1,r%=s.length,c=h(e,n,s[i],s[r],!0),c.length>0)return!0;return!1}for(var s,i,r,c,l,d,u,f,p,g,v,j,y,_,n=e.concat(),o=[],b=[],a=0,x=t.length;x>a;a++)o.push(a);for(g=0,p=2*o.length;o.length>0;){if(p--,0>p){console.log("Infinite Loop! Holes left:"+o.length+", Probably Hole outside Shape!");break}for(i=g;i<n.length;i++){l=n[i],c=-1;for(a=0;a<o.length;a++)if(u=o[a],f=l.x+":"+l.y+":"+u,void 0===b[f]){s=t[u];for(r=0;r<s.length;r++)if(d=s[r],C(i,r)&&!O(l,d)&&!w(l,d)){c=r,o.splice(a,1),_=n.slice(0,i+1),y=n.slice(i),v=s.slice(c),j=s.slice(0,c+1),n=_.concat(v).concat(j).concat(y),g=i;break}if(c>=0)break;b[f]=!0}if(c>=0)break}}return n}for(var n,s,o,a,r,c,l,p,d={},i=e.concat(),u=0,v=t.length;v>u;u++)Array.prototype.push.apply(i,t[u]);for(n=0,a=i.length;a>n;n++)s=i[n].x+":"+i[n].y,void 0!==d[s]&&THREE.warn("THREE.Shape: Duplicate point",s),d[s]=n;p=g(e,t),c=THREE.FontUtils.Triangulate(p,!1);for(n=0,a=c.length;a>n;n++)for(r=c[n],o=0;3>o;o++)s=r[o].x+":"+r[o].y,l=d[s],void 0!==l&&(r[o]=l);return c.concat()},isClockWise:function(e){return THREE.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var n=1-e;return n*n*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,n,s){return this.b2p0(e,t)+this.b2p1(e,n)+this.b2p2(e,s)},b3p0:function(e,t){var n=1-e;return n*n*n*t},b3p1:function(e,t){var n=1-e;return 3*n*n*e*t},b3p2:function(e,t){var n=1-e;return 3*n*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,n,s,o){return this.b3p0(e,t)+this.b3p1(e,n)+this.b3p2(e,s)+this.b3p3(e,o)}},THREE.LineCurve=function(e,t){this.v1=e,this.v2=t},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.constructor=THREE.LineCurve,THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},THREE.LineCurve.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},THREE.QuadraticBezierCurve=function(e,t,n){this.v0=e,this.v1=t,this.v2=n},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve,THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t=new THREE.Vector2;return t.x=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t},THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t=new THREE.Vector2;return t.x=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),t.y=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t.normalize()},THREE.CubicBezierCurve=function(e,t,n,s){this.v0=e,this.v1=t,this.v2=n,this.v3=s},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve,THREE.CubicBezierCurve.prototype.getPoint=function(e){var t,n;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(t,n)},THREE.CubicBezierCurve.prototype.getTangent=function(e){var n=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),s=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t=new THREE.Vector2(n,s);return t.normalize(),t},THREE.SplineCurve=function(e){this.points=e??[]},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.constructor=THREE.SplineCurve,THREE.SplineCurve.prototype.getPoint=function(e){var t=this.points,o=(t.length-1)*e,n=Math.floor(o),i=o-n,a=t[0==n?n:n-1],r=t[n],c=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],s=new THREE.Vector2;return s.x=THREE.Curve.Utils.interpolate(a.x,r.x,c.x,l.x,i),s.y=THREE.Curve.Utils.interpolate(a.y,r.y,c.y,l.y,i),s},THREE.EllipseCurve=function(e,t,n,s,o,i,a){this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=i,this.aClockwise=a},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve,THREE.EllipseCurve.prototype.getPoint=function(e){var n,s,t=this.aEndAngle-this.aStartAngle;return 0>t&&(t+=2*Math.PI),t>2*Math.PI&&(t-=2*Math.PI),s=this.aClockwise===!0?this.aEndAngle+(1-e)*(2*Math.PI-t):this.aStartAngle+e*t,n=new THREE.Vector2,n.x=this.aX+this.xRadius*Math.cos(s),n.y=this.aY+this.yRadius*Math.sin(s),n},THREE.ArcCurve=function(e,t,n,s,o,i){THREE.EllipseCurve.call(this,e,t,n,n,s,o,i)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.ArcCurve.prototype.constructor=THREE.ArcCurve,THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new THREE.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,n){this.v0=e,this.v1=t,this.v2=n},function(e){var t=new THREE.Vector3;return t.x=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t.z=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),t}),THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,n,s){this.v0=e,this.v1=t,this.v2=n,this.v3=s},function(e){var t=new THREE.Vector3;return t.x=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t.y=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t.z=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),t}),THREE.SplineCurve3=THREE.Curve.create(function(e){this.points=e??[]},function(e){var t=this.points,l=(t.length-1)*e,n=Math.floor(l),o=l-n,i=t[0==n?n:n-1],a=t[n],r=t[n>t.length-2?t.length-1:n+1],c=t[n>t.length-3?t.length-1:n+2],s=new THREE.Vector3;return s.x=THREE.Curve.Utils.interpolate(i.x,a.x,r.x,c.x,o),s.y=THREE.Curve.Utils.interpolate(i.y,a.y,r.y,c.y,o),s.z=THREE.Curve.Utils.interpolate(i.z,a.z,r.z,c.z,o),s}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(e){this.points=e??[]},function(e){var t=this.points,l=(t.length-0)*e,n=Math.floor(l),o=l-n;n+=n>0?0:(Math.floor(Math.abs(n)/t.length)+1)*t.length;var i=t[(n-1)%t.length],a=t[n%t.length],r=t[(n+1)%t.length],c=t[(n+2)%t.length],s=new THREE.Vector3;return s.x=THREE.Curve.Utils.interpolate(i.x,a.x,r.x,c.x,o),s.y=THREE.Curve.Utils.interpolate(i.y,a.y,r.y,c.y,o),s.z=THREE.Curve.Utils.interpolate(i.z,a.z,r.z,c.z,o),s}),THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){THREE.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){THREE.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){THREE.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(e.initialized===!0)return e;for(n=0;n<e.hierarchy.length;n++){for(t=0;t<e.hierarchy[n].keys.length;t++)e.hierarchy[n].keys[t].time<0&&(e.hierarchy[n].keys[t].time=0),void 0!==e.hierarchy[n].keys[t].rot&&!(e.hierarchy[n].keys[t].rot instanceof THREE.Quaternion)&&(r=e.hierarchy[n].keys[t].rot,e.hierarchy[n].keys[t].rot=(new THREE.Quaternion).fromArray(r));if(e.hierarchy[n].keys.length&&void 0!==e.hierarchy[n].keys[0].morphTargets){for(var n,s,o,i,r,a={},t=0;t<e.hierarchy[n].keys.length;t++)for(s=0;s<e.hierarchy[n].keys[t].morphTargets.length;s++)o=e.hierarchy[n].keys[t].morphTargets[s],a[o]=-1;e.hierarchy[n].usedMorphTargets=a;for(t=0;t<e.hierarchy[n].keys.length;t++){i={};for(o in a){for(s=0;s<e.hierarchy[n].keys[t].morphTargets.length;s++)if(e.hierarchy[n].keys[t].morphTargets[s]===o){i[o]=e.hierarchy[n].keys[t].morphTargetsInfluences[s];break}s===e.hierarchy[n].keys[t].morphTargets.length&&(i[o]=0)}e.hierarchy[n].keys[t].morphTargetsInfluences=i}}for(t=1;t<e.hierarchy[n].keys.length;t++)e.hierarchy[n].keys[t].time===e.hierarchy[n].keys[t-1].time&&(e.hierarchy[n].keys.splice(t,1),t--);for(t=0;t<e.hierarchy[n].keys.length;t++)e.hierarchy[n].keys[t].index=t}return e.initialized=!0,e},parse:function(e){var t,s=function(e,t){t.push(e);for(var n=0;n<e.children.length;n++)s(e.children[n],t)},n=[];if(e instanceof THREE.SkinnedMesh)for(t=0;t<e.skeleton.bones.length;t++)n.push(e.skeleton.bones[t]);else s(e,n);return n},play:function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},stop:function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},update:function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].resetBlendWeights();for(t=0;t<this.animations.length;t++)this.animations[t].update(e)}},THREE.Animation=function(e,t){this.root=e,this.data=THREE.AnimationHandler.init(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=THREE.AnimationHandler.LINEAR},THREE.Animation.prototype={constructor:THREE.Animation,keyTypes:["pos","rot","scl"],play:function(e,t){this.currentTime=void 0!==e?e:0,this.weight=void 0!==t?t:1,this.isPlaying=!0,this.reset(),THREE.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,THREE.AnimationHandler.stop(this)},reset:function(){for(e=0,r=this.hierarchy.length;r>e;e++){n=this.hierarchy[e],void 0===n.animationCache&&(n.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var e,n,o,r,c=this.data.name,l=n.animationCache.animations,s=l[c];void 0===s&&(s={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:n.matrix},l[c]=s);for(o=0;3>o;o++){for(var i=this.keyTypes[o],a=this.data.hierarchy[e].keys[0],t=this.getNextKeyWith(i,e,1);t.time<this.currentTime&&t.index>a.index;)a=t,t=this.getNextKeyWith(i,e,t.index+1);s.prevKey[i]=a,s.nextKey[i]=t}}},resetBlendWeights:function(){for(var e,n,s,t=0,o=this.hierarchy.length;o>t;t++)s=this.hierarchy[t],n=s.animationCache,void 0!==n&&(e=n.blending,e.positionWeight=0,e.quaternionWeight=0,e.scaleWeight=0)},update:function(){var t=[],n=new THREE.Vector3,e=new THREE.Vector3,s=new THREE.Quaternion,i=function(e,t){var n,i,a,r,c,l,d,u,m,s=[],h=[];return m=(e.length-1)*t,n=Math.floor(m),i=m-n,s[0]=0===n?n:n-1,s[1]=n,s[2]=n>e.length-2?n:n+1,s[3]=n>e.length-3?n:n+2,c=e[s[0]],l=e[s[1]],d=e[s[2]],u=e[s[3]],a=i*i,r=i*a,h[0]=o(c[0],l[0],d[0],u[0],i,a,r),h[1]=o(c[1],l[1],d[1],u[1],i,a,r),h[2]=o(c[2],l[2],d[2],u[2],i,a,r),h},o=function(e,t,n,s,o,i,a){var r=.5*(n-e),c=.5*(s-t);return(2*(t-n)+r+c)*a+(-3*(t-n)-2*r-c)*i+r*o+t};return function(o){if(this.isPlaying!==!1&&(this.currentTime+=o*this.timeScale,0!==this.weight)){v=this.data.length,(this.currentTime>v||this.currentTime<0)&&(this.loop?(this.currentTime%=v,this.currentTime<0&&(this.currentTime+=v),this.reset()):this.stop());for(m=0,w=this.hierarchy.length;w>m;m++)for(var c,u,m,v,j,y,w,O,f=this.hierarchy[m],b=f.animationCache.animations[this.data.name],h=f.animationCache.blending,_=0;3>_;_++){var l=this.keyTypes[_],p=b.prevKey[l],d=b.nextKey[l];if(this.timeScale>0&&d.time<=this.currentTime||this.timeScale<0&&p.time>=this.currentTime){for(p=this.data.hierarchy[m].keys[0],d=this.getNextKeyWith(l,m,1);d.time<this.currentTime&&d.index>p.index;)p=d,d=this.getNextKeyWith(l,m,d.index+1);b.prevKey[l]=p,b.nextKey[l]=d}var a=(this.currentTime-p.time)/(d.time-p.time),r=p[l],g=d[l];0>a&&(a=0),a>1&&(a=1),"pos"===l?this.interpolationType===THREE.AnimationHandler.LINEAR?(e.x=r[0]+(g[0]-r[0])*a,e.y=r[1]+(g[1]-r[1])*a,e.z=r[2]+(g[2]-r[2])*a,u=this.weight/(this.weight+h.positionWeight),f.position.lerp(e,u),h.positionWeight+=this.weight):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(t[0]=this.getPrevKeyWith("pos",m,p.index-1).pos,t[1]=r,t[2]=g,t[3]=this.getNextKeyWith("pos",m,d.index+1).pos,a=.33*a+.33,j=i(t,a),u=this.weight/(this.weight+h.positionWeight),h.positionWeight+=this.weight,c=f.position,(c.x=c.x+(j[0]-c.x)*u,c.y=c.y+(j[1]-c.y)*u,c.z=c.z+(j[2]-c.z)*u,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(y=i(t,1.01*a),n.set(y[0],y[1],y[2]),n.sub(c),n.y=0,n.normalize(),O=Math.atan2(n.x,n.z),f.rotation.set(0,O,0))):"rot"===l?(THREE.Quaternion.slerp(r,g,s,a),0===h.quaternionWeight?(f.quaternion.copy(s),h.quaternionWeight=this.weight):(u=this.weight/(this.weight+h.quaternionWeight),THREE.Quaternion.slerp(f.quaternion,s,f.quaternion,u),h.quaternionWeight+=this.weight)):"scl"===l&&(e.x=r[0]+(g[0]-r[0])*a,e.y=r[1]+(g[1]-r[1])*a,e.z=r[2]+(g[2]-r[2])*a,u=this.weight/(this.weight+h.scaleWeight),f.scale.lerp(e,u),h.scaleWeight+=this.weight)}return!0}}}(),getNextKeyWith:function(e,t,n){var s=this.data.hierarchy[t].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?n=n<s.length-1?n:s.length-1:n%=s.length;n<s.length;n++)if(void 0!==s[n][e])return s[n];return this.data.hierarchy[t].keys[0]},getPrevKeyWith:function(e,t,n){var s=this.data.hierarchy[t].keys;for(n=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+s.length;n>=0;n--)if(void 0!==s[n][e])return s[n];return this.data.hierarchy[t].keys[s.length-1]}},THREE.KeyFrameAnimation=function(e){this.root=e.node,this.data=THREE.AnimationHandler.init(e),this.hierarchy=THREE.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(t=0,a=this.hierarchy.length;a>t;t++){var t,n,o,i,a,c=this.data.hierarchy[t].keys,s=this.data.hierarchy[t].sids,r=this.hierarchy[t];if(c.length&&s){for(n=0;n<s.length;n++)o=s[n],i=this.getNextKeyWith(o,t,0),i&&i.apply(o);r.matrixAutoUpdate=!1,this.data.hierarchy[t].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype={constructor:THREE.KeyFrameAnimation,play:function(e){if(this.currentTime=void 0!==e?e:0,this.isPlaying===!1){this.isPlaying=!0;var t,n,s,o,i=this.hierarchy.length;for(s=0;i>s;s++)o=this.hierarchy[s],t=this.data.hierarchy[s],void 0===t.animationCache&&(t.animationCache={},t.animationCache.prevKey=null,t.animationCache.nextKey=null,t.animationCache.originalMatrix=o.matrix),n=this.data.hierarchy[s].keys,n.length&&(t.animationCache.prevKey=n[0],t.animationCache.nextKey=n[1],this.startTime=Math.min(n[0].time,this.startTime),this.endTime=Math.max(n[n.length-1].time,this.endTime));this.update(0)}this.isPaused=!1,THREE.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.stop(this);for(e=0;e<this.data.hierarchy.length;e++){var e,n,s=this.hierarchy[e],t=this.data.hierarchy[e];void 0!==t.animationCache&&(n=t.animationCache.originalMatrix,n.copy(s.matrix),s.matrix=n,delete t.animationCache)}},update:function(e){if(this.isPlaying!==!1){this.currentTime+=e*this.timeScale,o=this.data.length,this.loop===!0&&this.currentTime>o&&(this.currentTime%=o),this.currentTime=Math.min(this.currentTime,o);for(s=0,a=this.hierarchy.length;a>s;s++){var t,n,s,o,a,l=this.hierarchy[s],r=this.data.hierarchy[s],c=r.keys,i=r.animationCache;if(c.length){if(n=i.prevKey,t=i.nextKey,t.time<=this.currentTime){for(;t.time<this.currentTime&&t.index>n.index;)n=t,t=c[n.index+1];i.prevKey=n,i.nextKey=t}t.time>=this.currentTime?n.interpolate(t,this.currentTime):n.interpolate(t,t.time),this.data.hierarchy[s].node.updateMatrix(),l.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(e,t,n){var s=this.data.hierarchy[t].keys;for(n%=s.length;n<s.length;n++)if(s[n].hasTarget(e))return s[n];return s[0]},getPrevKeyWith:function(e,t,n){var s=this.data.hierarchy[t].keys;for(n=n>=0?n:n+s.length;n>=0;n--)if(s[n].hasTarget(e))return s[n];return s[s.length-1]}},THREE.MorphAnimation=function(e){this.mesh=e,this.frames=e.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},THREE.MorphAnimation.prototype={constructor:THREE.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(e){if(this.isPlaying!==!1){this.currentTime+=e,this.loop===!0&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var s=this.duration/this.frames,n=Math.floor(this.currentTime/s),t=this.mesh.morphTargetInfluences;n!=this.currentFrame&&(t[this.lastFrame]=0,t[this.currentFrame]=1,t[n]=0,this.lastFrame=this.currentFrame,this.currentFrame=n),t[n]=this.currentTime%s/s,t[this.lastFrame]=1-t[n]}}},THREE.BoxGeometry=function(e,t,n,s,o,i){function r(e,t,n,s,o,i,r,c){var l,d,g,m=a.widthSegments,f=a.heightSegments,O=o/2,F=i/2,p=a.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?g="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(g="y",f=a.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(g="x",m=a.depthSegments);var v=m+1,M=f+1,A=o/m,E=i/f,h=new THREE.Vector3;for(h[g]=r>0?1:-1,d=0;M>d;d++)for(l=0;v>l;l++)b=new THREE.Vector3,b[e]=(l*A-O)*n,b[t]=(d*E-F)*s,b[g]=r,a.vertices.push(b);for(d=0;f>d;d++)for(l=0;m>l;l++){var b,x=l+v*d,w=l+v*(d+1),C=l+1+v*(d+1),_=l+1+v*d,k=new THREE.Vector2(l/m,1-d/f),y=new THREE.Vector2(l/m,1-(d+1)/f),S=new THREE.Vector2((l+1)/m,1-(d+1)/f),j=new THREE.Vector2((l+1)/m,1-d/f),u=new THREE.Face3(x+p,w+p,_+p);u.normal.copy(h),u.vertexNormals.push(h.clone(),h.clone(),h.clone()),u.materialIndex=c,a.faces.push(u),a.faceVertexUvs[0].push([k,y,j]),u=new THREE.Face3(w+p,C+p,_+p),u.normal.copy(h),u.vertexNormals.push(h.clone(),h.clone(),h.clone()),u.materialIndex=c,a.faces.push(u),a.faceVertexUvs[0].push([y.clone(),S,j.clone()])}}THREE.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:o,depthSegments:i},this.widthSegments=s||1,this.heightSegments=o||1,this.depthSegments=i||1;var a=this,c=e/2,l=t/2,d=n/2;r("z","y",-1,-1,n,t,c,0),r("z","y",1,-1,n,t,-c,1),r("x","z",1,1,e,n,l,2),r("x","z",1,-1,e,n,-l,3),r("x","y",1,-1,e,t,d,4),r("x","y",-1,-1,e,t,-d,5),this.mergeVertices()},THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry,THREE.CircleGeometry=function(e,t,n,s){THREE.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},e=e||50,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,s=void 0!==s?s:2*Math.PI;var o,i,r,c,a=[],d=new THREE.Vector3,l=new THREE.Vector2(.5,.5);for(this.vertices.push(d),a.push(l),o=0;t>=o;o++)i=new THREE.Vector3,c=n+o/t*s,i.x=e*Math.cos(c),i.y=e*Math.sin(c),this.vertices.push(i),a.push(new THREE.Vector2((i.x/e+1)/2,(i.y/e+1)/2));r=new THREE.Vector3(0,0,1);for(o=1;t>=o;o++)this.faces.push(new THREE.Face3(o,o+1,0,[r.clone(),r.clone(),r.clone()])),this.faceVertexUvs[0].push([a[o].clone(),a[o+1].clone(),l.clone()]);this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry,THREE.CubeGeometry=function(e,t,n,s,o,i){return THREE.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new THREE.BoxGeometry(e,t,n,s,o,i)},THREE.CylinderGeometry=function(e,t,n,s,o,i,a,r){THREE.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:o,openEnded:i,thetaStart:a,thetaLength:r},e=void 0!==e?e:20,t=void 0!==t?t:20,n=void 0!==n?n:100,s=s||8,o=o||1,i=void 0!==i&&i,a=void 0!==a?a:0,r=void 0!==r?r:2*Math.PI;var c,l,k=n/2,d=[],h=[];for(l=0;o>=l;l++){var M=[],S=[],C=l/o,T=C*(t-e)+e;for(c=0;s>=c;c++)x=c/s,y=new THREE.Vector3,y.x=T*Math.sin(x*r+a),y.y=-C*n+k,y.z=T*Math.cos(x*r+a),this.vertices.push(y),M.push(this.vertices.length-1),S.push(new THREE.Vector2(x,1-C));d.push(M),h.push(S)}E=(t-e)/n;for(c=0;s>c;c++)for(0!==e?(u=this.vertices[d[0][c]].clone(),m=this.vertices[d[0][c+1]].clone()):(u=this.vertices[d[1][c]].clone(),m=this.vertices[d[1][c+1]].clone()),u.setY(Math.sqrt(u.x*u.x+u.z*u.z)*E).normalize(),m.setY(Math.sqrt(m.x*m.x+m.z*m.z)*E).normalize(),l=0;o>l;l++){var u,m,y,x,E,w=d[l][c],g=d[l+1][c],O=d[l+1][c+1],A=d[l][c+1],v=u.clone(),p=u.clone(),_=m.clone(),F=m.clone(),b=h[l][c].clone(),f=h[l+1][c].clone(),j=h[l+1][c+1].clone(),z=h[l][c+1].clone();this.faces.push(new THREE.Face3(w,g,A,[v,p,F])),this.faceVertexUvs[0].push([b,f,z]),this.faces.push(new THREE.Face3(g,O,A,[p.clone(),_,F.clone()])),this.faceVertexUvs[0].push([f.clone(),j,z.clone()])}if(i===!1&&e>0)for(this.vertices.push(new THREE.Vector3(0,k,0)),c=0;s>c;c++){var w=d[0][c],g=d[0][c+1],O=this.vertices.length-1,v=new THREE.Vector3(0,1,0),p=new THREE.Vector3(0,1,0),_=new THREE.Vector3(0,1,0),b=h[0][c].clone(),f=h[0][c+1].clone(),j=new THREE.Vector2(f.x,0);this.faces.push(new THREE.Face3(w,g,O,[v,p,_])),this.faceVertexUvs[0].push([b,f,j])}if(i===!1&&t>0)for(this.vertices.push(new THREE.Vector3(0,-k,0)),c=0;s>c;c++){var w=d[o][c+1],g=d[o][c],O=this.vertices.length-1,v=new THREE.Vector3(0,-1,0),p=new THREE.Vector3(0,-1,0),_=new THREE.Vector3(0,-1,0),b=h[o][c+1].clone(),f=h[o][c].clone(),j=new THREE.Vector2(f.x,1);this.faces.push(new THREE.Face3(w,g,O,[v,p,_])),this.faceVertexUvs[0].push([b,f,j])}this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.ExtrudeGeometry=function(e,t){return"undefined"==typeof e?void(e=[]):(THREE.Geometry.call(this),this.type="ExtrudeGeometry",e=e instanceof Array?e:[e],this.addShapeList(e,t),void this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry,THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var s,o=e.length,n=0;o>n;n++)s=e[n],this.addShape(s,t)},THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function E(e,t,n){return t||THREE.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}function Y(e,t,n){var a,c,l,m,d=1e-10,u=1,s=e.x-t.x,o=e.y-t.y,i=n.x-e.x,r=n.y-e.y,h=s*s+o*o,_=s*r-o*i;if(Math.abs(_)>d){var f=Math.sqrt(h),p=Math.sqrt(i*i+r*r),g=t.x-o/f,v=t.y+s/f,j=n.x-r/p,y=n.y+i/p,b=((j-g)*r-(y-v)*i)/(s*r-o*i);if(c=g+s*b-e.x,a=v+o*b-e.y,m=c*c+a*a,2>=m)return new THREE.Vector2(c,a);u=Math.sqrt(m/2)}else l=!1,s>d?i>d&&(l=!0):-d>s?-d>i&&(l=!0):Math.sign(o)==Math.sign(r)&&(l=!0),l?(c=-o,a=s,u=Math.sqrt(h)):(c=s,a=o,u=Math.sqrt(h/2));return new THREE.Vector2(c/u,a/u)}function Z(){if(T){var t=0,e=g*t;for(n=0;B>n;n++)r=A[n],P(r[2]+e,r[1]+e,r[0]+e);for(t=h+2*O,e=g*t,n=0;B>n;n++)r=A[n],P(r[0]+e,r[1]+e,r[2]+e)}else{for(n=0;B>n;n++)r=A[n],P(r[2],r[1],r[0]);for(n=0;B>n;n++)r=A[n],P(r[0]+g*h,r[1]+g*h,r[2]+g*h)}}function Q(){var e=0;for(q(u,e),e+=u.length,s=0,l=c.length;l>s;s++)i=c[s],q(i,e),e+=i.length}function q(e,t){for(n=e.length;--n>=0;){i=n,o=n-1,0>o&&(o=e.length-1),s=0,a=h+2*O;for(s=0;a>s;s++){var s,o,i,a,r=g*s,c=g*(s+1),l=t+i+r,d=t+o+r,u=t+o+c,m=t+i+c;X(l,d,u,m,e,s,a,i,o)}}}function m(e,t,n){v.vertices.push(new THREE.Vector3(e,t,n))}function P(e,t,n){e+=C,t+=C,n+=C,v.faces.push(new THREE.Face3(e,t,n,null,null,ee));var s=U.generateTopUV(v,e,t,n);v.faceVertexUvs[0].push(s)}function X(e,t,n,s){e+=C,t+=C,n+=C,s+=C,v.faces.push(new THREE.Face3(e,t,s,null,null,W)),v.faces.push(new THREE.Face3(t,n,s,null,null,W));var l=U.generateSideWallUV(v,e,t,n,s);v.faceVertexUvs[0].push([l[0],l[1],l[3]]),v.faceVertexUvs[0].push([l[1],l[2],l[3]])}var u,f,_,x,A,S,M,F,z,D,N,$=void 0!==t.amount?t.amount:100,R=void 0!==t.bevelThickness?t.bevelThickness:6,L=void 0!==t.bevelSize?t.bevelSize:R-2,O=void 0!==t.bevelSegments?t.bevelSegments:3,T=void 0===t.bevelEnabled||t.bevelEnabled,J=void 0!==t.curveSegments?t.curveSegments:12,h=void 0!==t.steps?t.steps:1,V=t.extrudePath,I=!1,ee=t.material,W=t.extrudeMaterial,U=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;V&&(D=V.getSpacedPoints(h),I=!0,T=!1,M=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(V,h,!1),S=new THREE.Vector3,z=new THREE.Vector3,f=new THREE.Vector3),T||(O=0,R=0,L=0);var s,i,l,v=this,C=this.vertices.length,G=e.extractPoints(J),d=G.shape,c=G.holes,K=!THREE.Shape.Utils.isClockWise(d);if(K){for(d=d.reverse(),s=0,l=c.length;l>s;s++)i=c[s],THREE.Shape.Utils.isClockWise(i)&&(c[s]=i.reverse());K=!1}A=THREE.Shape.Utils.triangulateShape(d,c),u=d;for(s=0,l=c.length;l>s;s++)i=c[s],d=d.concat(i);for(var o,r,p,y,w,k,g=d.length,B=A.length,H=[],n=0,a=u.length,b=a-1,j=n+1;a>n;n++,b++,j++)b===a&&(b=0),j===a&&(j=0),H[n]=Y(u[n],u[b],u[j]);N=[],F=H.concat();for(s=0,l=c.length;l>s;s++){for(i=c[s],_=[],n=0,a=i.length,b=a-1,j=n+1;a>n;n++,b++,j++)b===a&&(b=0),j===a&&(j=0),_[n]=Y(i[n],i[b],i[j]);N.push(_),F=F.concat(_)}for(y=0;O>y;y++){for(k=y/O,w=R*(1-k),p=L*Math.sin(k*Math.PI/2),n=0,a=u.length;a>n;n++)o=E(u[n],H[n],p),m(o.x,o.y,-w);for(s=0,l=c.length;l>s;s++)for(i=c[s],_=N[s],n=0,a=i.length;a>n;n++)o=E(i[n],_[n],p),m(o.x,o.y,-w)}for(p=L,n=0;g>n;n++)o=T?E(d[n],F[n],p):d[n],I?(z.copy(M.normals[0]).multiplyScalar(o.x),S.copy(M.binormals[0]).multiplyScalar(o.y),f.copy(D[0]).add(z).add(S),m(f.x,f.y,f.z)):m(o.x,o.y,0);for(x=1;h>=x;x++)for(n=0;g>n;n++)o=T?E(d[n],F[n],p):d[n],I?(z.copy(M.normals[x]).multiplyScalar(o.x),S.copy(M.binormals[x]).multiplyScalar(o.y),f.copy(D[x]).add(z).add(S),m(f.x,f.y,f.z)):m(o.x,o.y,$/h*x);for(y=O-1;y>=0;y--){for(k=y/O,w=R*(1-k),p=L*Math.sin(k*Math.PI/2),n=0,a=u.length;a>n;n++)o=E(u[n],H[n],p),m(o.x,o.y,$+w);for(s=0,l=c.length;l>s;s++)for(i=c[s],_=N[s],n=0,a=i.length;a>n;n++)o=E(i[n],_[n],p),I?m(o.x,o.y+D[h-1].y,D[h-1].x+w):m(o.x,o.y,$+w)}Z(),Q()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,n,s){var o=e.vertices,i=o[t],a=o[n],r=o[s];return[new THREE.Vector2(i.x,i.y),new THREE.Vector2(a.x,a.y),new THREE.Vector2(r.x,r.y)]},generateSideWallUV:function(e,t,n,s,o){var r=e.vertices,i=r[t],a=r[n],c=r[s],l=r[o];return Math.abs(i.y-a.y)<.01?[new THREE.Vector2(i.x,1-i.z),new THREE.Vector2(a.x,1-a.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(l.x,1-l.z)]:[new THREE.Vector2(i.y,1-i.z),new THREE.Vector2(a.y,1-a.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(l.y,1-l.z)]}},THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this),this.type="ShapeGeometry",e instanceof Array==!1&&(e=[e]),this.addShapeList(e,t),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry,THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var n=0,s=e.length;s>n;n++)this.addShape(e[n],t);return this},THREE.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var n,i,a,r,c,d,m,f,y=void 0!==t.curveSegments?t.curveSegments:12,j=t.material,b=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,l=this.vertices.length,u=e.extractPoints(y),s=u.shape,o=u.holes,h=!THREE.Shape.Utils.isClockWise(s);if(h){for(s=s.reverse(),n=0,a=o.length;a>n;n++)i=o[n],THREE.Shape.Utils.isClockWise(i)&&(o[n]=i.reverse());h=!1}d=THREE.Shape.Utils.triangulateShape(s,o);for(n=0,a=o.length;a>n;n++)i=o[n],s=s.concat(i);m=s.length,f=d.length;for(n=0;m>n;n++)c=s[n],this.vertices.push(new THREE.Vector3(c.x,c.y,0));for(n=0;f>n;n++){r=d[n];var p=r[0]+l,g=r[1]+l,v=r[2]+l;this.faces.push(new THREE.Face3(p,g,v,null,null,j)),this.faceVertexUvs[0].push(b.generateTopUV(this,p,g,v))}},THREE.LatheGeometry=function(e,t,n,s){THREE.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=t||12,n=n||0,s=s||2*Math.PI;for(var b=1/(e.length-1),f=1/t,i=0,p=t;p>=i;i++)for(var _=n+i*f*s,c=Math.cos(_),w=Math.sin(_),o=0,h=e.length;h>o;o++)a=e[o],r=new THREE.Vector3,r.x=c*a.x-w*a.y,r.y=w*a.x+c*a.y,r.z=a.z,this.vertices.push(r);for(var m=e.length,i=0,p=t;p>i;i++)for(o=0,h=e.length-1;h>o;o++){var o,a,r,h,l=o+m*i,O=l,j=l+m,c=l+1+m,y=l+1,u=i*f,d=o*b,g=u+f,v=d+b;this.faces.push(new THREE.Face3(O,j,y)),this.faceVertexUvs[0].push([new THREE.Vector2(u,d),new THREE.Vector2(g,d),new THREE.Vector2(u,v)]),this.faces.push(new THREE.Face3(j,c,y)),this.faceVertexUvs[0].push([new THREE.Vector2(g,d),new THREE.Vector2(g,v),new THREE.Vector2(u,v)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry,THREE.PlaneGeometry=function(e,t,n,s){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."),THREE.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s},this.fromBufferGeometry(new THREE.PlaneBufferGeometry(e,t,n,s))},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.PlaneBufferGeometry=function(e,t,n,s){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};for(var i,r,p,b,O=e/2,_=t/2,l=n||1,d=s||1,c=l+1,u=d+1,C=e/l,y=t/d,h=new Float32Array(c*u*3),g=new Float32Array(c*u*3),m=new Float32Array(c*u*2),o=0,f=0,a=0;u>a;a++)for(b=a*y-_,i=0;c>i;i++)p=i*C-O,h[o]=p,h[o+1]=-b,g[o+2]=1,m[f]=i/l,m[f+1]=1-a/d,o+=3,f+=2;o=0;for(r=new(h.length/3>65535?Uint32Array:Uint16Array)(l*d*6),a=0;d>a;a++)for(i=0;l>i;i++){var w=i+c*a,j=i+c*(a+1),x=i+1+c*(a+1),v=i+1+c*a;r[o]=w,r[o+1]=j,r[o+2]=v,r[o+3]=j,r[o+4]=x,r[o+5]=v,o+=6}this.addAttribute("index",new THREE.BufferAttribute(r,1)),this.addAttribute("position",new THREE.BufferAttribute(h,3)),this.addAttribute("normal",new THREE.BufferAttribute(g,3)),this.addAttribute("uv",new THREE.BufferAttribute(m,2))},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry,THREE.RingGeometry=function(e,t,n,s,o,i){THREE.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:o,thetaLength:i},e=e||0,t=t||50,o=void 0!==o?o:0,i=void 0!==i?i:2*Math.PI,n=void 0!==n?Math.max(3,n):8,s=void 0!==s?Math.max(1,s):8;var r,c,l=[],p=e,v=(t-e)/s;for(c=0;s+1>c;c++){for(r=0;n+1>r;r++)u=new THREE.Vector3,a=o+r/n*i,u.x=p*Math.cos(a),u.y=p*Math.sin(a),this.vertices.push(u),l.push(new THREE.Vector2((u.x/t+1)/2,(u.y/t+1)/2));p+=v}d=new THREE.Vector3(0,0,1);for(c=0;s>c;c++){g=c*(n+1);for(r=0;n>r;r++){var d,u,g,a=r+g,h=a,m=a+n+1,f=a+n+2;this.faces.push(new THREE.Face3(h,m,f,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([l[h].clone(),l[m].clone(),l[f].clone()]),h=a,m=a+n+2,f=a+1,this.faces.push(new THREE.Face3(h,m,f,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([l[h].clone(),l[m].clone(),l[f].clone()])}}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,p)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry.prototype.constructor=THREE.RingGeometry,THREE.SphereGeometry=function(e,t,n,s,o,i,a){THREE.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:o,thetaStart:i,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),s=void 0!==s?s:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?i:0,a=void 0!==a?a:Math.PI,l=[],d=[];for(c=0;n>=c;c++){k=[],_=[];for(r=0;t>=r;r++){var E=r/t,g=c/n,v=new THREE.Vector3;v.x=-e*Math.cos(s+E*o)*Math.sin(i+g*a),v.y=e*Math.cos(i+g*a),v.z=e*Math.sin(s+E*o)*Math.sin(i+g*a),this.vertices.push(v),k.push(this.vertices.length-1),_.push(new THREE.Vector2(E,1-g))}l.push(k),d.push(_)}for(c=0;n>c;c++)for(r=0;t>r;r++){var r,c,l,d,_,k,m=l[c][r+1],b=l[c][r],f=l[c+1][r],j=l[c+1][r+1],C=this.vertices[m].clone().normalize(),x=this.vertices[b].clone().normalize(),w=this.vertices[f].clone().normalize(),O=this.vertices[j].clone().normalize(),h=d[c][r+1].clone(),y=d[c][r].clone(),u=d[c+1][r].clone(),p=d[c+1][r+1].clone();Math.abs(this.vertices[m].y)===e?(h.x=(h.x+y.x)/2,this.faces.push(new THREE.Face3(m,f,j,[C,w,O])),this.faceVertexUvs[0].push([h,u,p])):Math.abs(this.vertices[f].y)===e?(u.x=(u.x+p.x)/2,this.faces.push(new THREE.Face3(m,b,f,[C,x,w])),this.faceVertexUvs[0].push([h,y,u])):(this.faces.push(new THREE.Face3(m,b,j,[C,x,O])),this.faceVertexUvs[0].push([h,y,p]),this.faces.push(new THREE.Face3(b,f,j,[x.clone(),w,O.clone()])),this.faceVertexUvs[0].push([y.clone(),u,p.clone()]))}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.TextGeometry=function(e,t){t=t||{};var n=THREE.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,n,t),this.type="TextGeometry"},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TextGeometry.prototype.constructor=THREE.TextGeometry,THREE.TorusGeometry=function(e,t,n,s,o){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:o},e=e||100,t=t||40,n=n||8,s=s||6,o=o||2*Math.PI;for(var p=new THREE.Vector3,r=[],c=[],a=0;n>=a;a++)for(i=0;s>=i;i++)h=i/s*o,m=a/n*Math.PI*2,p.x=e*Math.cos(h),p.y=e*Math.sin(h),d=new THREE.Vector3,d.x=(e+t*Math.cos(m))*Math.cos(h),d.y=(e+t*Math.cos(m))*Math.sin(h),d.z=t*Math.sin(m),this.vertices.push(d),r.push(new THREE.Vector2(i/s,a/n)),c.push(d.clone().sub(p).normalize());for(a=1;n>=a;a++)for(i=1;s>=i;i++){var i,a,d,h,m,f=(s+1)*a+i-1,l=(s+1)*(a-1)+i-1,g=(s+1)*(a-1)+i,u=(s+1)*a+i,v=new THREE.Face3(f,l,u,[c[f].clone(),c[l].clone(),c[u].clone()]);this.faces.push(v),this.faceVertexUvs[0].push([r[f].clone(),r[l].clone(),r[u].clone()]),v=new THREE.Face3(l,g,u,[c[l].clone(),c[g].clone(),c[u].clone()]),this.faces.push(v),this.faceVertexUvs[0].push([r[l].clone(),r[g].clone(),r[u].clone()])}this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry,THREE.TorusKnotGeometry=function(e,t,n,s,o,i,a){function y(e,t,n,s,o){var r=Math.cos(e),c=Math.sin(e),i=t/n*e,a=Math.cos(i),l=s*(2+a)*.5*r,d=s*(2+a)*c*.5,u=o*s*Math.sin(i)*.5;return new THREE.Vector3(l,d,u)}THREE.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,p:o,q:i,heightScale:a},e=e||100,t=t||40,n=n||64,s=s||8,o=o||2,i=i||3,a=a||1;for(var d=new Array(n),p=new THREE.Vector3,l=new THREE.Vector3,u=new THREE.Vector3,r=0;n>r;++r){d[r]=new Array(s);var v=r/n*2*o*Math.PI,h=y(v,i,o,e,a),j=y(v+.01,i,o,e,a);p.subVectors(j,h),l.addVectors(j,h),u.crossVectors(p,l),l.crossVectors(u,p),u.normalize(),l.normalize();for(c=0;s>c;++c){var x=c/s*2*Math.PI,f=-t*Math.cos(x),g=t*Math.sin(x),m=new THREE.Vector3;m.x=h.x+f*l.x+g*u.x,m.y=h.y+f*l.y+g*u.y,m.z=h.z+f*l.z+g*u.z,d[r][c]=this.vertices.push(m)-1}}for(r=0;n>r;++r)for(c=0;s>c;++c){var r,c,_=(r+1)%n,w=(c+1)%s,M=d[r][c],b=d[_][c],A=d[_][w],E=d[r][w],k=new THREE.Vector2(r/n,c/s),C=new THREE.Vector2((r+1)/n,c/s),S=new THREE.Vector2((r+1)/n,(c+1)/s),O=new THREE.Vector2(r/n,(c+1)/s);this.faces.push(new THREE.Face3(M,b,E)),this.faceVertexUvs[0].push([k,C,O]),this.faces.push(new THREE.Face3(b,A,E)),this.faceVertexUvs[0].push([C.clone(),S,O.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry,THREE.TubeGeometry=function(e,t,n,s,o,i){function z(e,t,n){return D.vertices.push(new THREE.Vector3(e,t,n))-1}THREE.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:t,radius:n,radialSegments:s,closed:o},t=t||64,n=n||1,s=s||8,o=o||!1,i=i||THREE.TubeGeometry.NoTaper;var a,r,d,u,h,m,f,p,g,v,b,j,_,w,O,x,C,E,k,S,N,l=[],D=this,A=t+1,c=new THREE.Vector3,y=new THREE.TubeGeometry.FrenetFrames(e,t,o),M=y.tangents,F=y.normals,T=y.binormals;for(this.tangents=M,this.normals=F,this.binormals=T,a=0;A>a;a++)for(l[a]=[],w=a/(A-1),S=e.getPointAt(w),N=M[a],u=F[a],h=T[a],g=n*i(w),r=0;s>r;r++)v=r/s*2*Math.PI,m=-g*Math.cos(v),d=g*Math.sin(v),c.copy(S),c.x+=m*u.x+d*h.x,c.y+=m*u.y+d*h.y,c.z+=m*u.z+d*h.z,l[a][r]=z(c.x,c.y,c.z);for(a=0;t>a;a++)for(r=0;s>r;r++)b=o?(a+1)%t:a+1,j=(r+1)%s,x=l[a][r],_=l[b][r],k=l[b][j],O=l[a][j],C=new THREE.Vector2(a/t,r/s),p=new THREE.Vector2((a+1)/t,r/s),E=new THREE.Vector2((a+1)/t,(r+1)/s),f=new THREE.Vector2(a/t,(r+1)/s),this.faces.push(new THREE.Face3(x,_,O)),this.faceVertexUvs[0].push([C,p,f]),this.faces.push(new THREE.Face3(_,k,O)),this.faceVertexUvs[0].push([p.clone(),E,f.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry,THREE.TubeGeometry.NoTaper=function(){return 1},THREE.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)},THREE.TubeGeometry.FrenetFrames=function(e,t,n){function v(){i[0]=new THREE.Vector3,l[0]=new THREE.Vector3,d=Number.MAX_VALUE,m=Math.abs(o[0].x),h=Math.abs(o[0].y),p=Math.abs(o[0].z),d>=m&&(d=m,u.set(1,0,0)),d>=h&&(d=h,u.set(0,1,0)),d>=p&&u.set(0,0,1),c.crossVectors(o[0],u).normalize(),i[0].crossVectors(o[0],c),l[0].crossVectors(o[0],i[0])}var s,a,d,h,m,f,p,u=new THREE.Vector3,o=[],i=[],l=[],c=new THREE.Vector3,g=new THREE.Matrix4,r=t+1,b=1e-4;for(this.tangents=o,this.normals=i,this.binormals=l,s=0;r>s;s++)f=s/(r-1),o[s]=e.getTangentAt(f),o[s].normalize();for(v(),s=1;r>s;s++)i[s]=i[s-1].clone(),l[s]=l[s-1].clone(),c.crossVectors(o[s-1],o[s]),c.length()>b&&(c.normalize(),a=Math.acos(THREE.Math.clamp(o[s-1].dot(o[s]),-1,1)),i[s].applyMatrix4(g.makeRotationAxis(c,a))),l[s].crossVectors(o[s],i[s]);if(n)for(a=Math.acos(THREE.Math.clamp(i[0].dot(i[r-1]),-1,1)),a/=r-1,o[0].dot(c.crossVectors(i[0],i[r-1]))>0&&(a=-a),s=1;r>s;s++)i[s].applyMatrix4(g.makeRotationAxis(o[s],a*s)),l[s].crossVectors(o[s],i[s])},THREE.PolyhedronGeometry=function(e,t,n,s){function a(e){t=e.normalize().clone(),t.index=r.vertices.push(t)-1;var t,n=_(e)/2/Math.PI+.5,s=O(e)/Math.PI+.5;return t.uv=new THREE.Vector2(n,1-s),t}function y(e,t,n){var s,o=new THREE.Face3(e.index,t.index,n.index,[e.clone(),t.clone(),n.clone()]);r.faces.push(o),j.copy(e).add(t).add(n).divideScalar(3),s=_(j),r.faceVertexUvs[0].push([d(e.uv,e,s),d(t.uv,t,s),d(n.uv,n,s)])}function w(e,t){for(var s,c,i=Math.pow(2,t),h=a(r.vertices[e.a]),m=a(r.vertices[e.b]),l=a(r.vertices[e.c]),o=[],n=0;i>=n;n++){o[n]=[];for(var d=a(h.clone().lerp(l,n/i)),f=a(m.clone().lerp(l,n/i)),u=i-n,s=0;u>=s;s++)0==s&&n==i?o[n][s]=d:o[n][s]=a(d.clone().lerp(f,s/u))}for(n=0;i>n;n++)for(s=0;2*(i-n)-1>s;s++)c=Math.floor(s/2),s%2==0?y(o[n][c+1],o[n+1][c],o[n][c]):y(o[n][c+1],o[n+1][c+1],o[n+1][c])}function _(e){return Math.atan2(e.z,-e.x)}function O(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function d(e,t,n){return 0>n&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(n/2/Math.PI+.5,e.y)),e.clone()}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s},n=n||1,s=s||0;for(var r=this,o=0,i=e.length;i>o;o+=3)a(new THREE.Vector3(e[o],e[o+1],e[o+2]));for(var m=this.vertices,l=[],o=0,b=0,i=t.length;i>o;o+=3,b++){var g=m[t[o]],v=m[t[o+1]],p=m[t[o+2]];l[b]=new THREE.Face3(g.index,v.index,p.index,[g.clone(),v.clone(),p.clone()])}for(var j=new THREE.Vector3,o=0,i=l.length;i>o;o++)w(l[o],s);for(o=0,i=this.faceVertexUvs[0].length;i>o;o++){var o,i,c=this.faceVertexUvs[0][o],f=c[0].x,h=c[1].x,u=c[2].x,x=Math.max(f,Math.max(h,u)),C=Math.min(f,Math.min(h,u));x>.9&&.1>C&&(.2>f&&(c[0].x+=1),.2>h&&(c[1].x+=1),.2>u&&(c[2].x+=1))}for(o=0,i=this.vertices.length;i>o;o++)this.vertices[o].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,n)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.DodecahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var n=(1+Math.sqrt(5))/2,s=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],i=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];THREE.PolyhedronGeometry.call(this,o,i,e,t)},THREE.DodecahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry,THREE.IcosahedronGeometry=function(e,t){var n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];THREE.PolyhedronGeometry.call(this,s,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,THREE.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];THREE.PolyhedronGeometry.call(this,n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry,THREE.TetrahedronGeometry=function(e,t){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];THREE.PolyhedronGeometry.call(this,n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry,THREE.ParametricGeometry=function(e,t,n){THREE.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var s,o,a,r,c,l,u,h,m,f,p,g,b,j=this.vertices,v=this.faces,d=this.faceVertexUvs[0],i=t+1;for(o=0;n>=o;o++)for(m=o/n,s=0;t>=s;s++)u=s/t,p=e(u,m),j.push(p);for(o=0;n>o;o++)for(s=0;t>s;s++)h=o*i+s,r=o*i+s+1,f=(o+1)*i+s+1,a=(o+1)*i+s,g=new THREE.Vector2(s/t,o/n),l=new THREE.Vector2((s+1)/t,o/n),b=new THREE.Vector2((s+1)/t,(o+1)/n),c=new THREE.Vector2(s/t,(o+1)/n),v.push(new THREE.Face3(h,r,a)),d.push([g,l,c]),v.push(new THREE.Face3(r,f,a)),d.push([l.clone(),b,c.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry,THREE.AxisHelper=function(e){e=e||1;var n,s=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),o=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),t=new THREE.BufferGeometry;t.addAttribute("position",new THREE.BufferAttribute(s,3)),t.addAttribute("color",new THREE.BufferAttribute(o,3)),n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),THREE.Line.call(this,t,n,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.AxisHelper.prototype.constructor=THREE.AxisHelper,THREE.ArrowHelper=function(){var e,t=new THREE.Geometry;return t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0)),e=new THREE.CylinderGeometry(0,.5,1,5,1),e.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),function(n,s,o,i,a,r){THREE.Object3D.call(this),void 0===i&&(i=16776960),void 0===o&&(o=1),void 0===a&&(a=.2*o),void 0===r&&(r=.2*a),this.position.copy(s),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(o,a,r)}}(),THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper,THREE.ArrowHelper.prototype.setDirection=function(){var e,t=new THREE.Vector3;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(n.z,0,-n.x).normalize(),e=Math.acos(n.y),this.quaternion.setFromAxisAngle(t,e))}}(),THREE.ArrowHelper.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,e-t,1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},THREE.BoxHelper=function(e){var t=new THREE.BufferGeometry;t.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3)),THREE.Line.call(this,t,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces),void 0!==e&&this.update(e)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.constructor=THREE.BoxHelper,THREE.BoxHelper.prototype.update=function(e){o=e.geometry,null===o.boundingBox&&o.computeBoundingBox();var o,n=o.boundingBox.min,s=o.boundingBox.max,t=this.geometry.attributes.position.array;t[0]=s.x,t[1]=s.y,t[2]=s.z,t[3]=n.x,t[4]=s.y,t[5]=s.z,t[6]=n.x,t[7]=s.y,t[8]=s.z,t[9]=n.x,t[10]=n.y,t[11]=s.z,t[12]=n.x,t[13]=n.y,t[14]=s.z,t[15]=s.x,t[16]=n.y,t[17]=s.z,t[18]=s.x,t[19]=n.y,t[20]=s.z,t[21]=s.x,t[22]=s.y,t[23]=s.z,t[24]=s.x,t[25]=s.y,t[26]=n.z,t[27]=n.x,t[28]=s.y,t[29]=n.z,t[30]=n.x,t[31]=s.y,t[32]=n.z,t[33]=n.x,t[34]=n.y,t[35]=n.z,t[36]=n.x,t[37]=n.y,t[38]=n.z,t[39]=s.x,t[40]=n.y,t[41]=n.z,t[42]=s.x,t[43]=n.y,t[44]=n.z,t[45]=s.x,t[46]=s.y,t[47]=n.z,t[48]=s.x,t[49]=s.y,t[50]=s.z,t[51]=s.x,t[52]=s.y,t[53]=n.z,t[54]=n.x,t[55]=s.y,t[56]=s.z,t[57]=n.x,t[58]=s.y,t[59]=n.z,t[60]=n.x,t[61]=n.y,t[62]=s.z,t[63]=n.x,t[64]=n.y,t[65]=n.z,t[66]=s.x,t[67]=n.y,t[68]=s.z,t[69]=s.x,t[70]=n.y,t[71]=n.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},THREE.BoundingBoxHelper=function(e,t){var n=void 0!==t?t:8947848;this.object=e,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:n,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper,THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(e){function t(e,t,n){c(e,n),c(t,n)}function c(e,t){o.vertices.push(new THREE.Vector3),o.colors.push(new THREE.Color(t)),void 0===i[e]&&(i[e]=[]),i[e].push(o.vertices.length-1)}var o=new THREE.Geometry,l=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),i={},n=16755200,a=16711680,r=43775,d=16777215,s=3355443;t("n1","n2",n),t("n2","n4",n),t("n4","n3",n),t("n3","n1",n),t("f1","f2",n),t("f2","f4",n),t("f4","f3",n),t("f3","f1",n),t("n1","f1",n),t("n2","f2",n),t("n3","f3",n),t("n4","f4",n),t("p","n1",a),t("p","n2",a),t("p","n3",a),t("p","n4",a),t("u1","u2",r),t("u2","u3",r),t("u3","u1",r),t("c","t",d),t("p","c",s),t("cn1","cn2",s),t("cn3","cn4",s),t("cf1","cf2",s),t("cf3","cf4",s),THREE.Line.call(this,o,l,THREE.LinePieces),this.camera=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=i,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.constructor=THREE.CameraHelper,THREE.CameraHelper.prototype.update=function(){var t,n,s=new THREE.Vector3,o=new THREE.Camera,e=function(e,i,a,r){if(s.set(i,a,r).unproject(o),c=n[e],void 0!==c)for(var c,l=0,d=c.length;d>l;l++)t.vertices[c[l]].copy(s)};return function(){t=this.geometry,n=this.pointMap;var i=1,s=1;o.projectionMatrix.copy(this.camera.projectionMatrix),e("c",0,0,-1),e("t",0,0,1),e("n1",-i,-s,-1),e("n2",i,-s,-1),e("n3",-i,s,-1),e("n4",i,s,-1),e("f1",-i,-s,1),e("f2",i,-s,1),e("f3",-i,s,1),e("f4",i,s,1),e("u1",.7*i,1.1*s,-1),e("u2",.7*-i,1.1*s,-1),e("u3",0,2*s,-1),e("cf1",-i,0,1),e("cf2",i,0,1),e("cf3",0,-s,1),e("cf4",0,s,1),e("cn1",-i,0,-1),e("cn2",i,0,-1),e("cn3",0,-s,-1),e("cn4",0,s,-1),t.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,t=t||1;var n,s=new THREE.Geometry;s.vertices.push(new THREE.Vector3(-t,t,0),new THREE.Vector3(t,t,0),new THREE.Vector3(t,-t,0),new THREE.Vector3(-t,-t,0),new THREE.Vector3(-t,t,0)),n=new THREE.LineBasicMaterial({fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Line(s,n),this.add(this.lightPlane),s=new THREE.Geometry,s.vertices.push(new THREE.Vector3,new THREE.Vector3),n=new THREE.LineBasicMaterial({fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(s,n),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper,THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},THREE.DirectionalLightHelper.prototype.update=function(){var t=new THREE.Vector3,n=new THREE.Vector3,e=new THREE.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),n.setFromMatrixPosition(this.light.target.matrixWorld),e.subVectors(n,t),this.lightPlane.lookAt(e),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(e),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.EdgesHelper=function(e,t,n){g=void 0!==t?t:16777215,n=void 0!==n?n:1;var s,o,i,a,c,l,u,f,g,w=Math.cos(THREE.Math.degToRad(n)),r=[0,0],d={},_=function(e,t){return e-t},j=["a","b","c"],b=new THREE.BufferGeometry;e.geometry instanceof THREE.BufferGeometry?(i=new THREE.Geometry,i.fromBufferGeometry(e.geometry)):i=e.geometry.clone(),i.mergeVertices(),i.computeFaceNormals();for(var v=i.vertices,m=i.faces,p=0,h=0,y=m.length;y>h;h++)for(f=m[h],u=0;3>u;u++)r[0]=f[j[u]],r[1]=f[j[(u+1)%3]],r.sort(_),l=r.toString(),void 0===d[l]?(d[l]={vert1:r[0],vert2:r[1],face1:h,face2:void 0},p++):d[l].face2=h;o=new Float32Array(2*p*3),a=0;for(l in d)c=d[l],(void 0===c.face2||m[c.face1].normal.dot(m[c.face2].normal)<=w)&&(s=v[c.vert1],o[a++]=s.x,o[a++]=s.y,o[a++]=s.z,s=v[c.vert2],o[a++]=s.x,o[a++]=s.y,o[a++]=s.z);b.addAttribute("position",new THREE.BufferAttribute(o,3)),THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:g}),THREE.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype),THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper,THREE.FaceNormalsHelper=function(e,t,n,s){this.object=e,this.size=void 0!==t?t:1;for(var a=void 0!==n?n:16776960,r=void 0!==s?s:1,o=new THREE.Geometry,c=this.object.geometry.faces,i=0,l=c.length;l>i;i++)o.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:a,linewidth:r}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper,THREE.FaceNormalsHelper.prototype.update=function(){var e,s=this.geometry.vertices,t=this.object,o=t.geometry.vertices,a=t.geometry.faces,r=t.matrixWorld;t.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(r);for(var i=0,n=0,c=a.length;c>i;i++,n+=2)e=a[i],s[n].copy(o[e.a]).add(o[e.b]).add(o[e.c]).divideScalar(3).applyMatrix4(r),s[n+1].copy(e.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(s[n]);return this.geometry.verticesNeedUpdate=!0,this},THREE.GridHelper=function(e,t){var n,s,o=new THREE.Geometry,i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(n=-e;e>=n;n+=t)o.vertices.push(new THREE.Vector3(-e,0,n),new THREE.Vector3(e,0,n),new THREE.Vector3(n,0,-e),new THREE.Vector3(n,0,e)),s=0===n?this.color1:this.color2,o.colors.push(s,s,s,s);THREE.Line.call(this,o,i,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.GridHelper.prototype.constructor=THREE.GridHelper,THREE.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color],n=new THREE.SphereGeometry(t,4,2),n.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var n,o,s=0,i=8;i>s;s++)n.faces[s].color=this.colors[4>s?0:1];o=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0}),this.lightSphere=new THREE.Mesh(n,o),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper,THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},THREE.HemisphereLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var s=new THREE.SphereGeometry(t,4,2),n=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,s,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper,THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var s,o,t=new THREE.Geometry,n=0;n<this.bones.length;n++)s=this.bones[n],s.parent instanceof THREE.Bone&&(t.vertices.push(new THREE.Vector3),t.vertices.push(new THREE.Vector3),t.colors.push(new THREE.Color(0,0,1)),t.colors.push(new THREE.Color(0,1,0)));o=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0}),THREE.Line.call(this,t,o,THREE.LinePieces),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype),THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper,THREE.SkeletonHelper.prototype.getBoneList=function(e){var n,t=[];e instanceof THREE.Bone&&t.push(e);for(n=0;n<e.children.length;n++)t.push.apply(t,this.getBoneList(e.children[n]));return t},THREE.SkeletonHelper.prototype.update=function(){for(var n,e=this.geometry,i=(new THREE.Matrix4).getInverse(this.root.matrixWorld),t=new THREE.Matrix4,s=0,o=0;o<this.bones.length;o++)n=this.bones[o],n.parent instanceof THREE.Bone&&(t.multiplyMatrices(i,n.matrixWorld),e.vertices[s].setFromMatrixPosition(t),t.multiplyMatrices(i,n.parent.matrixWorld),e.vertices[s+1].setFromMatrixPosition(t),s+=2);e.verticesNeedUpdate=!0,e.computeBoundingSphere()},THREE.SpotLightHelper=function(e){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var n,t=new THREE.CylinderGeometry(0,1,1,8,1,!0);t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),t.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),n=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1}),this.cone=new THREE.Mesh(t,n),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper,THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},THREE.SpotLightHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){var n=this.light.distance?this.light.distance:1e4,s=n*Math.tan(this.light.angle);this.cone.scale.set(s,s,n),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(e,t,n,s){this.object=e,this.size=void 0!==t?t:1;for(var c=void 0!==n?n:16711680,l=void 0!==s?s:1,i=new THREE.Geometry,a=e.geometry.faces,o=0,d=a.length;d>o;o++)for(var u=a[o],r=0,h=u.vertexNormals.length;h>r;r++)i.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,i,new THREE.LineBasicMaterial({color:c,linewidth:l}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper,THREE.VertexNormalsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){c=["a","b","c","d"],this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var c,a=this.geometry.vertices,d=this.object.geometry.vertices,r=this.object.geometry.faces,l=this.object.matrixWorld,n=0,o=0,u=r.length;u>o;o++)for(var i=r[o],s=0,h=i.vertexNormals.length;h>s;s++){var m=i[c[s]],f=d[m],p=i.vertexNormals[s];a[n].copy(f).applyMatrix4(l),t.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),t.add(a[n]),n+=1,a[n].copy(t),n+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.VertexTangentsHelper=function(e,t,n,s){this.object=e,this.size=void 0!==t?t:1;for(var c=void 0!==n?n:255,l=void 0!==s?s:1,o=new THREE.Geometry,a=e.geometry.faces,i=0,d=a.length;d>i;i++)for(var u=a[i],r=0,h=u.vertexTangents.length;h>r;r++)o.vertices.push(new THREE.Vector3),o.vertices.push(new THREE.Vector3);THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:c,linewidth:l}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.update()},THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexTangentsHelper.prototype.constructor=THREE.VertexTangentsHelper,THREE.VertexTangentsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){l=["a","b","c","d"],this.object.updateMatrixWorld(!0);for(var l,a=this.geometry.vertices,d=this.object.geometry.vertices,r=this.object.geometry.faces,c=this.object.matrixWorld,n=0,o=0,u=r.length;u>o;o++)for(var i=r[o],s=0,h=i.vertexTangents.length;h>s;s++){var m=i[l[s]],f=d[m],p=i.vertexTangents[s];a[n].copy(f).applyMatrix4(c),t.copy(p).transformDirection(c).multiplyScalar(this.size),t.add(a[n]),n+=1,a[n].copy(t),n+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.WireframeHelper=function(e,t){var n,o,l,m,v,b,_,C=void 0!==t?t:16777215,c=[0,0],j={},x=function(e,t){return e-t},O=["a","b","c"],p=new THREE.BufferGeometry;if(e.geometry instanceof THREE.Geometry){for(var r=e.geometry.vertices,y=e.geometry.faces,a=0,d=new Uint32Array(6*y.length),s=0,u=y.length;u>s;s++)for(_=y[s],n=0;3>n;n++)c[0]=_[O[n]],c[1]=_[O[(n+1)%3]],c.sort(x),m=c.toString(),void 0===j[m]&&(d[2*a]=c[0],d[2*a+1]=c[1],j[m]=!0,a++);for(var i=new Float32Array(2*a*3),s=0,u=a;u>s;s++)for(n=0;2>n;n++)b=r[d[2*s+n]],o=6*s+3*n,i[o+0]=b.x,i[o+1]=b.y,i[o+2]=b.z;p.addAttribute("position",new THREE.BufferAttribute(i,3))}else if(e.geometry instanceof THREE.BufferGeometry)if(void 0!==e.geometry.attributes.index){var r=e.geometry.attributes.position.array,g=e.geometry.attributes.index.array,h=e.geometry.drawcalls,a=0;0===h.length&&(h=[{count:g.length,index:0,start:0}]);for(var d=new Uint32Array(2*g.length),f=0,E=h.length;E>f;++f)for(var w=h[f].start,k=h[f].count,o=h[f].index,s=w,A=w+k;A>s;s+=3)for(n=0;3>n;n++)c[0]=o+g[s+n],c[1]=o+g[s+(n+1)%3],c.sort(x),m=c.toString(),void 0===j[m]&&(d[2*a]=c[0],d[2*a+1]=c[1],j[m]=!0,a++);for(var i=new Float32Array(2*a*3),s=0,u=a;u>s;s++)for(n=0;2>n;n++)o=6*s+3*n,l=3*d[2*s+n],i[o+0]=r[l],i[o+1]=r[l+1],i[o+2]=r[l+2];p.addAttribute("position",new THREE.BufferAttribute(i,3))}else{for(var r=e.geometry.attributes.position.array,a=r.length/3,S=a/3,i=new Float32Array(2*a*3),s=0,u=S;u>s;s++)for(n=0;3>n;n++)o=18*s+6*n,v=9*s+3*n,i[o+0]=r[v],i[o+1]=r[v+1],i[o+2]=r[v+2],l=9*s+3*((n+1)%3),i[o+3]=r[l],i[o+4]=r[l+1],i[o+5]=r[l+2];p.addAttribute("position",new THREE.BufferAttribute(i,3))}THREE.Line.call(this,p,new THREE.LineBasicMaterial({color:C}),THREE.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype),THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper,THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject,THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,s="__default",o=0,i=n-1,a=n/1;this.createAnimation(s,o,i,a),this.setAnimationWeight(s,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh,THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,n,s){var o={startFrame:t,endFrame:n,length:n-t+1,fps:s,duration:(n-t)/s,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=o,this.animationsList.push(o)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,n,i,a,c,l=/([a-z]+)_?(\d+)/,o={},r=this.geometry,s=0,d=r.morphTargets.length;d>s;s++)c=r.morphTargets[s],i=c.name.match(l),i&&i.length>1&&(t=i[1],o[t]||(o[t]={start:1/0,end:-(1/0)}),n=o[t],s<n.start&&(n.start=s),s>n.end&&(n.end=s),a||(a=t));for(t in o)n=o[t],this.createAnimation(t,n.start,n.end,e);this.firstAnimation=a},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var n=this.animationsMap[e];n&&(n.fps=t,n.duration=(n.end-n.start)/n.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var n=this.animationsMap[e];n&&(n.duration=t,n.fps=(n.end-n.start)/n.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var n=this.animationsMap[e];n&&(n.weight=t)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var n=this.animationsMap[e];n&&(n.time=t)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,n=this.animationsMap[e];return n&&(t=n.time),t},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,n=this.animationsMap[e];return n&&(t=n.duration),t},THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):THREE.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},THREE.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},THREE.MorphBlendMesh.prototype.update=function(e){for(var t,n,s,o,i,a=0,r=this.animationsList.length;r>a;a++)t=this.animationsList[a],t.active&&(s=t.duration/t.length,t.time+=t.direction*e,t.mirroredLoop?(t.time>t.duration||t.time<0)&&(t.direction*=-1,t.time>t.duration&&(t.time=t.duration,t.directionBackwards=!0),t.time<0&&(t.time=0,t.directionBackwards=!1)):(t.time=t.time%t.duration,t.time<0&&(t.time+=t.duration)),o=t.startFrame+THREE.Math.clamp(Math.floor(t.time/s),0,t.length-1),i=t.weight,o!==t.currentFrame&&(this.morphTargetInfluences[t.lastFrame]=0,this.morphTargetInfluences[t.currentFrame]=1*i,this.morphTargetInfluences[o]=0,t.lastFrame=t.currentFrame,t.currentFrame=o),n=t.time%s/s,t.directionBackwards&&(n=1-n),this.morphTargetInfluences[t.currentFrame]=n*i,this.morphTargetInfluences[t.lastFrame]=(1-n)*i)},THREE.OrbitControls=function(e,t){function C(){return 2*Math.PI/60/60*n.autoRotateSpeed}function T(){return Math.pow(.95,n.zoomSpeed)}function N(e){if(n.enabled!==!1){if(e.preventDefault(),e.button===n.mouseButtons.ORBIT){if(n.noRotate===!0)return;o=s.ROTATE,g.set(e.clientX,e.clientY)}else if(e.button===n.mouseButtons.ZOOM){if(n.noZoom===!0)return;o=s.DOLLY,h.set(e.clientX,e.clientY)}else if(e.button===n.mouseButtons.PAN){if(n.noPan===!0)return;o=s.PAN,p.set(e.clientX,e.clientY)}o!==s.NONE&&(document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",S,!1),n.dispatchEvent(x))}}function A(e){if(n.enabled!==!1){e.preventDefault();var t=n.domElement===document?n.domElement.body:n.domElement;if(o===s.ROTATE){if(n.noRotate===!0)return;v.set(e.clientX,e.clientY),m.subVectors(v,g),n.rotateLeft(2*Math.PI*m.x/t.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*m.y/t.clientHeight*n.rotateSpeed),g.copy(v)}else if(o===s.DOLLY){if(n.noZoom===!0)return;c.set(e.clientX,e.clientY),f.subVectors(c,h),f.y>0?n.dollyIn():f.y<0&&n.dollyOut(),h.copy(c)}else if(o===s.PAN){if(n.noPan===!0)return;u.set(e.clientX,e.clientY),d.subVectors(u,p),n.pan(d.x,d.y),p.copy(u)}o!==s.NONE&&n.update()}}function S(){n.enabled!==!1&&(document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",S,!1),n.dispatchEvent(O),o=s.NONE)}function k(e){if(n.enabled!==!1&&n.noZoom!==!0&&o===s.NONE){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?n.dollyOut():0>t&&n.dollyIn(),n.update(),n.dispatchEvent(x),n.dispatchEvent(O)}}function D(e){if(n.enabled!==!1&&n.noKeys!==!0&&n.noPan!==!0)switch(e.keyCode){case n.keys.UP:n.pan(0,n.keyPanSpeed),n.update();break;case n.keys.BOTTOM:n.pan(0,-n.keyPanSpeed),n.update();break;case n.keys.LEFT:n.pan(n.keyPanSpeed,0),n.update();break;case n.keys.RIGHT:n.pan(-n.keyPanSpeed,0),n.update()}}function R(e){if(n.enabled!==!1){switch(e.touches.length){case 1:if(n.noRotate===!0)return;o=s.TOUCH_ROTATE,g.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(n.noZoom===!0)return;o=s.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+i*i);h.set(0,a);break;case 3:if(n.noPan===!0)return;o=s.TOUCH_PAN,p.set(e.touches[0].pageX,e.touches[0].pageY);break;default:o=s.NONE}o!==s.NONE&&n.dispatchEvent(x)}}function P(e){if(n.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),t=n.domElement===document?n.domElement.body:n.domElement,e.touches.length){case 1:if(n.noRotate===!0)return;if(o!==s.TOUCH_ROTATE)return;v.set(e.touches[0].pageX,e.touches[0].pageY),m.subVectors(v,g),n.rotateLeft(2*Math.PI*m.x/t.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*m.y/t.clientHeight*n.rotateSpeed),g.copy(v),n.update();break;case 2:if(n.noZoom===!0)return;if(o!==s.TOUCH_DOLLY)return;var t,i=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(i*i+a*a);c.set(0,r),f.subVectors(c,h),f.y>0?n.dollyOut():f.y<0&&n.dollyIn(),h.copy(c),n.update();break;case 3:if(n.noPan===!0)return;if(o!==s.TOUCH_PAN)return;u.set(e.touches[0].pageX,e.touches[0].pageY),d.subVectors(u,p),n.pan(d.x,d.y),p.copy(u),n.update();break;default:o=s.NONE}}function H(){n.enabled!==!1&&(n.dispatchEvent(O),o=s.NONE)}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var a,r,n=this,_=1e-6,g=new THREE.Vector2,v=new THREE.Vector2,m=new THREE.Vector2,p=new THREE.Vector2,u=new THREE.Vector2,d=new THREE.Vector2,l=new THREE.Vector3,i=new THREE.Vector3,h=new THREE.Vector2,c=new THREE.Vector2,f=new THREE.Vector2,w=0,E=0,b=1,y=new THREE.Vector3,M=new THREE.Vector3,F=new THREE.Quaternion,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},o=s.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var z=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),L=z.clone().inverse(),j={type:"change"},x={type:"start"},O={type:"end"};this.rotateLeft=function(e){void 0===e&&(e=C()),E-=e},this.rotateUp=function(e){void 0===e&&(e=C()),w-=e},this.panLeft=function(e){var t=this.object.matrix.elements;l.set(t[0],t[1],t[2]),l.multiplyScalar(-e),y.add(l)},this.panUp=function(e){var t=this.object.matrix.elements;l.set(t[4],t[5],t[6]),l.multiplyScalar(e),y.add(l)},this.pan=function(e,t){if(s=n.domElement===document?n.domElement.body:n.domElement,n.object instanceof THREE.PerspectiveCamera){var s,i=n.object.position,a=i.clone().sub(n.target),o=a.length();o*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*e*o/s.clientHeight),n.panUp(2*t*o/s.clientHeight)}else n.object instanceof THREE.OrthographicCamera?(n.panLeft(e*(n.object.right-n.object.left)/s.clientWidth),n.panUp(t*(n.object.top-n.object.bottom)/s.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=T()),n.object instanceof THREE.PerspectiveCamera?b/=e:n.object instanceof THREE.OrthographicCamera?(n.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*e)),n.object.updateProjectionMatrix(),n.dispatchEvent(j)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(e){void 0===e&&(e=T()),n.object instanceof THREE.PerspectiveCamera?b*=e:n.object instanceof THREE.OrthographicCamera?(n.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/e)),n.object.updateProjectionMatrix(),n.dispatchEvent(j)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var e,t=this.object.position;i.copy(t).sub(this.target),i.applyQuaternion(z),r=Math.atan2(i.x,i.z),a=Math.atan2(Math.sqrt(i.x*i.x+i.z*i.z),i.y),this.autoRotate&&o===s.NONE&&this.rotateLeft(C()),r+=E,a+=w,r=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,r)),a=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,a)),a=Math.max(_,Math.min(Math.PI-_,a)),e=i.length()*b,e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(y),i.x=e*Math.sin(a)*Math.sin(r),i.y=e*Math.cos(a),i.z=e*Math.sin(a)*Math.cos(r),i.applyQuaternion(L),t.copy(this.target).add(i),this.object.lookAt(this.target),E=0,w=0,b=1,y.set(0,0,0),(M.distanceToSquared(this.object.position)>_||8*(1-F.dot(this.object.quaternion))>_)&&(this.dispatchEvent(j),M.copy(this.object.position),F.copy(this.object.quaternion))},this.reset=function(){o=s.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(j),this.update()},this.getPolarAngle=function(){return a},this.getAzimuthalAngle=function(){return r},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",N,!1),this.domElement.addEventListener("mousewheel",k,!1),this.domElement.addEventListener("DOMMouseScroll",k,!1),this.domElement.addEventListener("touchstart",R,!1),this.domElement.addEventListener("touchend",H,!1),this.domElement.addEventListener("touchmove",P,!1),window.addEventListener("keydown",D,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t){var o=this,i=new THREE.XHRLoader(o.manager);i.setCrossOrigin(this.crossOrigin),i.load(e,function(e){t(o.parse(e))})},parse:function(e){function j(e,t,n){return new THREE.Vector3(parseFloat(e),parseFloat(t),parseFloat(n))}function k(e,t){return new THREE.Vector2(parseFloat(e),parseFloat(t))}function y(e,t,n,s){return new THREE.Face3(e,t,n,s)}function a(e){return e=parseInt(e),e>=0?e-1:e+o.length}function g(e){return e=parseInt(e),e>=0?e-1:e+c.length}function p(e){return e=parseInt(e),e>=0?e-1:e+l.length}function r(e,t,n,i){void 0===i?s.faces.push(y(o[a(e)]-1,o[a(t)]-1,o[a(n)]-1)):s.faces.push(y(o[a(e)]-1,o[a(t)]-1,o[a(n)]-1,[c[g(i[0])].clone(),c[g(i[1])].clone(),c[g(i[2])].clone()]))}function f(e,t,n){s.faceVertexUvs[0].push([l[p(e)].clone(),l[p(t)].clone(),l[p(n)].clone()])}function m(e,t,n){void 0===e[3]?(r(e[0],e[1],e[2],n),void 0!==t&&t.length>0&&f(t[0],t[1],t[2])):(void 0!==n&&n.length>0?(r(e[0],e[1],e[3],[n[0],n[1],n[3]]),r(e[1],e[2],e[3],[n[1],n[2],n[3]])):(r(e[0],e[1],e[3]),r(e[1],e[2],e[3])),void 0!==t&&t.length>0&&(f(t[0],t[1],t[3]),f(t[1],t[2],t[3])))}h=new THREE.Object3D,/^o /gm.test(e)===!1&&(s=new THREE.Geometry,d=new THREE.MeshLambertMaterial,u=new THREE.Mesh(s,d),h.add(u));for(var t,n,s,d,u,h,o=[],c=[],l=[],A=/v( +[\d|.|+|\-|e]+)( +[\d|.|+|\-|e]+)( +[\d|.|+|\-|e]+)/,_=/vn( +[\d|.|+|\-|e]+)( +[\d|.|+|\-|e]+)( +[\d|.|+|\-|e]+)/,E=/vt( +[\d|.|+|\-|e]+)( +[\d|.|+|\-|e]+)/,C=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,x=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,w=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,O=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,v=e.split(`
`),i=0;i<v.length;i++)n=v[i],n=n.trim(),0!==n.length&&"#"!==n.charAt(0)&&(null!==(t=A.exec(n))?o.push(s.vertices.push(j(t[1],t[2],t[3]))):null!==(t=_.exec(n))?c.push(j(t[1],t[2],t[3])):null!==(t=E.exec(n))?l.push(k(t[1],t[2])):null!==(t=C.exec(n))?m([t[1],t[2],t[3],t[4]]):null!==(t=x.exec(n))?m([t[2],t[5],t[8],t[11]],[t[3],t[6],t[9],t[12]]):null!==(t=w.exec(n))?m([t[2],t[6],t[10],t[14]],[t[3],t[7],t[11],t[15]],[t[4],t[8],t[12],t[16]]):null!==(t=O.exec(n))?m([t[2],t[5],t[8],t[11]],[],[t[3],t[6],t[9],t[12]]):/^o /.test(n)?(s=new THREE.Geometry,d=new THREE.MeshLambertMaterial,u=new THREE.Mesh(s,d),u.name=n.substring(2).trim(),h.add(u)):/^g /.test(n)||(/^usemtl /.test(n)?d.name=n.substring(7).trim():/^mtllib /.test(n)||/^s /.test(n)));for(var b=h.children,i=0,S=b.length;S>i;i++)s=b[i].geometry,s.computeFaceNormals(),s.computeBoundingSphere();return h}};function Neuron(e,t,n){this.connection=[],this.receivedSignal=!1,this.lastSignalRelease=0,this.releaseDelay=0,this.fired=!1,this.firedCount=0,this.prevReleaseAxon=null,THREE.Vector3.call(this,e,t,n)}Neuron.prototype=Object.create(THREE.Vector3.prototype),Neuron.prototype.connectNeuronTo=function(e){var n=this,t=new Axon(n,e);return n.connection.push(new Connection(t,"A")),e.connection.push(new Connection(t,"B")),t},Neuron.prototype.createSignal=function(e,t,n){this.firedCount+=1,this.receivedSignal=!1;for(var o,i=[],s=0;s<this.connection.length;s++)this.connection[s].axon!==this.prevReleaseAxon&&(o=new Signal(e,t,n),o.setConnection(this.connection[s]),i.push(o));return i},Neuron.prototype.reset=function(){this.receivedSignal=!1,this.lastSignalRelease=0,this.releaseDelay=0,this.fired=!1,this.firedCount=0};function Signal(e,t,n){this.minSpeed=t,this.maxSpeed=n,this.speed=THREE.Math.randFloat(this.minSpeed,this.maxSpeed),this.alive=!0,this.t=null,this.startingPoint=null,this.axon=null,this.particle=e.getParticle(),THREE.Vector3.call(this)}Signal.prototype=Object.create(THREE.Vector3.prototype),Signal.prototype.setConnection=function(e){this.startingPoint=e.startingPoint,this.axon=e.axon,this.startingPoint==="A"?this.t=0:this.startingPoint==="B"&&(this.t=1)},Signal.prototype.travel=function(e){var t;this.startingPoint==="A"?(this.t+=this.speed*e,this.t>=1&&(this.t=1,this.alive=!1,this.axon.neuronB.receivedSignal=!0,this.axon.neuronB.prevReleaseAxon=this.axon)):this.startingPoint==="B"&&(this.t-=this.speed*e,this.t<=0&&(this.t=0,this.alive=!1,this.axon.neuronA.receivedSignal=!0,this.axon.neuronA.prevReleaseAxon=this.axon)),t=this.axon.getPoint(this.t),this.particle.set(t.x,t.y,t.z)};function ParticlePool(e){this.spriteTextureSignal=TEXTURES.electric,this.poolSize=e,this.pGeom=new THREE.Geometry,this.particles=this.pGeom.vertices,this.offScreenPos=new THREE.Vector3(9999,9999,9999),this.pColor="#6a2bf7",this.pSize=1;for(var t=0;t<this.poolSize;t++)this.particles[t]=new Particle(this);this.meshComponents=new THREE.Object3D,this.pMat=new THREE.PointCloudMaterial({map:this.spriteTextureSignal,size:this.pSize,color:this.pColor,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0}),this.pMesh=new THREE.PointCloud(this.pGeom,this.pMat),this.pMesh.frustumCulled=!1,this.meshComponents.add(this.pMesh),this.pMat_outer=this.pMat.clone(),this.pMat_outer.size=this.pSize*10,this.pMat_outer.opacity=.04,this.pMesh_outer=new THREE.PointCloud(this.pGeom,this.pMat_outer),this.pMesh_outer.frustumCulled=!1,this.meshComponents.add(this.pMesh_outer)}ParticlePool.prototype.getAvgExecutionTime=function(){return this.profTime/this.itt},ParticlePool.prototype.getParticle=function(){for(var t,e=0;e<this.poolSize;e++)if(t=this.particles[e],t.available)return this.lastAvailableIdx=e,t.available=!1,t;return console.error("ParticlePool.prototype.getParticle return null"),null},ParticlePool.prototype.update=function(){this.pGeom.verticesNeedUpdate=!0},ParticlePool.prototype.updateSettings=function(){this.pMat.color.setStyle(this.pColor),this.pMat.size=this.pSize,this.pMat_outer.color.setStyle(this.pColor),this.pMat_outer.size=this.pSize*10};function Particle(e){this.particlePool=e,this.available=!0,THREE.Vector3.call(this,this.particlePool.offScreenPos.x,this.particlePool.offScreenPos.y,this.particlePool.offScreenPos.z)}Particle.prototype=Object.create(THREE.Vector3.prototype),Particle.prototype.free=function(){this.available=!0,this.set(this.particlePool.offScreenPos.x,this.particlePool.offScreenPos.y,this.particlePool.offScreenPos.z)};function Axon(e,t){this.bezierSubdivision=8,this.neuronA=e,this.neuronB=t,this.cpLength=e.distanceTo(t)/THREE.Math.randFloat(1.5,4),this.controlPointA=this.getControlPoint(e,t),this.controlPointB=this.getControlPoint(t,e),THREE.CubicBezierCurve3.call(this,this.neuronA,this.controlPointA,this.controlPointB,this.neuronB),this.vertices=this.getSubdividedVertices()}Axon.prototype=Object.create(THREE.CubicBezierCurve3.prototype),Axon.prototype.getSubdividedVertices=function(){return this.getSpacedPoints(this.bezierSubdivision)},Axon.prototype.getControlPoint=function(e,t){var o=(new THREE.Vector3).copy(t).sub(e).normalize(),i=new THREE.Vector3(0,0,1),c=(new THREE.Vector3).crossVectors(i,o).normalize(),l=o.angleTo(i),d=(new THREE.Matrix4).makeRotationAxis(c,l),u=Math.cos(THREE.Math.degToRad(45)),s=THREE.Math.randFloat(u,1),a=THREE.Math.randFloat(0,Math.PI*2),r=Math.sqrt(1-s*s),n=new THREE.Vector3(r*Math.cos(a),r*Math.sin(a),s);return n.multiplyScalar(this.cpLength),n.applyMatrix4(d),n.add(e),n};function Connection(e,t){this.axon=e,this.startingPoint=t}function NeuralNetwork(){this.initialized=!1,this.settings={verticesSkipStep:2,maxAxonDist:10,maxConnectionsPerNeuron:6,signalMinSpeed:1.75,signalMaxSpeed:3.25,currentMaxSignals:3e3,limitSignals:1e4},this.meshComponents=new THREE.Object3D,this.particlePool=new ParticlePool(this.settings.limitSignals),this.meshComponents.add(this.particlePool.meshComponents),this.components={neurons:[],allSignals:[],allAxons:[]},this.axonOpacityMultiplier=3,this.axonColor="#245fcd",this.axonGeom=new THREE.BufferGeometry,this.axonPositions=[],this.axonIndices=[],this.axonNextPositionsIndex=0,this.axonUniforms={color:{type:"c",value:new THREE.Color(this.axonColor)},opacityMultiplier:{type:"f",value:this.axonOpacityMultiplier}},this.axonAttributes={opacity:{type:"f",value:[]}},this.neuronSizeMultiplier=.5,this.spriteTextureNeuron=TEXTURES.electric,this.neuronColor="#85bb21",this.neuronOpacity=.75,this.neuronsGeom=new THREE.Geometry,this.neuronUniforms={sizeMultiplier:{type:"f",value:this.neuronSizeMultiplier},opacity:{type:"f",value:this.neuronOpacity},texture:{type:"t",value:this.spriteTextureNeuron}},this.neuronAttributes={color:{type:"c",value:[]},size:{type:"f",value:[]}},this.neuronShaderMaterial=new THREE.ShaderMaterial({uniforms:this.neuronUniforms,attributes:this.neuronAttributes,vertexShader:null,fragmentShader:null,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1}),this.numNeurons=0,this.numAxons=0,this.numSignals=0,this.numPassive=0,this.initNeuralNetwork()}NeuralNetwork.prototype.initNeuralNetwork=function(){this.initNeurons(OBJ_MODELS.brain.geometry.vertices),this.initAxons(),this.neuronShaderMaterial.vertexShader=SHADER_CONTAINER.neuronVert,this.neuronShaderMaterial.fragmentShader=SHADER_CONTAINER.neuronFrag,this.axonShaderMaterial.vertexShader=SHADER_CONTAINER.axonVert,this.axonShaderMaterial.fragmentShader=SHADER_CONTAINER.axonFrag,this.initialized=!0},NeuralNetwork.prototype.initNeurons=function(e){for(t=0;t<e.length;t+=this.settings.verticesSkipStep){var t,n=e[t],s=new Neuron(n.x,n.y,n.z);this.components.neurons.push(s),this.neuronsGeom.vertices.push(s)}for(t=0;t<this.components.neurons.length;t++)this.neuronAttributes.color.value[t]=new THREE.Color("#ffffff"),this.neuronAttributes.size.value[t]=THREE.Math.randFloat(.75,3);this.neuronParticles=new THREE.PointCloud(this.neuronsGeom,this.neuronShaderMaterial),this.meshComponents.add(this.neuronParticles),this.neuronShaderMaterial.needsUpdate=!0},NeuralNetwork.prototype.initAxons=function(){for(var e,t,s,a,r,c,l,d,o=this.components.neurons.length,n=0;n<o;n++){e=this.components.neurons[n];for(s=n+1;s<o;s++)t=this.components.neurons[s],e!==t&&e.distanceTo(t)<this.settings.maxAxonDist&&e.connection.length<this.settings.maxConnectionsPerNeuron&&t.connection.length<this.settings.maxConnectionsPerNeuron&&(r=e.connectNeuronTo(t),this.constructAxonArrayBuffer(r))}renderer.getContext().getExtension("OES_element_index_uint")||console.error("32bit index buffer not supported!"),c=new Uint32Array(this.axonIndices),l=new Float32Array(this.axonPositions),d=new Float32Array(this.axonAttributes.opacity.value),this.axonGeom.addAttribute("index",new THREE.BufferAttribute(c,1)),this.axonGeom.addAttribute("position",new THREE.BufferAttribute(l,3)),this.axonGeom.addAttribute("opacity",new THREE.BufferAttribute(d,1)),this.axonGeom.computeBoundingSphere(),this.axonShaderMaterial=new THREE.ShaderMaterial({uniforms:this.axonUniforms,attributes:this.axonAttributes,vertexShader:null,fragmentShader:null,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0}),this.axonMesh=new THREE.Line(this.axonGeom,this.axonShaderMaterial,THREE.LinePieces),this.meshComponents.add(this.axonMesh),a=0;for(i=0;i<o;i++)this.components.neurons[i].connection[0]||(a+=1);console.log("numNotConnected =",a)},NeuralNetwork.prototype.update=function(e){if(!this.initialized)return;var t,n,s,o,i,a=Date.now();for(o=0;o<this.components.neurons.length;o++)t=this.components.neurons[o],this.components.allSignals.length<this.settings.currentMaxSignals-this.settings.maxConnectionsPerNeuron&&t.receivedSignal&&t.firedCount<8&&(t.fired=!0,t.lastSignalRelease=a,t.releaseDelay=THREE.Math.randInt(100,1e3),this.releaseSignalAt(t)),t.receivedSignal=!1;this.components.allSignals.length===0&&(this.resetAllNeurons(),this.releaseSignalAt(this.components.neurons[THREE.Math.randInt(0,this.components.neurons.length)]));for(i=this.components.allSignals.length-1;i>=0;i--)if(n=this.components.allSignals[i],n.travel(e),!n.alive){n.particle.free();for(s=this.components.allSignals.length-1;s>=0;s--)if(n===this.components.allSignals[s]){this.components.allSignals.splice(s,1);break}}this.particlePool.update(),this.updateInfo()},NeuralNetwork.prototype.constructAxonArrayBuffer=function(e){this.components.allAxons.push(e);for(var s,o,n=e.vertices,t=0;t<n.length;t++)this.axonPositions.push(n[t].x,n[t].y,n[t].z),t<n.length-1&&(s=this.axonNextPositionsIndex,this.axonIndices.push(s,s+1),o=THREE.Math.randFloat(.005,.2),this.axonAttributes.opacity.value.push(o,o)),this.axonNextPositionsIndex+=1},NeuralNetwork.prototype.releaseSignalAt=function(e){for(var s,n=e.createSignal(this.particlePool,this.settings.signalMinSpeed,this.settings.signalMaxSpeed),t=0;t<n.length;t++)s=n[t],this.components.allSignals.push(s)},NeuralNetwork.prototype.resetAllNeurons=function(){this.numPassive=0;for(var e=0;e<this.components.neurons.length;e++)n=this.components.neurons[e],n.fired||(this.numPassive+=1),n.reset()},NeuralNetwork.prototype.updateInfo=function(){this.numNeurons=this.components.neurons.length,this.numAxons=this.components.allAxons.length,this.numSignals=this.components.allSignals.length},NeuralNetwork.prototype.updateSettings=function(){this.neuronUniforms.opacity.value=this.neuronOpacity;for(i=0;i<this.components.neurons.length;i++)this.neuronAttributes.color.value[i].setStyle(this.neuronColor);this.neuronAttributes.color.needsUpdate=!0,this.neuronUniforms.sizeMultiplier.value=this.neuronSizeMultiplier,this.axonUniforms.color.value.set(this.axonColor),this.axonUniforms.opacityMultiplier.value=this.axonOpacityMultiplier,this.particlePool.updateSettings()},NeuralNetwork.prototype.testChangOpcAttr=function(){for(var t=this.axonGeom.attributes.opacity.array,e=0;e<t.length;e++)t[e]=THREE.Math.randFloat(0,.5);this.axonGeom.attributes.opacity.needsUpdate=!0},loadingManager=new THREE.LoadingManager,loadingManager.onLoad=function(){document.getElementById("loading").style.display="none",console.log("Done."),main()},loadingManager.onProgress=function(e,t,n){console.log(t+"/"+n,e)},shaderLoader=new THREE.XHRLoader(loadingManager),shaderLoader.setResponseType("text"),shaderLoader.loadMultiple=function(e,t){_.each(t,function(t,n){shaderLoader.load(t,function(t){e[n]=t})})},SHADER_CONTAINER={},shaderLoader.loadMultiple(SHADER_CONTAINER,{neuronVert:"shaders/neuron.vert",neuronFrag:"shaders/neuron.frag",axonVert:"shaders/axon.vert",axonFrag:"shaders/axon.frag"}),OBJ_MODELS={},OBJloader=new THREE.OBJLoader(loadingManager),OBJloader.load("models/brain_vertex_low.obj",function(e){OBJ_MODELS.brain=e.children[0]}),TEXTURES={},textureLoader=new THREE.TextureLoader(loadingManager),textureLoader.load("sprites/electric.png",function(e){TEXTURES.electric=e}),Detector.webgl||Detector.addGetWebGLMessage(),WIDTH=400,HEIGHT=600,pixelRatio=window.devicePixelRatio||1,screenRatio=WIDTH/HEIGHT,clock=new THREE.Clock,FRAME_COUNT=0,sceneSettings={pause:!1,bgColor:1118483,enableGridHelper:!1,enableAxisHelper:!1},container=document.querySelector(".strip.strip-brain"),scene=new THREE.Scene,container.style.position="relative",camera=new THREE.PerspectiveCamera(75,screenRatio,10,5e3),cameraCtrl=new THREE.OrbitControls(camera,container),cameraCtrl.object.position.y=20,cameraCtrl.object.position.x=150,cameraCtrl.update(),cameraCtrl.autoRotate=!0,cameraCtrl.enabled=!1,renderer=new THREE.WebGLRenderer({antialias:!1,alpha:!0}),renderer.setSize(container.offsetWidth,container.offsetHeight),renderer.setPixelRatio(pixelRatio),renderer.setClearColor(sceneSettings.bgColor,1),renderer.autoClear=!0,container.appendChild(renderer.domElement),canvas=renderer.domElement,canvas.style.position="absolute",canvas.style.top="0",canvas.style.left="0",canvas.style.width="100%",canvas.style.height="100%",canvas.style.display="block",onWindowResize(),stats=new Stats,gridHelper=new THREE.GridHelper(600,50),gridHelper.setColors(48127,16777215),gridHelper.material.opacity=.1,gridHelper.material.transparent=!0,gridHelper.position.y=-300,scene.add(gridHelper),axisHelper=new THREE.AxisHelper(50),scene.add(axisHelper);function updateHelpers(){axisHelper.visible=sceneSettings.enableAxisHelper,gridHelper.visible=sceneSettings.enableGridHelper}function main(){var e=window.neuralNet=new NeuralNetwork;scene.add(e.meshComponents),initGui(),run()}function initGui(){gui=new dat.GUI,gui.width=270,gui_info=gui.addFolder("Info"),gui_info.add(neuralNet,"numNeurons").name("Neurons"),gui_info.add(neuralNet,"numAxons").name("Axons"),gui_info.add(neuralNet,"numSignals",0,neuralNet.settings.limitSignals).name("Signals"),gui_info.autoListen=!1,gui_settings=gui.addFolder("Settings"),gui_settings.add(neuralNet.settings,"currentMaxSignals",0,neuralNet.settings.limitSignals).name("Max Signals"),gui_settings.add(neuralNet.particlePool,"pSize",.2,2).name("Signal Size"),gui_settings.add(neuralNet.settings,"signalMinSpeed",0,8,.01).name("Signal Min Speed"),gui_settings.add(neuralNet.settings,"signalMaxSpeed",0,8,.01).name("Signal Max Speed"),gui_settings.add(neuralNet,"neuronSizeMultiplier",0,2).name("Neuron Size Mult"),gui_settings.add(neuralNet,"neuronOpacity",0,1).name("Neuron Opacity"),gui_settings.add(neuralNet,"axonOpacityMultiplier",0,5).name("Axon Opacity Mult"),gui_settings.addColor(neuralNet.particlePool,"pColor").name("Signal Color"),gui_settings.addColor(neuralNet,"neuronColor").name("Neuron Color"),gui_settings.addColor(neuralNet,"axonColor").name("Axon Color"),gui_settings.addColor(sceneSettings,"bgColor").name("Background"),gui_info.open(),gui_settings.open();for(var e=0;e<gui_settings.__controllers.length;e++)gui_settings.__controllers[e].onChange(updateNeuralNetworkSettings);gui.close()}function updateNeuralNetworkSettings(){neuralNet.updateSettings(),neuralNet.settings.signalMinSpeed>neuralNet.settings.signalMaxSpeed&&(neuralNet.settings.signalMaxSpeed=neuralNet.settings.signalMinSpeed,gui_settings.__controllers[3].updateDisplay())}function updateGuiInfo(){for(var e=0;e<gui_info.__controllers.length;e++)gui_info.__controllers[e].updateDisplay()}let targetZoom=3,zoomSpeed=.002;camera.zoom=1.5;let initialZoom=camera.zoom,zoomRange=targetZoom-initialZoom,time=0;function update(){if(updateHelpers(),!sceneSettings.pause){var e=clock.getDelta();neuralNet.update(e);let t=zoomSpeed*Math.sin(time);camera.zoom+=t,camera.zoom=Math.max(initialZoom,Math.min(targetZoom,camera.zoom)),time+=zoomSpeed,camera.updateProjectionMatrix(),cameraCtrl.update(),updateGuiInfo()}}function run(){requestAnimationFrame(run),renderer.setClearColor(sceneSettings.bgColor,0),renderer.clear(),update(),renderer.render(scene,camera),stats.update(),FRAME_COUNT++}$(function(){var e;$(window).resize(function(){clearTimeout(e),e=setTimeout(function(){onWindowResize()},250)})});function onWindowResize(){var e=document.querySelector(".strip.strip-brain"),t=e.offsetWidth,n=e.offsetHeight;pixelRatio=window.devicePixelRatio||1,screenRatio=t/n,camera.aspect=screenRatio,camera.updateProjectionMatrix(),renderer.setSize(t,n),renderer.setPixelRatio(pixelRatio)}